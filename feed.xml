<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://gszfwsb.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://gszfwsb.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-03-06T14:14:33+00:00</updated><id>https://gszfwsb.github.io/feed.xml</id><title type="html">Shaobo Wang</title><subtitle>Shaobo Wang&apos;s Homepage. </subtitle><entry><title type="html">ç¬¬å…­ç«  Policy Optimization State of the art (ç­–ç•¥ä¼˜åŒ–è¿›é˜¶ç¯‡)</title><link href="https://gszfwsb.github.io/blog/2023/RL-lecture6/" rel="alternate" type="text/html" title="ç¬¬å…­ç«  Policy Optimization State of the art (ç­–ç•¥ä¼˜åŒ–è¿›é˜¶ç¯‡)"/><published>2023-11-01T00:00:00+00:00</published><updated>2023-11-01T00:00:00+00:00</updated><id>https://gszfwsb.github.io/blog/2023/RL-lecture6</id><content type="html" xml:base="https://gszfwsb.github.io/blog/2023/RL-lecture6/"><![CDATA[<blockquote> <p>ä¸Šæ¬¡ä»‹ç»äº†ç­–ç•¥ä¼˜åŒ–çš„åŸºç¡€æ–¹æ³•ï¼Œæœ¬æ¬¡ä»‹ç»ä¸€äº›SOTAçš„ç­–ç•¥ä¼˜åŒ–æ–¹æ³• å…³äºPGç®—æ³•ï¼Œæœ‰å¾ˆå¤šå˜ç§ï¼Œè¿™æ¬¡ä¼šä»‹ç»ã€‚æ­¤å¤–ï¼Œç­–ç•¥ä¼˜åŒ–çš„ç›¸å…³å·¥ä½œä¸»è¦æœ‰ä¸¤æ¡çº¿ï¼Œ</p> <ol> <li>PG â†’ Natural PG / TRPO â†’ ACKTR â†’ PPO</li> <li>Q-learning â†’ DDPG â†’ TD3 â†’ SAC</li> </ol> </blockquote> <h1 id="ä¸€ç­–ç•¥æ¢¯åº¦ç®—æ³•å˜ç§æ¦‚è§ˆ">ä¸€ã€ç­–ç•¥æ¢¯åº¦ç®—æ³•å˜ç§æ¦‚è§ˆ</h1> <ol> <li> <p>ç­–ç•¥å‡½æ•°æœ‰å¾ˆå¤šç§å½¢å¼:</p> \[\begin{aligned}\nabla_\theta J(\theta) &amp; =\mathbb{E}_{\pi_\theta}\left[\nabla_\theta \log \pi_\theta(s, a) G_t\right] \text { - REINFORCE } \\&amp; =\mathbb{E}_{\pi_\theta}\left[\nabla_\theta \log \pi_\theta(s, a) Q^w(s, a)\right] \text { - Q Actor-Critic } \\&amp; =\mathbb{E}_{\pi_\theta}\left[\nabla_\theta \log \pi_\theta(s, a) A^w(s, a)\right] \text { - Advantage Actor-Critic } \\&amp; =\mathbb{E}_{\pi_\theta}\left[\nabla_\theta \log \pi_\theta(s, a) \delta\right] \text { - TD Actor-Critic }\end{aligned}\] </li> <li>è¯„è®ºå‘˜ç”¨ç­–ç•¥è¯„ä¼°ï¼ˆMCæˆ–TDï¼‰å»ä¼°è®¡\(Q^\pi(s, a), A^\pi(s, a), \text { or } V^\pi(s)\)</li> <li>ä¸¤æ¡çº¿çš„å·¥ä½œï¼š</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h1 id="äºŒç­–ç•¥ä¼˜åŒ–è·¯çº¿pg--natural-pg--trpo--acktr--ppo">äºŒã€ç­–ç•¥ä¼˜åŒ–è·¯çº¿ï¼šPG â†’ Natural PG / TRPO â†’ ACKTR â†’ PPO</h1> <h2 id="21-ç­–ç•¥æ¢¯åº¦çš„é—®é¢˜">2.1 ç­–ç•¥æ¢¯åº¦çš„é—®é¢˜</h2> <ol> <li> <p>é‡‡æ ·æ•ˆç‡å¾ˆä½ï¼šæ˜¯on-policy learning</p> \[\nabla_\theta J(\theta)=\mathbb{E}_{a \sim \pi_\theta}\left[\nabla_\theta \log \pi_\theta(s, a) r(s, a)\right]\] </li> <li>æ¯”è¾ƒå¤§å°ºåº¦çš„ç­–ç•¥æ›´æ–°æˆ–è€…ä¸å¤ªåˆé€‚çš„æ­¥é•¿éƒ½ä¼šæ‘§æ¯è®­ç»ƒè¿‡ç¨‹ï¼š <ol> <li>å’Œç›‘ç£å­¦ä¹ ä¸ä¸€æ ·ï¼Œæ•°æ®å’Œå­¦ä¹ æ˜¯ç‹¬ç«‹çš„ã€‚</li> <li>åœ¨RLä¸­ï¼Œå¦‚æœæ­¥å­å¤ªè¿œï¼Œä¼šå¾—åˆ°æ¯”è¾ƒå·®çš„ç­–ç•¥ï¼Œäºæ˜¯å°±ä¼šæ”¶é›†æ¯”è¾ƒå·®çš„æ•°æ®ã€‚</li> <li>å¦‚æœå¾—åˆ°äº†æ¯”è¾ƒå·®çš„ç­–ç•¥ï¼Œå¾ˆéš¾ä»ä¸­æ¢å¤ä¸€ä¸ªå¥½çš„ç­–ç•¥ï¼Œè¿™æ ·å°±ä¼šå½±å“æ•´ä½“çš„æ€§èƒ½ã€‚</li> </ol> </li> <li>å¦‚ä½•è®©è®­ç»ƒè¿‡ç¨‹æ›´ç¨³å®šï¼Ÿç”¨TRPOå’ŒNatural PG</li> <li>å¦‚ä½•è®©å…¶è®­ç»ƒç±»ä¼¼ä¸€ä¸ªoff-policyä¼˜åŒ–ï¼Ÿç”¨TRPOä¸­çš„é‡è¦æ€§é‡‡æ ·</li> </ol> <h2 id="22-natural-pg">2.2 Natural PG</h2> <p>PGæ–¹æ³•æ˜¯ç›´æ¥åœ¨å‚æ•°ç©ºé—´ä¸­é€‰æ‹©æœ€é™¡çš„å¡æ¥ä¼˜åŒ–ï¼Œç¼ºç‚¹åœ¨äºè¿™å¯¹ç­–ç•¥å‡½æ•°ååˆ†æ•æ„Ÿã€‚</p> \[d^*=\nabla_\theta J(\theta)=\lim _{\epsilon \rightarrow 0} \frac{1}{\epsilon} \arg \max J(\theta+d), \text { s.t. }\|d\| \leq \epsilon\] <p>åœ¨åˆ†å¸ƒç©ºé—´ï¼ˆç­–ç•¥è¾“å‡ºï¼‰ä¸­æœ€é™¡çš„æ–¹å‘å¯ä»¥é€šè¿‡KLæ•£åº¦åšçº¦æŸï¼š</p> \[d^*=\arg \max J(\theta+d) \text {, s.t. } K L\left(\pi_\theta \| \pi_{\theta+d}\right)=c\] <p>å›ºå®šKLæ•£åº¦ä¸ºä¸€ä¸ªå¸¸æ•°\(c\)ä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨å‚æ•°ç©ºé—´ä¸­ä¼˜åŒ–çš„é€Ÿåº¦æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚KLæ•£åº¦å¯ä»¥è¡¡é‡ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼š</p> \[K L\left(\pi_\theta \| \pi_{\theta^{\prime}}\right)=E_{\pi_\theta}\left[\log \pi_\theta\right]-E_{\pi_\theta}\left[\log \pi_{\theta^{\prime}}\right]\] <p>å°½ç®¡KLæ•£åº¦æ˜¯éå¯¹ç§°çš„å¹¶ä¸”ä¸æ˜¯çœŸæ­£çš„metricï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€‚ç”¨ã€‚å› ä¸ºå¦‚æœ\(d\to 0\)ï¼ŒKLæ•£åº¦æ˜¯æ¸è¿›å¯¹ç§°çš„ã€‚å› æ­¤ï¼Œåœ¨é‚»åŸŸå†…ï¼ŒKLæ•£åº¦æ˜¯è¿‘ä¼¼å¯¹ç§°çš„ã€‚å¯ä»¥è¯æ˜KLæ•£åº¦çš„äºŒé˜¶æ³°å‹’å±•å¼€æ˜¯ï¼š</p> \[K L\left(\pi_\theta \| \pi_{\theta+d}\right) \approx \frac{1}{2} d^T F d\] <p>å…¶ä¸­<strong>F</strong>æ˜¯<strong>Fisher Information Matrixï¼Œ</strong>æ˜¯KLæ•£åº¦\(E_{\pi_\theta}\left[\nabla \log \pi_\theta \nabla \log \pi_\theta^T\right]\)çš„äºŒé˜¶å¯¼ã€‚</p> <p>æˆ‘ä»¬ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­é‡æ–°å†™ä¸€ä¸‹ä¸Šè¿°å½¢å¼ï¼Œç„¶åå†å€ŸåŠ©æ³°å‹’å±•å¼€è¿‘ä¼¼ï¼š</p> \[d^*=\arg\max_d J(\theta +d)-\lambda (KL(\pi)\theta \| \pi_{\theta+d})-c)\\ \approx \arg\max_d J(\theta) + \nabla_\theta J(\theta)^Td - \frac12 \lambda d^TFd + \lambda c\] <p>æ±‚å¯¼æˆ‘ä»¬å°±èƒ½å¾—åˆ° natural policy gradient: \(d=\frac1\lambda F^{-1}\nabla_\theta J(\theta)\)</p> <h3 id="npgçš„æ€§è´¨">NPGçš„æ€§è´¨</h3> <ol> <li> <p>second-orderä¼˜åŒ–ï¼Œæ›´ç²¾ç¡®ï¼Œè€Œä¸”å’Œæ¨¡å‹æ— å…³ï¼š</p> \[\theta_{t+1}=\theta_t + \alpha F^{-1} \nabla_\theta J(\theta)\] <p>å…¶ä¸­\(F=E_{\pi_\theta}\left[\nabla \log \pi_\theta \nabla \log \pi_\theta^T\right]\)æ˜¯fisher information matrixï¼Œè¡¡é‡äº†policy distributionçš„æ›²ç‡</p> </li> <li> <p>ä¸ç®¡æ¨¡å‹æ€ä¹ˆå‚æ•°åŒ–ï¼ŒNPGéƒ½ä¼šäº§ç”Ÿä¸€æ ·çš„ç­–ç•¥å˜åŒ–ï¼Œå› ä¸º\(F\)æ˜¯å›ºå®šçš„ã€‚</p> </li> </ol> <h3 id="é‡è¦æ€§é‡‡æ ·">é‡è¦æ€§é‡‡æ ·</h3> <p>æˆ‘ä»¬å¯ä»¥é€šè¿‡é‡è¦æ€§é‡‡æ ·ï¼ŒæŠŠPGå˜æˆä¸€ä¸ªoff-policyçš„å­¦ä¹ ï¼Œæœ‰ç‚¹ç±»ä¼¼äºELBOæ¨å¯¼ã€‚</p> <p>Importance sampling (IS) è®¡ç®—\(f(x), x \sim p(x)\)çš„æœŸæœ›ï¼Œå¦‚æœæˆ‘ä»¬ä¸çŸ¥é“\(p\)ï¼Œå¯ä»¥é€šè¿‡å¦ä¸€ä¸ªåˆ†å¸ƒ\(q\)æ¥åšé‡‡æ ·ï¼Œ</p> \[\mathbb{E}_{x\sim p}[f(x)]=\int p(x)f(x)dx = \int q(x)\frac{p(x)}{q(x)}f(x)dx = \mathbb{E}_{x\sim q}[\frac{p(x)}{q(x)}f(x)]\] <p>è¿™æ ·æˆ‘ä»¬å¯ä»¥ç”¨ISæ¥è·å¾—æˆ‘ä»¬çš„ç›®æ ‡å‡½æ•°ï¼Œå…¶ä¸­\(\hat\pi\)å°±æ˜¯è¡Œä¸ºç­–ç•¥ã€‚</p> \[J(\theta)=\mathbb{E}_{a\sim \pi_\theta}[r(s,a)]=\mathbb{E}_{a\sim \hat{\pi}}[\frac{\pi_\theta(s,a)}{\hat{\pi}(s,a)}r(s,a)]\] <p>å€ŸåŠ©äº†ISçš„æ€æƒ³ï¼Œæˆ‘ä»¬å‡†å¤‡ç›´æ¥ç”¨old policyä½œä¸ºè¡Œä¸ºç­–ç•¥ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªobjective functionä¸ºï¼š</p> \[\theta = \arg\max_\theta J_{\theta_{old}}(\theta)=\arg\max \mathbb{E}_t [\frac{\pi_\theta(a_t|s_t)}{\pi_{\theta_{old}}(a_t|s_t)}R_t]\] <table> <tbody> <tr> <td>å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœ$$\frac{\pi_\theta(a_t</td> <td>s_t)}{\pi_{\theta_{old}}(a_t</td> <td>s_t)}$$å¤ªå¤§ï¼Œè¿™ä¸ªobjective functionçš„å€¼ä¹Ÿä¼šéå¸¸å¤§ã€‚æ‰€ä»¥æœ‰æ²¡æœ‰åŠæ³•é™åˆ¶ä¸€ä¸‹è¿™ä¸ªæ¯”å€¼å‘¢ï¼Ÿæ¯”å¦‚ï¼ŒæŠŠè¿™ä¸¤ä¸ªpolicyçš„å·®å¼‚å˜å¾—å°ä¸€äº›ã€‚ä¾‹å¦‚ï¼Œç”¨KL divergenceå»åº¦é‡è¿™ä¸ªè·ç¦»</td> </tr> </tbody> </table> \[KL\left(\pi_{\theta_{\text {old }}}|| \pi_\theta\right)=-\sum_a \pi_{\theta_{\text {old }}}(a \mid s) \log \frac{\pi_\theta(a \mid s)}{\pi_{\theta_{\text {old }}}(a \mid s)}\] <p>è¿™æ ·ï¼Œæˆ‘ä»¬å¸¦æœ‰trust regionçš„objectiveï¼Œå¯ä»¥å†™æˆå¦‚ä¸‹çš„å½¢å¼ï¼š</p> \[\begin{gathered}J_{\theta_{\text {old }}}(\theta)=\mathbb{E}_t\left[\frac{\pi_\theta\left(a_t \mid s_t\right)}{\pi_{\theta_{\text {old }}}\left(a_t \mid s_t\right)} R_t\right] \\\text { subject to } K L\left(\pi_{\theta_{\text {old }}}\left(. \mid s_t\right)|| \pi_\theta\left(. \mid s_t\right)\right) \leq \delta\end{gathered}\] <p>åœ¨ trust region ä¸­ï¼Œæˆ‘ä»¬æŠŠå‚æ•°æœç´¢å›ºå®šåœ¨ä¸€ä¸ªèŒƒå›´å†….ç»è¿‡ä¸€äº›æ¨å¯¼å’Œæ³°å‹’å±•å¼€è¿‘ä¼¼ï¼Œæˆ‘ä»¬æœ‰ï¼š</p> \[\begin{aligned} J_{\theta_t}(\theta) &amp; \approx g^T\left(\theta-\theta_t\right) \\ KL\left(\theta_t \| \theta\right) &amp; \approx \frac{1}{2}\left(\theta-\theta_t\right)^T H\left(\theta-\theta_t\right) \end{aligned}\] <p>å…¶ä¸­ \(g=\nabla_\theta J_{\theta_t}(\theta),H=\nabla_\theta^2 K L\left(\theta_t \| \theta\right)\) å…¶ä¸­ \(\theta_t\) æ˜¯old policy parameterï¼Œå› æ­¤ï¼š</p> \[\theta_{t+1}=\underset{\theta}{\arg \max } g^T\left(\theta-\theta_t\right) \text { s.t. } \frac{1}{2}\left(\theta-\theta_t\right)^T H\left(\theta-\theta_t\right) \leq \delta\] <p>å¯ä»¥æ±‚å‡ºè§£æè§£ï¼š</p> \[\theta_{t+1}=\theta_t+\sqrt{\frac{2 \delta}{g^T H^{-1} g}} H^{-1} g\] <ul> <li> <p>NGæ˜¯fisher information matrix \(F\)ä¸‹æœ€é™¡å³­çš„ä¸Šå±±æ–¹å‘ã€‚</p> \[H=\nabla_\theta^2 K L\left(\pi_{\theta_t}|| \pi_\theta\right)=E_{a, s \sim \pi_{\theta_t}}\left[\nabla_\theta \log \pi_\theta(a, s) \nabla_\theta \log \pi_\theta(a, s)^T\right]\] </li> <li>å­¦ä¹ ç‡\(\delta\)å¯ä»¥è¢«çœ‹ä½œæ˜¯é€‰æ‹©ä¸€ä¸ªnormalized step sizeæ¥æ”¹å˜policy</li> <li>äº®ç‚¹ï¼šä»»ä½•å‚æ•°æ›´æ–°ä¸ä¼šå½±å“policy networkçš„è¾“å‡ºã€‚</li> </ul> <h3 id="trpoä¸­çš„natural-policy-gradient">TRPOä¸­çš„natural policy gradient</h3> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled%201-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled%201-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled%201-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled%201.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="23-trpo">2.3 TRPO</h2> <p>æœ‰ä¸€äº›é—®é¢˜ï¼š</p> <ol> <li>FIMå’Œé€†è®¡ç®—æ˜¯å¼€é”€éå¸¸å¤§</li> <li>TRPOé€šè¿‡è§£ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å³é€šè¿‡ä¼°è§£\(Hx=g\)æ¥è§£\(x=H^{-1}g\).é‚£ä¹ˆå¯ä»¥ç­‰ä»·äºä¼˜åŒ–ä¸€ä¸ªäºŒæ¬¡æ–¹ç¨‹ï¼š\(\min _x \frac{1}{2} x^T H x-g^T x\)</li> <li> <p>ä¸€äº›è§£é‡Šï¼šè§£å†³ \(Ax=b\)ç­‰ä»·äº</p> \[\begin{gathered}x=\underset{x}{\arg \max } f(x)=\frac{1}{2} x^T A x-b^T x \\\text { since } f^{\prime}(x)=A x-b=0\end{gathered}\] </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled%202-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled%202-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled%202-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled%202.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>ç”¨çš„è§£æ³•æ˜¯ <strong>conjugate gradient (CG)</strong></p> <ol> <li>å…¶å®TRPOç®—æ³•æœ‰ä¸€ç‚¹ç±»ä¼¼äºEMç®—æ³•ï¼Œæ˜¯ä¸€ç±»Minorize-Maximization(MM)ç®—æ³•ï¼Œè§£æ³•éƒ½æ˜¯å…ˆmaximizeä¸€ä¸ªé‚»è¿‘çš„å‡½æ•°ç„¶åé€¼è¿‘è¿™ä¸ªlocal expected reward</li> <li>TRPOçš„é—®é¢˜ï¼š <ol> <li>è®¡ç®—FIMå¼€é”€å¤ªå¤§</li> <li>è®¡ç®—ç²¾ç¡®FIMéœ€è¦å¾ˆå¤šæ¬¡é‡‡æ ·</li> <li>CGç®—æ³•å®ç°èµ·æ¥æ¯”è¾ƒå›°éš¾</li> </ol> </li> </ol> <h2 id="24-acktr">2.4 ACKTR</h2> <p>ç”¨ <strong>Kronecker-factored approximation (K-FAC)</strong> æ¥æ”¹è¿›TRPOï¼Œå…·ä½“è€Œè¨€å°±æ˜¯é™ä½è®¡ç®—FIMæ±‚é€†çš„å¤æ‚åº¦</p> \[F=E_{x \sim \pi_{\theta_t}}\left[\left(\nabla_\theta \log \pi_\theta(x)\right)^T\left(\nabla_\theta \log \pi_\theta(x)\right)\right]\] <p>æŠŠè¿™ä¸ªæ›¿æ¢ä¸ºlayer-wise calculationï¼Œå› ä¸ºæ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥å¯ä»¥åˆ†å—çŸ©é˜µè®¡ç®—</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled%203-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled%203-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled%203-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled%203.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled%204-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled%204-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled%204-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled%204.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="25-ppo">2.5 PPO</h2> <h3 id="åŸºç¡€ç‰ˆppo">åŸºç¡€ç‰ˆPPO</h3> <p>å…¶å®å°±æ˜¯æŠŠTRPOçš„lossæ”¹å†™äº†ä¸€ä¸‹ï¼Œå˜æˆæ‹‰æ ¼æœ—æ—¥çš„å½¢å¼ï¼š</p> \[\max \mathbb{E}_t\left[\frac{\pi_\theta\left(a_t \mid s_t\right)}{\pi_{\theta_{\text {old }}}\left(a_t \mid s_t\right)} R_t\right] \\\text { subject to } K L\left(\pi_{\theta_{\text {old }}}\left(. \mid s_t\right)|| \pi_\theta\left(. \mid s_t\right)\right) \leq \delta\] <p>æ”¹ä¸ºï¼š</p> \[\max \mathbb{E}_t\left[\frac{\pi_\theta\left(a_t \mid s_t\right)}{\pi_{\theta_{\text {old }}}\left(a_t \mid s_t\right)} R_t\right] -\beta K L\left(\pi_{\theta_{\text {old }}}\left(. \mid s_t\right)|| \pi_\theta\left(. \mid s_t\right)\right)\] <p>è¿™æ ·çš„å¥½å¤„å°±æ˜¯å¯ä»¥ç›´æ¥ç”¨SGDæ¥ä¼˜åŒ–ï¼Œé€Ÿåº¦æ¯”second orderå¿«å¾ˆå¤šã€‚</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled%205-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled%205-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled%205-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled%205.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="å¸¦clippingçš„ppo">å¸¦clippingçš„PPO</h3> <p>å®šä¹‰æ¦‚ç‡æ¯”å€¼\(r_t(\theta)=\frac{\pi_\theta\left(a_t \mid s_t\right)}{\pi_{\theta_{\text {old }}}\left(a_t \mid s_t\right)}\)ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰ä¸åŒçš„objectives</p> <ul> <li>ä¸å¸¦trust regionçš„PG: \(L_t(\theta)=r_t(\theta) \hat{A_t}\)</li> <li>KLé™åˆ¶ï¼š\(L_t(\theta)=r_t(\theta) \hat{A_t}.\text{s.t.}, KL[\pi_{\theta_{old}},\pi_\theta]\leq \delta\)</li> <li>KLæƒ©ç½šï¼š\(L_t(\theta)=r_t(\theta) \hat{A_t}- \beta KL[\pi_{\theta_{old}},\pi_\theta]\)</li> <li>(new) é™åˆ¶policyä¸è¦å’Œold policyç¦»å¼€å¤ªè¿œï¼š\(L_t(\theta)=\min (r_t(\theta) \hat{A_t},\text{clip}(r_t(\theta),1-\epsilon,1+\epsilon)\hat{A_t})\)</li> </ul> <p>å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼š</p> <ul> <li>å½“advantageä¸ºæ­£æ—¶ï¼Œé¼“åŠ±actionå¢åŠ â†’ \(L_t(\theta)=\min (r_t(\theta),1+\epsilon)\hat{A_t}\)</li> <li>å½“advantageä¸ºæ­£æ—¶ï¼Œé¼“åŠ±actionå‡å°‘â†’\(L_t(\theta)=\min (r_t(\theta),1-\epsilon)\hat{A_t}\)</li> </ul> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled%206-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled%206-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled%206-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled%206.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>PPOæ¯”èµ·TRPOç¨³å®šæ€§å¯é æ€§æ›´å¥½ï¼Œè€Œä¸”å®ç°èµ·æ¥æ›´ç®€å•ã€‚</p> <blockquote> <p>æ€»ç»“ä¸€ä¸‹SOTAçš„policyä¼˜åŒ–ï¼š</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> </figure></div></div> </blockquote> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled%207-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled%207-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled%207-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled%207.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> <p>&lt;/figure&gt;</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/div&gt;
</code></pre></div></div> <p>&lt;/div&gt;</p> <blockquote> </blockquote> <h1 id="ä¸‰ä»·å€¼ä¼˜åŒ–è·¯çº¿q-learning--ddpg--td3--sac">ä¸‰ã€ä»·å€¼ä¼˜åŒ–è·¯çº¿ï¼šQ-learning â†’ DDPG â†’ TD3 â†’ SAC</h1> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled%208-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled%208-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled%208-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled%208.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="31-deep-deterministic-policy-gradient-ddpg">3.1 <strong>Deep Deterministic Policy Gradient (DDPG)</strong></h2> <p>åŸå§‹çš„DQNæ˜¯åšç¦»æ•£åŠ¨ä½œçš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ‹“å±•åˆ°è¿ç»­ç©ºé—´ä¹ˆï¼ŸDDPGå°±å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªè¿ç»­ç‰ˆæœ¬çš„DQN.</p> \[\textbf{DQN}: a^*=\arg\max_a Q^*(s,a)\\ \textbf{DDPG}: a^*=\arg\max_a Q^*(s,a) \approx Q_\phi (s,\mu_\theta(s))\] <ul> <li>\(\mu_\theta(s)\)æ˜¯ä¸€ä¸ªdeterministicçš„ç­–ç•¥ï¼Œç›´æ¥ç»™å‡ºä¸€ä¸ªæœ€å¤§åŒ–\(Q_\phi (s,\mu_\theta(s))\)çš„action</li> <li>åŠ¨ä½œ\(a\)æ˜¯è¿ç»­çš„</li> <li>æˆ‘ä»¬å‡è®¾Q-function å¯¹\(a\)æ˜¯å¯å¯¼çš„</li> </ul> <p>å› æ­¤ï¼ŒDDPGæœ‰å¦‚ä¸‹objectiveï¼š</p> \[\textbf{Q-target}:y(r,s',d)=r+\gamma(1-d)Q_{\phi_{targ}} (s',\mu_{\theta_{targ}}(s'))\\ \textbf{Q-function}:\min \mathbb{E}_{s,r,s',d\sim D}[Q_\phi(s,a)-y(r,s',d)]\\ \textbf{policy}: \max_\theta \mathbb{E}_{s\sim D}[Q_\phi (s,\mu_\theta(s))]\] <p>åŒæ ·ï¼ŒDDPGä¹Ÿç”¨äº†reply bufferå’Œtarget network</p> <h2 id="32-twin-delayed-ddpg-td3">3.2 Twin Delayed DDPG (TD3)</h2> <p>DDPGçš„ç¼ºç‚¹ï¼šæœ‰ä¸¥é‡çš„è¿‡æ‹Ÿåˆï¼Œä¸ºæ­¤TD3åšäº†ä¸‰ä¸ªæ”¹è¿›ï¼š</p> <ol> <li><strong>Clipped Double-Q Learning</strong>ï¼šTD3å­¦ä¹ ä¸¤ä¸ªQå‡½æ•°ï¼Œç”¨ä¸¤ä¸ªQ valueé‡Œé¢å°çš„é‚£ä¸€ä¸ªæ¥å¾—åˆ°target</li> <li><strong>â€œDelayedâ€ Policy Updatesï¼š</strong>TD3æ›´æ–°ç­–ç•¥ç¼“æ…¢ï¼Œæ›´æ–°Qå‡½æ•°å¿«é€Ÿï¼ˆä¸¤ä¸ªQå‡½æ•°æ›´æ–°ä¸€æ¬¡policyå†æ›´æ–°ä¸€æ¬¡ï¼‰</li> <li><strong>**</strong><strong>Target Policy Smoothingï¼š</strong><strong>**</strong>TD3åœ¨target actioné‡Œé¢å¢åŠ å™ªå£°ï¼Œè®©policyæ›´éš¾åˆ©ç”¨Qå‡½æ•°ã€‚</li> </ol> <p>å…·ä½“è€Œè¨€ï¼ŒTD3å­¦ä¹ ä¸¤ä¸ªQå‡½æ•°\(Q_{\phi_1},Q_{\phi_2}\)ï¼Œä¸¤ä¸ªå‡½æ•°ç”¨ä¸€ä¸ªtargetå¦‚ä¸‹ï¼š</p> \[y(r,s',d)=r+\gamma(1-d)\min_{i=1,2}Q_{\phi_{i,targ}}(s'a_{TD3}(s'))\] <p>Target Policy Smoothingï¼ˆç±»ä¼¼äºæ­£åˆ™åŒ–ï¼‰</p> \[a_{TD3}(s')=clip(\mu_{\theta,targ}(s'))+clip(\epsilon,-c,c),a_{low},a_{high}),\epsilon\sim N(0,\sigma)\] <h2 id="33-soft-actor-critic-sac">3.3 <strong>Soft Actor-Critic (SAC)</strong></h2> <p>SACæ˜¯ç”¨ç±»ä¼¼äºDDPGçš„æ–¹æ³•ï¼Œè¿›è¡Œstochastic policyçš„ä¼˜åŒ–ï¼Œèåˆäº† <strong>entropy regularization</strong> ï¼ˆç†µæ­£åˆ™åŒ–ï¼‰ã€‚å…·ä½“è€Œè¨€ï¼Œè¿™ä¸ªç­–ç•¥è¢«è®­ç»ƒæ¥æœ€å¤§åŒ– expected returnå’Œentropyä¹‹é—´çš„trade-of</p> \[\pi^*=\arg\max \mathbb{E}_{\tau\sim \pi} [\sum_t \gamma^t(R(s_t,a_t,s_{t+1})+\alpha H(\pi(\cdot | s_t)))]\] <p>value functionä¹ŸåŒ…å«äº†entropy bonus</p> \[V^\pi(s)=\mathbb{E}_{\tau\sim \pi}[\sum_t \gamma^t (R(s_t,a_t,s_{t+1})+\alpha H(\pi(\cdot|s_t)))|s_0=s]\] <p>æˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºç±»ä¼¼çš„bellman equationï¼š</p> \[Q^\pi(s,a)=\mathbb{E}_{s'\sim P,a'\sim \pi}[R(s,a,s')+\gamma(Q^\pi(s',a')+\alpha H(\pi(a'|s')))]\\ =\mathbb{E}_{s'\sim P,a'\sim \pi}[R(s,a,s')+\gamma(Q^\pi(s',a')-\alpha \log\pi(a'|s'))]\] <p>å› æ­¤Qå‡½æ•°çš„æ›´æ–°å¯ä»¥å†™æˆï¼š</p> \[Q^\pi(s,a)\leftarrow r+\gamma(Q^\pi(s',\hat{a}')-\alpha \log \pi(\hat{a}'|s')),\hat{a}'\sim \pi(\cdot|s')\] <p>ç±»ä¼¼TD3ï¼Œä¹Ÿæ˜¯å­¦ä¹ ä¸¤ä¸ªQå‡½æ•°ï¼Œç”¨clipped double-Q trickã€‚ä¸¤ä¸ªQå‡½æ•°éƒ½æ˜¯é€šè¿‡mean sqaure bellman errorå­¦ä¹ çš„ï¼š</p> \[L(\phi_i,D)=\mathbb{E}[(Q_\phi(s,a)-y(r,s',d))^2]\\ y(r,s',d)=r+\gamma(1-d)(\min_{j=1,2}Q_{\phi_{targ,j}}(s',\hat{a}'-\alpha \log\pi_\theta(\hat{a}'|s'))),\\ \hat{a}'\sim \pi_{\theta}(\cdot|s')\] <p>policyé€šè¿‡maximize\(V^\pi(s)\)æ¥å­¦ä¹ ã€‚</p> <h3 id="é‡å‚æ•°åŒ–">é‡å‚æ•°åŒ–</h3> <p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠactionå½“ä½œæ˜¯ä»ä¸€ä¸ªgaussianåˆ†å¸ƒé‡Œé¢é‡‡æ ·å¾—åˆ°çš„ï¼Œ</p> \[\hat{a}_\theta(s,\epsilon)=tanh(\mu_\theta(s)+\sigma_\theta(s)\odot\epsilon),\epsilon\sim N(0,I)\] <p>é‡å‚æ•°åŒ–çš„å¥½å¤„ï¼šå¯ä»¥è®©æˆ‘ä»¬æŠŠå¯¹actionçš„æœŸæœ›è½¬æ¢ä¸ºä¸€ä¸ªå¯¹noiseçš„æœŸæœ›â€”â€”å’Œå‚æ•°æ— å…³çš„åˆ†å¸ƒï¼Œå³</p> \[\mathbb{E}_{a\sim\pi_\theta}[Q^\pi_\theta(s,a)-\alpha \log \pi_\theta(a|s)]\\=\mathbb{E}_{\epsilon\sim N}[Q^\pi_\theta(s,\hat{a}_\theta(s,\epsilon))-\alpha \log \pi_\theta(\hat{a}_\theta(s,\epsilon)|s)]\] <p>å› æ­¤ï¼Œpolicyä¼˜åŒ–å…¬å¼å¯ä»¥å†™ä¸ºï¼š</p> \[\max_{\theta}\mathbb{E}_{s\sim D,\epsilon\sim N}[\min_{j=1,2}Q_{\phi_j}(s,\hat{a}_\theta(s,\epsilon))-\alpha \log \pi_\theta(\hat{a}_\theta(s,\epsilon)|s)]\] <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter6/Untitled%209-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter6/Untitled%209-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter6/Untitled%209-1400.webp"/> <img src="/assets/img/RL_chapter6/Untitled%209.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div>]]></content><author><name></name></author><category term="Reinforcement-Learning"/><category term="intro"/><summary type="html"><![CDATA[PO SOTA]]></summary></entry><entry><title type="html">ç¬¬ä¸‰ç«  Tabular methods Model-free Prediction and Control (è¡¨æ ¼å‹æ–¹æ³•ï¼šå…æ¨¡å‹çš„é¢„æµ‹å’Œæ§åˆ¶)</title><link href="https://gszfwsb.github.io/blog/2023/RL-lecture3/" rel="alternate" type="text/html" title="ç¬¬ä¸‰ç«  Tabular methods Model-free Prediction and Control (è¡¨æ ¼å‹æ–¹æ³•ï¼šå…æ¨¡å‹çš„é¢„æµ‹å’Œæ§åˆ¶)"/><published>2023-10-30T00:00:00+00:00</published><updated>2023-10-30T00:00:00+00:00</updated><id>https://gszfwsb.github.io/blog/2023/RL-lecture3</id><content type="html" xml:base="https://gszfwsb.github.io/blog/2023/RL-lecture3/"><![CDATA[<h1 id="ä¸€ä¸ºä»€ä¹ˆéœ€è¦å…æ¨¡å‹rl">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦å…æ¨¡å‹RLï¼Ÿ</h1> <ol> <li> <p>ä»€ä¹ˆæ—¶å€™é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹æ˜¯å·²çŸ¥çš„ï¼Ÿ</p> <p><strong>å¥–åŠ±å’Œè½¬ç§»æ¦‚ç‡å‡å·²çŸ¥ï¼Œ</strong>è¿™æ ·æ‰å¯ä»¥ç”¨ç­–ç•¥è¿­ä»£å’Œä»·å€¼è¿­ä»£è¿›è¡Œæ±‚è§£ã€‚</p> </li> <li>ç­–ç•¥è¿­ä»£ï¼šç»™å®šä¸€ä¸ªå·²çŸ¥çš„MDPï¼Œè®¡ç®—æœ€ä¼˜ç­–ç•¥å‡½æ•°å’Œä»·å€¼å‡½æ•°ã€‚ <ol> <li> <p>ç­–ç•¥è¯„ä¼°ï¼šç”¨è´å°”æ›¼æœŸæœ›æ–¹ç¨‹è¿­ä»£åˆ°æ”¶æ•›</p> \[V_{t+1}(s)=\sum_{a \in \mathcal{A}} \pi(a \mid s)(\textcolor{red}{R(s, a)}+\gamma \sum_{s^{\prime} \in \mathcal{S}} \textcolor{red}{P(s^{\prime} \mid s, a)} V_{t}(s^{\prime})\] </li> <li> <p>ç­–ç•¥æ”¹è¿›ï¼šç”¨è´å°”æ›¼æœŸæœ›æ–¹ç¨‹ï¼Œå¹¶åœ¨ä»·å€¼å‡½æ•°ä¸Šç”¨è´ªå¿ƒç­–ç•¥</p> \[Q_{\pi_i}(s, a)=\textcolor{red}{R(s, a)}+\gamma \sum_{s^{\prime} \in S} \textcolor{red}{P\left(s^{\prime} \mid s, a\right)} V_{\pi_i}\left(s^{\prime}\right)\\\pi_{i+1}(s)=\underset{a}{\arg \max } Q_{\pi_i}(s, a)\] </li> </ol> </li> <li>ä»·å€¼è¿­ä»£ï¼šç»™å®šä¸€ä¸ªå·²çŸ¥çš„MDPï¼Œè®¡ç®—æœ€ä¼˜ä»·å€¼å‡½æ•°ã€‚ <ol> <li> <p>ç”¨è´å°”æ›¼æœ€ä¼˜å…¬å¼è¿­ä»£</p> \[v_{i+1}(s)\leftarrow \max_{a\in \mathcal{A}}(\textcolor{red}{R(s, a)}+\gamma \sum_{s^{\prime} \in \mathcal{S}} \textcolor{red}{P(s^{\prime} \mid s, a)} v_{i}(s^{\prime})ï¼‰\] </li> <li> <p>å¾—åˆ°è¿­ä»£åçš„æœ€ä¼˜ç­–ç•¥ï¼š</p> \[\pi^*(s)=\underset{a}{\arg \max }\left[\textcolor{red}{R(s, a)}+\gamma \sum_{s^{\prime} \in S} \textcolor{red}{P\left(s^{\prime} \mid s, a\right)} V_{\textrm{end}}\left(s^{\prime}\right)\right]\] </li> </ol> </li> <li>çŸ¥é“ä¸–ç•Œå¦‚ä½•è¿ä½œçš„RLï¼š <ol> <li>ç­–ç•¥è¿­ä»£å’Œä»·å€¼è¿­ä»£éƒ½éœ€è¦å‡è®¾æˆ‘ä»¬å·²çŸ¥ç¯å¢ƒä¸­çš„<strong>çŠ¶æ€è½¬ç§»</strong>å’Œ<strong>å¥–åŠ±</strong>ã€‚</li> <li>ç°å®æƒ…å¢ƒä¸­ï¼ŒMDPæ¨¡å‹è¦ä¹ˆå°±æ˜¯æœªçŸ¥è¦ä¹ˆå°±æ˜¯å¤ªå¤§å¤ªå¤æ‚</li> </ol> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li> <p>å…æ¨¡å‹RLï¼šé€šè¿‡ä¸ç¯å¢ƒäº¤äº’äº¤äº’å­¦ä¹ </p> <p>é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„æ¨¡å‹æœªçŸ¥æˆ–è€…æ¨¡å‹å¾ˆå¤§æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…æ¨¡å‹å¼ºåŒ–å­¦ä¹ çš„æ–¹æ³•ã€‚å…æ¨¡å‹å¼ºåŒ–å­¦ä¹ æ–¹æ³•æ²¡æœ‰è·å–ç¯å¢ƒçš„<strong>çŠ¶æ€è½¬ç§»</strong>å’Œ<strong>å¥–åŠ±å‡½æ•°</strong>ï¼Œè€Œæ˜¯è®©æ™ºèƒ½ä½“ä¸ç¯å¢ƒè¿›è¡Œ<strong>äº¤äº’</strong>ï¼Œé‡‡é›†å¤§é‡çš„<strong>è½¨è¿¹æ•°æ®</strong>ï¼Œæ™ºèƒ½ä½“ä»è½¨è¿¹ä¸­è·å–ä¿¡æ¯æ¥æ”¹è¿›ç­–ç•¥ï¼Œä»è€Œè·å¾—æ›´å¤šçš„å¥–åŠ±ã€‚</p> <p>è½¨è¿¹ï¼šåŒ…æ‹¬\(\{S_1,A_1,R_1,S_2,A_2,R_2,...,S_T,A_T,R_T\}\)</p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%201-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%201-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%201-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%201.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h1 id="äºŒå…æ¨¡å‹é¢„æµ‹">äºŒã€å…æ¨¡å‹é¢„æµ‹</h1> <p>åœ¨æ— æ³•è·å–é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„æ¨¡å‹æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>è’™ç‰¹å¡æ´›æ–¹æ³•</strong>å’Œ<strong>æ—¶åºå·®åˆ†æ–¹æ³•</strong>æ¥ä¼°è®¡æŸä¸ªç»™å®šç­–ç•¥çš„ä»·å€¼ã€‚</p> <h2 id="21-è’™ç‰¹å¡æ´›æ–¹æ³•">2.1 è’™ç‰¹å¡æ´›æ–¹æ³•</h2> <h3 id="211-è’™ç‰¹å¡æ´›ç­–ç•¥è¯„ä¼°">2.1.1 è’™ç‰¹å¡æ´›ç­–ç•¥è¯„ä¼°</h3> <p>è’™ç‰¹å¡æ´›æ–¹æ³•æ˜¯åŸºäºé‡‡æ ·çš„æ–¹æ³•ï¼Œç»™å®šç­–ç•¥ \(\pi\) ï¼Œæˆ‘ä»¬è®©æ™ºèƒ½ä½“ä¸ç¯å¢ƒè¿›è¡Œäº¤äº’ï¼Œå¯ä»¥å¾—åˆ°å¾ˆå¤šè½¨è¿¹ã€‚æ¯ä¸ªè½¨è¿¹éƒ½æœ‰å¯¹åº”çš„å›æŠ¥ï¼š</p> \[G_t=r_{t+1}+\gamma r_{t+2}+\gamma^2 r_{t+3}+\ldotsÂ \] <p>æˆ‘ä»¬æ±‚å‡ºæ‰€æœ‰è½¨è¿¹çš„å›æŠ¥çš„å¹³å‡å€¼ï¼Œå°±å¯ä»¥çŸ¥é“æŸä¸€ä¸ªç­–ç•¥å¯¹åº”çŠ¶æ€çš„ä»·å€¼ï¼Œå³</p> \[V_\pi(s)=\mathbb{E}_{\tau \sim \pi}\left[G_t \mid s_t=s\right]\] <ol> <li>ç‰¹ç‚¹ï¼š <ul> <li>è’™ç‰¹å¡æ´›ä»¿çœŸæ˜¯æŒ‡æˆ‘ä»¬å¯ä»¥é‡‡æ ·å¤§é‡çš„<strong>è½¨è¿¹</strong>\(\tau\)ï¼ˆä»ç­–ç•¥\(\pi\)é‡‡æ ·ï¼‰ï¼Œè®¡ç®—æ‰€æœ‰è½¨è¿¹\(\tau\)çš„çœŸå®å›æŠ¥ï¼Œç„¶åè®¡ç®—å¹³å‡å€¼ã€‚</li> <li>è’™ç‰¹å¡æ´›æ–¹æ³•ä½¿ç”¨<strong>ç»éªŒå¹³å‡å›æŠ¥</strong>ï¼ˆempirical mean return) çš„æ–¹æ³•æ¥ä¼°è®¡ï¼Œå®ƒä¸éœ€è¦é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„çŠ¶æ€è½¬ç§»å‡½æ•°å’Œå¥–åŠ±å‡½æ•°ï¼Œå¹¶ä¸”ä¸éœ€è¦åƒåŠ¨æ€è§„åˆ’é‚£æ ·ç”¨bootstrapçš„æ–¹æ³•ã€‚</li> <li>æ­¤å¤–ï¼Œè’™ç‰¹å¡æ´›æ–¹æ³•æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå®ƒåªèƒ½ç”¨åœ¨æœ‰ç»ˆæ­¢çš„é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¸­ã€‚</li> </ul> </li> <li>ä¸ºäº†å¾—åˆ°è¯„ä¼° \(V(s)\) ï¼Œæˆ‘ä»¬é‡‡å–äº†å¦‚ä¸‹çš„æ­¥éª¤ã€‚ <ol> <li>åœ¨æ¯ä¸ªå›åˆä¸­ï¼Œå¦‚æœåœ¨æ—¶é—´æ­¥ \(t\) çŠ¶æ€ \(s\) è¢«è®¿é—®äº†ï¼Œé‚£ä¹ˆ <ul> <li>çŠ¶æ€ \(s\) çš„è®¿é—®æ•° \(N(s)\) å¢åŠ  \(1 ï¼Œ N(s) \leftarrow N(s)+1\) ã€‚</li> <li>çŠ¶æ€ \(s\) çš„æ€»çš„å›æŠ¥ \(S(s)\) å¢åŠ  \(G_t, S(s) \leftarrow S(s)+G_{t}\)</li> <li>çŠ¶æ€ \(s\) çš„ä»·å€¼å¯ä»¥é€šè¿‡å›æŠ¥çš„å¹³å‡æ¥ä¼°è®¡ï¼Œå³ \(V(s)=S(s) / N(s)\) ã€‚</li> </ul> </li> <li>æ ¹æ®å¤§æ•°å®šå¾‹ï¼Œåªè¦æˆ‘ä»¬å¾—åˆ°è¶³å¤Ÿå¤šçš„è½¨è¿¹ï¼Œå°±å¯ä»¥è¶‹è¿‘è¿™ä¸ªç­–ç•¥å¯¹åº”çš„ä»·å€¼å‡½æ•°ã€‚å½“ \(N(s) \rightarrow \infty\)æ—¶ï¼Œ \(V(s) \rightarrow V_\pi(s)\) ã€‚</li> </ol> </li> <li> <p>å…·ä½“æ›´æ–°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<strong>ç»éªŒå‡å€¼</strong>ï¼ˆempirical meanï¼‰è½¬æ¢æˆ<strong>å¢é‡å‡å€¼</strong>ï¼ˆincremental meanï¼‰çš„å½¢å¼ï¼š</p> \[\begin{aligned}\mu_t &amp; =\frac{1}{t} \sum_{j=1}^t x_j \\&amp; =\frac{1}{t}\left(x_t+\sum_{j=1}^{t-1} x_j\right) \\&amp; =\frac{1}{t}\left(x_t+(t-1) \mu_{t-1}\right) \\&amp; =\mu_{t-1}+\frac{1}{t}\left(x_t-\mu_{t-1}\right)\end{aligned}\] </li> <li>å¢é‡å‡å€¼å½¢å¼çš„MCç®—æ³•ï¼š <ul> <li>é‡‡æ ·ä¸€è½®æ¸¸æˆ\(\left(S_1, A_1, R_1, \ldots, S_t\right)\)</li> <li> <p>å¯¹æ¯ä¸€ä¸ªçŠ¶æ€\(S_t\)å’Œå›æŠ¥\(G_t\)</p> \[\begin{aligned} &amp; N\left(S_t\right) \leftarrow N\left(S_t\right)+1 \\ &amp; v\left(S_t\right) \leftarrow v\left(S_t\right)+\frac{1}{N\left(S_t\right)}\left(G_t-v\left(S_t\right)\right) \end{aligned}\] </li> <li> <p>æˆ–è€…å¯ä»¥ç”¨running mean. å¯¹äºnon-stationaryé—®é¢˜æœ‰å¥½å¤„ï¼Œ\(\alpha\)æ˜¯learning rate</p> \[v\left(S_t\right) \leftarrow v\left(S_t\right)+\alpha\left(G_t-v\left(S_t\right)\right)Â \] </li> </ul> </li> </ol> <h3 id="212-è’™ç‰¹å¡æ´›æ–¹æ³•å’ŒåŠ¨æ€è§„åˆ’æ–¹æ³•">2.1.2 è’™ç‰¹å¡æ´›æ–¹æ³•å’ŒåŠ¨æ€è§„åˆ’æ–¹æ³•</h3> <ol> <li> <p>åœ¨åŠ¨æ€è§„åˆ’æ–¹æ³•é‡Œé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†bootstrapçš„æ€æƒ³ã€‚bootstrapå°±æ˜¯æˆ‘ä»¬åŸºäºä¹‹å‰ä¼°è®¡çš„é‡æ¥ä¼°è®¡ä¸€ä¸ªé‡ã€‚æ­¤å¤–ï¼ŒåŠ¨æ€è§„åˆ’æ–¹æ³•ä½¿ç”¨è´å°”æ›¼æœŸæœ›å¤‡ä»½ï¼ˆBellman expectation backupï¼‰ï¼Œé€šè¿‡ä¸Šä¸€æ—¶åˆ»çš„\(V_{t}\)æ›´æ–°è¿™ä¸€æ—¶åˆ»çš„\(V_{t+1}\).</p> \[V_{t+1}(s) \leftarrow \sum_{a \in \mathcal{A}} \pi(a \mid s)\left(R(s, a)+\gamma \sum_{s^{\prime} \in \mathcal{S}} P\left(s^{\prime} \mid s, a\right) V_{t}\left(s^{\prime}\right)\right)\] <p>å°†å…¶ä¸åœè¿­ä»£ï¼Œæœ€åå¯ä»¥æ”¶æ•›ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œè´å°”æ›¼æœŸæœ›å…¬å¼æœ‰ä¸¤å±‚åŠ å’Œï¼Œå³å†…éƒ¨åŠ å’Œå’Œå¤–éƒ¨åŠ å’Œï¼Œéœ€è¦çŸ¥é“æ‰€æœ‰çš„çŠ¶æ€å’Œè½¬ç§»çŸ©é˜µï¼ˆmodelï¼‰è®¡ç®—ä¸¤æ¬¡æœŸæœ›ï¼Œå¾—åˆ°ä¸€ä¸ªæ›´æ–°ã€‚</p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%202-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%202-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%202-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%202.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li> <p>è’™ç‰¹å¡æ´›æ–¹æ³•é€šè¿‡ä¸€ä¸ªå›åˆçš„ç»éªŒå¹³å‡å›æŠ¥ï¼ˆå®é™…å¾—åˆ°çš„å¥–åŠ±ï¼‰æ¥è¿›è¡Œæ›´æ–°ï¼Œå³</p> \[V\left(s_t\right) \leftarrow V\left(s_t\right)+\alpha\left(G_{i, t}-V\left(s_t\right)\right)\] </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%203-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%203-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%203-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%203.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å¦‚å›¾ï¼Œæˆ‘ä»¬ä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•å¾—åˆ°çš„è½¨è¿¹å¯¹åº”æ ‘ä¸Šè“è‰²çš„è½¨è¿¹ï¼Œè½¨è¿¹ä¸Šçš„çŠ¶æ€å·²ç»æ˜¯å†³å®šçš„ï¼Œé‡‡å–çš„åŠ¨ä½œä¹Ÿæ˜¯å·²ç»å†³å®šçš„ã€‚æˆ‘ä»¬ç°åœ¨åªæ›´æ–°è¿™æ¡è½¨è¿¹ä¸Šçš„æ‰€æœ‰çŠ¶æ€ï¼Œä¸è¿™æ¡è½¨è¿¹æ²¡æœ‰å…³ç³»çš„çŠ¶æ€éƒ½ä¸è¿›è¡Œæ›´æ–°ã€‚
</code></pre></div></div> <ol> <li><strong>è’™ç‰¹å¡æ´›æ–¹æ³•</strong>ç›¸æ¯”<strong>åŠ¨æ€è§„åˆ’æ–¹æ³•</strong>æ˜¯æœ‰ä¸€äº›ä¼˜åŠ¿çš„ã€‚ <ol> <li>è’™ç‰¹å¡æ´›æ–¹æ³•é€‚ç”¨äº<strong>ç¯å¢ƒæœªçŸ¥</strong>çš„æƒ…å†µï¼Œè€ŒåŠ¨æ€è§„åˆ’æ˜¯<strong>æœ‰æ¨¡å‹</strong>çš„æ–¹æ³•ï¼ˆéœ€è¦è½¬ç§»çŸ©é˜µï¼‰ã€‚</li> <li>å³ä½¿çŸ¥é“äº†ç¯å¢ƒçš„å…¨éƒ¨ä¿¡æ¯ï¼Œè®¡ç®—è½¬ç§»æ¦‚ç‡å¾€å¾€ä¹Ÿæ˜¯å¾ˆå¤æ‚çš„ã€‚</li> <li>è’™ç‰¹å¡æ´›æ–¹æ³•åªéœ€è¦æ›´æ–°<strong>ä¸€æ¡è½¨è¿¹</strong>çš„çŠ¶æ€ï¼Œè€ŒåŠ¨æ€è§„åˆ’æ–¹æ³•éœ€è¦æ›´æ–°<strong>æ‰€æœ‰çš„çŠ¶æ€</strong>ã€‚çŠ¶æ€æ•°é‡å¾ˆå¤šçš„æ—¶å€™ï¼ˆæ¯”å¦‚100ä¸‡ä¸ªã€200ä¸‡ä¸ªï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨åŠ¨æ€è§„åˆ’æ–¹æ³•è¿›è¡Œè¿­ä»£ï¼Œé€Ÿåº¦æ˜¯éå¸¸æ…¢ã€‚</li> </ol> </li> </ol> <h2 id="22-æ—¶åºå·®åˆ†æ–¹æ³•">2.2 æ—¶åºå·®åˆ†æ–¹æ³•</h2> <p>æ—¶åºå·®åˆ†æ˜¯ä»‹äºè’™ç‰¹å¡æ´›å’ŒåŠ¨æ€è§„åˆ’ä¹‹é—´çš„æ–¹æ³•ï¼Œå®ƒæ˜¯å…æ¨¡å‹çš„ï¼Œä¸éœ€è¦é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„è½¬ç§»çŸ©é˜µå’Œå¥–åŠ±å‡½æ•°ã€‚ æ­¤å¤–ï¼Œæ—¶åºå·®åˆ†æ–¹æ³•å¯ä»¥ä»ä¸å®Œæ•´çš„å›åˆä¸­å­¦ä¹ ï¼Œå¹¶ä¸”ç»“åˆäº†bootstrapçš„æ€æƒ³ã€‚</p> <ol> <li>ç‰¹ç‚¹ï¼š <ol> <li>ç›´æ¥ä»è½¨è¿¹ä¸­å­¦ä¹ </li> <li>å…æ¨¡å‹ï¼šä¸éœ€è¦MDPçš„è½¬ç§»æ¦‚ç‡å’Œå¥–åŠ±</li> <li>é€šè¿‡bootstrapä»<strong>ä¸å®Œæ•´</strong>çš„è½¨è¿¹ä¸­å­¦ä¹ </li> </ol> </li> <li>æ—¶åºå·®åˆ†æ–¹æ³•çš„ç›®çš„æ˜¯å¯¹äºæŸä¸ªç»™å®šçš„ç­–ç•¥\(\pi\)ï¼Œåœ¨çº¿ï¼ˆonlineï¼‰åœ°ç®—å‡ºå®ƒçš„ä»·å€¼å‡½æ•°\(V_\pi\)ï¼Œå³ä¸€æ­¥ä¸€æ­¥åœ°ï¼ˆstep-by-stepï¼‰ç®—ã€‚ <ol> <li> <p>æœ€ç®€å•çš„ç®—æ³•æ˜¯ä¸€æ­¥æ—¶åºå·®åˆ†ï¼ˆone-step TDï¼‰ï¼ŒTD(0)ï¼š</p> \[V\left(s_t\right) \leftarrow V\left(s_t\right)+\alpha\left[\textcolor{red}{R_t+\gamma V\left(s_{t+1}\right)}-V\left(s_t\right)\right]\] </li> <li>\(R_{t+1}+\gamma V\left(S_{t+1}\right)\) æ˜¯TDç›®æ ‡</li> <li>\(\delta_t=R_{t+1}+\gamma V\left(S_{t+1}\right)-V\left(S_t\right)\)æ˜¯TD error</li> </ol> <p>ğŸ˜ MCå’ŒTDï¼š ç±»æ¯”å¢é‡å¼è’™ç‰¹å¡æ´›æ–¹æ³•ï¼Œç»™å®šä¸€ä¸ªå›åˆ\(i\)ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–°Â \(V(s_t)\) æ¥é€¼è¿‘çœŸå®çš„å›æŠ¥ï¼Œå…·ä½“æ›´æ–°å…¬å¼ä¸º:</p> \[V\left(s_t\right) \leftarrow V\left(s_t\right)+\alpha\left(\textcolor{red}{G_{i, t}}-V\left(s_t\right)\right)\] <p>å›é¡¾è´å°”æ›¼æœŸæœ›æ–¹ç¨‹ä¾¿çŸ¥é“åŸå› ï¼š</p> \[\begin{aligned}V_\pi(s) &amp; =\mathbb{E}_\pi\left[G_t \mid S_t=s\right] \\&amp; =\mathbb{E}_\pi\left[\sum_{k=0}^{\infty} \gamma^k R_{t+k} \mid S_t=s\right] \\&amp; =\mathbb{E}_\pi\left[R_t+\gamma \sum_{k=0}^{\infty} \gamma^k R_{t+k+1} \mid S_t=s\right] \\&amp; =\mathbb{E}_\pi\left[R_t+\gamma V_\pi\left(S_{t+1}\right) \mid S_t=s\right]\end{aligned}\] <p><strong>è’™ç‰¹å¡æ´›æ–¹æ³•</strong>å°†ä¸Šå¼<strong>ç¬¬ä¸€è¡Œ</strong>ä½œä¸ºæ›´æ–°çš„ç›®æ ‡ï¼Œè€Œ<strong>æ—¶åºå·®åˆ†ç®—æ³•</strong>å°†ä¸Šå¼<strong>æœ€åä¸€è¡Œ</strong>ä½œä¸ºæ›´æ–°çš„ç›®æ ‡ã€‚äºæ˜¯ï¼Œåœ¨ç”¨ç­–ç•¥å’Œç¯å¢ƒäº¤äº’æ—¶ï¼Œæ¯é‡‡æ ·ä¸€æ­¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æ—¶åºå·®åˆ†ç®—æ³•æ¥æ›´æ–°çŠ¶æ€ä»·å€¼ä¼°è®¡ã€‚æ—¶åºå·®åˆ†ç®—æ³•ç”¨åˆ°äº†\(V(s_{t+1})\)çš„ä¼°è®¡å€¼ï¼Œå¯ä»¥è¯æ˜å®ƒæœ€ç»ˆæ”¶æ•›åˆ°ç­–ç•¥\(\pi\) çš„ä»·å€¼å‡½æ•°ã€‚</p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%204-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%204-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%204-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%204.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%205-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%205-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%205-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%205.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>è¿›ä¸€æ­¥æ¯”è¾ƒæ—¶åºå·®åˆ†æ–¹æ³•å’Œè’™ç‰¹å¡æ´›æ–¹æ³•ã€‚

- æ—¶åºå·®åˆ†æ–¹æ³•å¯ä»¥**åœ¨çº¿å­¦ä¹ **ï¼ˆonline learningï¼‰ï¼Œæ¯èµ°ä¸€æ­¥å°±å¯ä»¥æ›´æ–°æ•ˆç‡é«˜ã€‚è’™ç‰¹å¡æ´›æ–¹æ³•å¿…é¡»ç­‰æ¸¸æˆç»“æŸæ—¶æ‰å¯ä»¥å­¦ä¹ ã€‚
- æ—¶åºå·®åˆ†æ–¹æ³•å¯ä»¥ä»**ä¸å®Œæ•´åºåˆ—**ä¸Šè¿›è¡Œå­¦ä¹ ã€‚è’™ç‰¹å¡æ´›æ–¹æ³•åªèƒ½ä»**å®Œæ•´çš„åºåˆ—**ä¸Šè¿›è¡Œå­¦ä¹ ã€‚
- æ—¶åºå·®åˆ†æ–¹æ³•å¯ä»¥åœ¨**è¿ç»­çš„ç¯å¢ƒä¸‹**ï¼ˆæ²¡æœ‰ç»ˆæ­¢ï¼‰è¿›è¡Œå­¦ä¹ ã€‚è’™ç‰¹å¡æ´›æ–¹æ³•åªèƒ½åœ¨**æœ‰ç»ˆæ­¢**çš„æƒ…å†µä¸‹å­¦ä¹ ã€‚
- æ—¶åºå·®åˆ†æ–¹æ³•åˆ©ç”¨äº†**é©¬å°”å¯å¤«æ€§è´¨**ï¼Œåœ¨é©¬å°”å¯å¤«ç¯å¢ƒä¸‹æœ‰æ›´é«˜çš„å­¦ä¹ æ•ˆç‡ã€‚è’™ç‰¹å¡æ´›æ–¹æ³•æ²¡æœ‰å‡è®¾ç¯å¢ƒå…·æœ‰é©¬å°”å¯å¤«æ€§è´¨ï¼Œåˆ©ç”¨é‡‡æ ·çš„ä»·å€¼æ¥ä¼°è®¡æŸä¸ªçŠ¶æ€çš„ä»·å€¼ï¼Œåœ¨ä¸æ˜¯é©¬å°”å¯å¤«çš„ç¯å¢ƒä¸‹æ›´åŠ æœ‰æ•ˆã€‚
</code></pre></div></div> <ol> <li>å¤šæ­¥æ—¶åºå·®åˆ†ï¼ˆn-step TDï¼‰ï¼šä¹‹å‰æ˜¯åªå¾€å‰èµ°ä¸€æ­¥ï¼Œå³TD(0)ã€‚ æˆ‘ä»¬å¯ä»¥è°ƒæ•´æ­¥æ•°ï¼ˆstepï¼‰ï¼Œå˜æˆ<strong><em>n</em>æ­¥æ—¶åºå·®åˆ†ã€‚</strong></li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%206-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%206-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%206-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%206.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ­¥æ•°æ¥è°ƒæ•´ç®—æ³•éœ€è¦çš„å®é™…å¥–åŠ±å’Œbootstrapã€‚

$$
\begin{aligned}  n=1(\mathrm{TD}) \quad &amp; G_t^{(1)}=r_{t+1}+\gamma V\left(s_{t+1}\right) \\ n=2(\mathrm{TD(2)})) \quad &amp; G_t^{(2)}=r_{t+1}+\gamma r_{t+2}+\gamma^2 V\left(s_{t+2}\right) \\ \ldots \\ n=\infty(\mathrm{MC}) \quad &amp; G_t^{\infty} \begin{array}{l}=r_{t+1}+\gamma r_{t+2}+\ldots+\gamma^{T-t-1} r_T\end{array}\end{aligned}
$$

é€šè¿‡è°ƒæ•´æ­¥æ•°ï¼Œå¯ä»¥è¿›è¡Œè’™ç‰¹å¡æ´›æ–¹æ³•å’Œæ—¶åºå·®åˆ†æ–¹æ³•ä¹‹é—´çš„æƒè¡¡ã€‚å¦‚æœ$$n=\infty$$ï¼Œ å³æ•´ä¸ªæ¸¸æˆç»“æŸåï¼Œå†è¿›è¡Œæ›´æ–°ï¼Œæ—¶åºå·®åˆ†æ–¹æ³•å°±å˜æˆäº†è’™ç‰¹å¡æ´›æ–¹æ³•ã€‚*n*æ­¥æ—¶åºå·®åˆ†å¯å†™ä¸º:

$$
G_t^n=r_{t+1}+\gamma r_{t+2}+\ldots+\gamma^{n-1} r_{t+n}+\gamma^n V\left(s_{t+n}\right)
$$

å¾—åˆ°æ—¶åºå·®åˆ†ç›®æ ‡ä¹‹åï¼Œæˆ‘ä»¬ç”¨å¢é‡å¼å­¦ä¹  (incremental learning) çš„æ–¹æ³•æ¥æ›´æ–°çŠ¶æ€çš„ä»·å€¼:

$$
V\left(s_t\right) \leftarrow V\left(s_t\right)+\alpha\left(G_t^n-V\left(s_t\right)\right)Â 
$$
</code></pre></div></div> <h2 id="23-é‡‡æ ·å’Œbootrap">2.3 é‡‡æ ·å’Œbootrap</h2> <p>åŠ¨æ€è§„åˆ’æ–¹æ³•ã€è’™ç‰¹å¡æ´›æ–¹æ³•ä»¥åŠæ—¶åºå·®åˆ†æ–¹æ³•çš„bootstrapå’Œé‡‡æ ·æœ‰ä»€ä¹ˆè”ç³»å’ŒåŒºåˆ«å‘¢ï¼Ÿ</p> <h3 id="231-é‡‡æ ·å’Œbootrapæƒ…å½¢">2.3.1 é‡‡æ ·å’Œbootrapæƒ…å½¢</h3> <ol> <li><strong>Bootstrapæ˜¯æŒ‡æ›´æ–°æ—¶ä½¿ç”¨äº†ä¼°è®¡</strong>ã€‚ <ol> <li>è’™ç‰¹å¡æ´›æ–¹æ³•æ²¡æœ‰ä½¿ç”¨bootstrapï¼Œå› ä¸ºå®ƒæ ¹æ®å®é™…çš„å›æŠ¥è¿›è¡Œæ›´æ–°ã€‚</li> <li>åŠ¨æ€è§„åˆ’æ–¹æ³•å’Œæ—¶åºå·®åˆ†æ–¹æ³•ä½¿ç”¨äº†bootstrapã€‚</li> </ol> </li> <li><strong>é‡‡æ ·æ˜¯æŒ‡æ›´æ–°æ—¶é€šè¿‡é‡‡æ ·å¾—åˆ°ä¸€ä¸ªæœŸæœ›</strong>ã€‚ <ol> <li>è’™ç‰¹å¡æ´›æ–¹æ³•æ˜¯çº¯é‡‡æ ·çš„æ–¹æ³•ã€‚</li> <li>åŠ¨æ€è§„åˆ’æ–¹æ³•æ²¡æœ‰ä½¿ç”¨é‡‡æ ·ï¼Œå®ƒæ˜¯ç›´æ¥ç”¨è´å°”æ›¼æœŸæœ›æ–¹ç¨‹æ¥æ›´æ–°çŠ¶æ€ä»·å€¼çš„ã€‚</li> <li>æ—¶åºå·®åˆ†æ–¹æ³•ä½¿ç”¨äº†é‡‡æ ·ã€‚æ—¶åºå·®åˆ†ç›®æ ‡ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†æ˜¯é‡‡æ ·ï¼Œä¸€éƒ¨åˆ†æ˜¯bootstrapã€‚</li> </ol> </li> </ol> <h3 id="232-dp-mc-td">2.3.2 DP, MC, TD</h3> <ol> <li> <p>åŠ¨æ€è§„åˆ’æ–¹æ³•ç›´æ¥è®¡ç®—æœŸæœ›ï¼Œå®ƒæŠŠæ‰€æœ‰ç›¸å…³çš„çŠ¶æ€éƒ½è¿›è¡ŒåŠ å’Œï¼Œå³</p> \[V\left(s_t\right) \leftarrow \mathbb{E}_\pi\left[r_{t+1}+\gamma V\left(s_{t+1}\right)\right]\] </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%207-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%207-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%207-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%207.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li> <p>è’™ç‰¹å¡æ´›æ–¹æ³•åœ¨å½“å‰çŠ¶æ€ä¸‹ï¼Œé‡‡å–ä¸€æ¡æ”¯è·¯ï¼Œåœ¨è¿™æ¡è·¯å¾„ä¸Šè¿›è¡Œæ›´æ–°ï¼Œæ›´æ–°è¿™æ¡è·¯å¾„ä¸Šçš„æ‰€æœ‰çŠ¶æ€ï¼Œå³</p> \[V\left(s_t\right) \leftarrow V\left(s_t\right)+\alpha\left(G_t-V\left(s_t\right)\right)\] </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%208-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%208-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%208-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%208.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li> <p>æ—¶åºå·®åˆ†ä»å½“å‰çŠ¶æ€å¼€å§‹ï¼Œå¾€å‰èµ°äº†ä¸€æ­¥ï¼Œå…³æ³¨çš„æ˜¯éå¸¸å±€éƒ¨çš„æ­¥éª¤ï¼Œå³</p> \[\mathrm{TD}(0): V\left(s_t\right) \leftarrow V\left(s_t\right)+\alpha\left(r_{t+1}+\gamma V\left(s_{t+1}\right)-V\left(s_t\right)\right)\] </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%209-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%209-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%209-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%209.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>å¦‚æœæ—¶åºå·®åˆ†æ–¹æ³•éœ€è¦æ›´å¹¿åº¦çš„æ›´æ–°ï¼Œå°±å˜æˆäº†åŠ¨æ€è§„åˆ’æ–¹æ³•ï¼ˆå› ä¸ºåŠ¨æ€è§„åˆ’æ–¹æ³•æ˜¯æŠŠæ‰€æœ‰çŠ¶æ€éƒ½è€ƒè™‘è¿›å»æ¥è¿›è¡Œæ›´æ–°ï¼‰ã€‚å¦‚æœæ—¶åºå·®åˆ†æ–¹æ³•éœ€è¦æ›´æ·±åº¦çš„æ›´æ–°ï¼Œå°±å˜æˆäº†è’™ç‰¹å¡æ´›æ–¹æ³•ã€‚å›¾ å³ä¸‹è§’æ˜¯ç©·ä¸¾æœç´¢çš„æ–¹æ³•ï¼ˆexhaustive searchï¼‰ï¼Œç©·ä¸¾æœç´¢çš„æ–¹æ³•ä¸ä»…éœ€è¦å¾ˆæ·±åº¦çš„ä¿¡æ¯ï¼Œè¿˜éœ€è¦å¾ˆå¹¿åº¦çš„ä¿¡æ¯ã€‚</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2010-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2010-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2010-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2010.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h1 id="ä¸‰å…æ¨¡å‹æ§åˆ¶">ä¸‰ã€å…æ¨¡å‹æ§åˆ¶</h1> <h2 id="31-å¹¿ä¹‰ç­–ç•¥è¿­ä»£">3.1 å¹¿ä¹‰ç­–ç•¥è¿­ä»£</h2> <p>åœ¨æˆ‘ä»¬ä¸çŸ¥é“é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹æ¨¡å‹çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•ä¼˜åŒ–ä»·å€¼å‡½æ•°ï¼Œå¾—åˆ°æœ€ä½³çš„ç­–ç•¥å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æŠŠç­–ç•¥è¿­ä»£è¿›è¡Œå¹¿ä¹‰çš„æ¨å¹¿ï¼Œä½¿å®ƒèƒ½å¤Ÿå…¼å®¹è’™ç‰¹å¡æ´›å’Œæ—¶åºå·®åˆ†çš„æ–¹æ³•ï¼Œå³å¸¦æœ‰<strong>è’™ç‰¹å¡æ´›æ–¹æ³•</strong>å’Œ<strong>æ—¶åºå·®åˆ†</strong>æ–¹æ³•çš„<strong>å¹¿ä¹‰ç­–ç•¥è¿­ä»£ï¼ˆgeneralized policy iterationï¼ŒGPIï¼‰</strong></p> <p>å½“æˆ‘ä»¬ä¸çŸ¥é“å¥–åŠ±å‡½æ•°å’ŒçŠ¶æ€è½¬ç§»æ—¶ï¼Œå¦‚ä½•è¿›è¡Œç­–ç•¥çš„ä¼˜åŒ–ï¼Ÿæˆ‘ä»¬å¼•å…¥äº†å¹¿ä¹‰çš„ç­–ç•¥è¿­ä»£çš„æ–¹æ³•ã€‚ æˆ‘ä»¬å¯¹ç­–ç•¥è¯„ä¼°éƒ¨åˆ†è¿›è¡Œä¿®æ”¹ï¼Œä½¿ç”¨è’™ç‰¹å¡æ´›çš„æ–¹æ³•ä»£æ›¿åŠ¨æ€è§„åˆ’çš„æ–¹æ³•ä¼°è®¡ \(Q\) å‡½æ•°ã€‚æˆ‘ä»¬é¦–å…ˆè¿›è¡Œç­–ç•¥è¯„ä¼°ï¼Œä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•æ¥ä¼°è®¡ç­–ç•¥Â \(Q=Q_\pi\)ï¼Œç„¶åè¿›è¡Œç­–ç•¥æ›´æ–°ï¼Œå³å¾—åˆ° \(Q\) å‡½æ•°åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è´ªå¿ƒçš„æ–¹æ³•å»æ”¹è¿›å®ƒï¼š</p> \[\pi(s)=\underset{a}{\arg \max } Q(s, a)\] <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2011-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2011-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2011-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2011.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="32-è’™ç‰¹å¡æ´›æ–¹æ³•">3.2 è’™ç‰¹å¡æ´›æ–¹æ³•</h2> <h3 id="321-æ¢ç´¢æ€§å¼€å§‹çš„mc">3.2.1 æ¢ç´¢æ€§å¼€å§‹çš„MC</h3> <p>ä¸€ä¸ªä¿è¯ç­–ç•¥è¿­ä»£æ”¶æ•›çš„<strong>å‡è®¾</strong>æ˜¯å›åˆæœ‰<strong>æ¢ç´¢æ€§å¼€å§‹ï¼ˆexploring startï¼‰</strong>ã€‚å‡è®¾æ¯ä¸€ä¸ªå›åˆéƒ½æœ‰ä¸€ä¸ª<strong>æ¢ç´¢æ€§å¼€å§‹</strong>ï¼Œæ¢ç´¢æ€§å¼€å§‹ä¿è¯æ‰€æœ‰çš„çŠ¶æ€å’ŒåŠ¨ä½œéƒ½åœ¨æ— é™æ­¥çš„æ‰§è¡Œåèƒ½è¢«é‡‡æ ·åˆ°ï¼Œè¿™æ ·æ‰èƒ½å¾ˆå¥½åœ°è¿›è¡Œä¼°è®¡ã€‚ ç®—æ³•é€šè¿‡è’™ç‰¹å¡æ´›æ–¹æ³•äº§ç”Ÿå¾ˆå¤šè½¨è¿¹ï¼Œæ¯æ¡è½¨è¿¹éƒ½å¯ä»¥ç®—å‡ºå®ƒçš„ä»·å€¼ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¹³å‡çš„æ–¹æ³•å»ä¼°è®¡ Q å‡½æ•°ã€‚Q å‡½æ•°å¯ä»¥çœ‹æˆä¸€ä¸ªè¡¨æ ¼ï¼Œæˆ‘ä»¬é€šè¿‡é‡‡æ ·çš„æ–¹æ³•æŠŠè¡¨æ ¼çš„æ¯ä¸ªå•å…ƒå€¼éƒ½å¡«ä¸Šï¼Œç„¶åä½¿ç”¨ç­–ç•¥æ”¹è¿›æ¥é€‰å–æ›´å¥½çš„ç­–ç•¥ã€‚ å¦‚ä½•ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•æ¥å¡« Q è¡¨æ ¼æ˜¯è¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒã€‚</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2012-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2012-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2012-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2012.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="322-å¸¦æœ‰varepsilon-greedyçš„è´ªå¿ƒç­–ç•¥">3.2.2 å¸¦æœ‰\(\varepsilon\)-greedyçš„è´ªå¿ƒç­–ç•¥</h3> <p>ä¸ºäº†ç¡®ä¿è’™ç‰¹å¡æ´›æ–¹æ³•èƒ½å¤Ÿæœ‰è¶³å¤Ÿçš„æ¢ç´¢ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Â \(\varepsilon\)-è´ªå¿ƒæ¢ç´¢ã€‚Â \(\varepsilon\)-è´ªå¿ƒæ˜¯æŒ‡æˆ‘ä»¬æœ‰Â Â \(1-\varepsilon\)Â çš„æ¦‚ç‡ä¼šæŒ‰ç…§ Qå‡½æ•°æ¥å†³å®šåŠ¨ä½œï¼Œé€šå¸¸Â \(\varepsilon\) å°±è®¾ä¸€ä¸ªå¾ˆå°çš„å€¼ï¼ŒÂ \(1-\varepsilon\)Â å¯èƒ½æ˜¯ 0.9ï¼Œä¹Ÿå°±æ˜¯ 0.9 çš„æ¦‚ç‡ä¼šæŒ‰ç…§Qå‡½æ•°æ¥å†³å®šåŠ¨ä½œï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰ 0.1 çš„æ¦‚ç‡æ˜¯éšæœºçš„ã€‚é€šå¸¸åœ¨å®ç°ä¸Šï¼ŒÂ \(\varepsilon\) çš„å€¼ä¼šéšç€æ—¶é—´é€’å‡ã€‚åœ¨æœ€å¼€å§‹çš„æ—¶å€™ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜ä¸çŸ¥é“å“ªä¸ªåŠ¨ä½œæ˜¯æ¯”è¾ƒå¥½çš„ï¼Œæ‰€ä»¥ä¼šèŠ±æ¯”è¾ƒå¤šçš„æ—¶é—´æ¢ç´¢ã€‚æ¥ä¸‹æ¥éšç€è®­ç»ƒçš„æ¬¡æ•°è¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä»¬å·²ç»æ¯”è¾ƒç¡®å®šå“ªä¸€ä¸ªåŠ¨ä½œæ˜¯æ¯”è¾ƒå¥½çš„ï¼Œå°±ä¼šå‡å°‘æ¢ç´¢ï¼ŒæŠŠÂ \(\varepsilon\)Â çš„å€¼å˜å°ã€‚ä¸»è¦æ ¹æ® Q å‡½æ•°æ¥å†³å®šåŠ¨ä½œï¼Œæ¯”è¾ƒå°‘éšæœºå†³å®šåŠ¨ä½œï¼Œè¿™å°±æ˜¯\(\varepsilon\)-è´ªå¿ƒã€‚</p> \[\pi(a \mid s)= \begin{cases}\epsilon /|\mathcal{A}|+1-\epsilon &amp; \text { if } a^*=\arg \max _{a \in \mathcal{A}} Q(s, a) \\ \epsilon /|\mathcal{A}| &amp; \text { otherwise }\end{cases}\] <p>å½“æˆ‘ä»¬ä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•å’Œ\(\varepsilon\)-è´ªå¿ƒæ¢ç´¢çš„æ—¶å€™ï¼Œå¯ä»¥ç¡®ä¿ä»·å€¼å‡½æ•°æ˜¯å•è°ƒçš„ã€æ”¹è¿›çš„ã€‚å¯¹äºä»»ä½•Â \(\epsilon\)-è´ªå¿ƒç­–ç•¥Â \(\pi\)ï¼Œå…³äºÂ \(Q_\pi\)Â çš„Â \(\varepsilon\)-è´ªå¿ƒç­–ç•¥Â \(\pi'\)Â éƒ½æ˜¯ä¸€ä¸ªæ”¹è¿›ï¼Œå³Â \(V_{\pi}(s)\leq V_{\pi'}(s)\)ï¼Œè¯æ˜è¿‡ç¨‹å¦‚ä¸‹ï¼š</p> \[\begin{aligned}V_\pi\left(s, \pi^{\prime}(s)\right) &amp; =\sum_{a \in A} \pi^{\prime}(a \mid s) Q_\pi(s, a) \\&amp; =\frac{\varepsilon}{|A|} \sum_{a \in A} Q_\pi(s, a)+(1-\varepsilon) \max _a Q_\pi(s, a) \\&amp; \geqslant \frac{\varepsilon}{|A|} \sum_{a \in A} Q_\pi(s, a)+(1-\varepsilon) \sum_{a \in A} \frac{\pi(a \mid s)-\frac{\varepsilon}{|A|}}{1-\varepsilon} Q_\pi(s, a) \\&amp; =\sum_{a \in A} \pi(a \mid s) Q_\pi(s, a)=V_\pi(s)\end{aligned}\] <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2013-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2013-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2013-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2013.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="33-æ—¶åºå·®åˆ†æ–¹æ³•">3.3 æ—¶åºå·®åˆ†æ–¹æ³•</h2> <p>ä¸è’™ç‰¹å¡æ´›æ–¹æ³•ç›¸æ¯”ï¼Œæ—¶åºå·®åˆ†æ–¹æ³•æœ‰å¦‚ä¸‹å‡ ä¸ªä¼˜åŠ¿ï¼š<strong>ä½æ–¹å·®ï¼Œèƒ½å¤Ÿåœ¨çº¿å­¦ä¹ ï¼Œèƒ½å¤Ÿä»ä¸å®Œæ•´çš„åºåˆ—ä¸­å­¦ä¹ ã€‚</strong> æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠæ—¶åºå·®åˆ†æ–¹æ³•ä¹Ÿæ”¾åˆ°<strong>æ§åˆ¶å¾ªç¯</strong>ï¼ˆcontrol loopï¼‰é‡Œé¢å»ä¼°è®¡Qè¡¨æ ¼ï¼Œå†é‡‡å–\(\varepsilon\)è´ªå¿ƒæ¢ç´¢æ”¹è¿›ã€‚è¿™æ ·å°±å¯ä»¥åœ¨å›åˆæ²¡ç»“æŸçš„æ—¶å€™æ›´æ–°å·²ç»é‡‡é›†åˆ°çš„çŠ¶æ€ä»·å€¼ã€‚</p> <h3 id="331-sarsa-on-policy-td">3.3.1 Sarsa: on-policy TD</h3> <ol> <li> <p>Sarsaï¼š</p> <p>æ—¶åºå·®åˆ†æ–¹æ³•æ˜¯ç»™å®šä¸€ä¸ªç­–ç•¥ï¼Œç„¶åæˆ‘ä»¬å»ä¼°è®¡å®ƒçš„ä»·å€¼å‡½æ•°ã€‚æ¥ç€æˆ‘ä»¬è¦è€ƒè™‘æ€ä¹ˆä½¿ç”¨æ—¶åºå·®åˆ†æ–¹æ³•çš„æ¡†æ¶æ¥ä¼°è®¡Qå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ Sarsa ç®—æ³•ã€‚</p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2014-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2014-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2014-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2014.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sarsa æ‰€åšå‡ºçš„æ”¹å˜å¾ˆç®€å•ï¼Œå®ƒå°†åŸæœ¬æ—¶åºå·®åˆ†æ–¹æ³•æ›´æ–°Â *V*Â çš„è¿‡ç¨‹ï¼Œå˜æˆäº†æ›´æ–°Â *Q*ï¼Œå³

$$
Q\left(S_t, A_t\right) \leftarrow Q\left(S_t, A_t\right)+\alpha\left[R_{t+1}+\gamma Q\left(S_{t+1}, A_{t+1}\right)-Q\left(S_t, A_t\right)\right]
$$

&gt; æ³¨ï¼špredictionä¸­æˆ‘ä»¬æ›´æ–°Vï¼Œcontrolä¸­æˆ‘ä»¬æ›´æ–°Q
&gt; 
&gt; 
&gt; $$
&gt; V\left(s_t\right) \leftarrow V\left(s_t\right)+\alpha\left(R_{t+1}+\gamma V\left(s_{t+1}\right)-V\left(s_t\right)\right)
&gt; $$
&gt; 

TDç›®æ ‡ï¼š$$\delta_t=R_{t+1}+\gamma Q\left(S_{t+1}, A_{t+1}\right)$$
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2015-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2015-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2015-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2015.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li> <p>n-step Sarsa</p> <p>Sarsa å±äºå•æ­¥æ›´æ–°ç®—æ³•ï¼Œæ¯æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œï¼Œå°±ä¼šæ›´æ–°ä¸€æ¬¡ä»·å€¼å’Œç­–ç•¥ã€‚å¦‚æœä¸è¿›è¡Œå•æ­¥æ›´æ–°ï¼Œè€Œæ˜¯é‡‡å–\(n\)æ­¥æ›´æ–°æˆ–è€…å›åˆæ›´æ–°ï¼Œå³åœ¨æ‰§è¡Œ<em>n</em>æ­¥ä¹‹åå†æ›´æ–°ä»·å€¼å’Œç­–ç•¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†<strong><em>n</em>Â æ­¥ Sarsaï¼ˆ<em>n</em>-step Sarsaï¼‰:</strong></p> \[\begin{aligned}n=1(\text { Sarsa }) q_t^{(1)}= &amp; R_{t+1}+\gamma Q\left(S_{t+1}, A_{t+1}\right) \\n=2 \quad q_t^{(2)}= &amp; R_{t+1}+\gamma R_{t+2}+\gamma^2 Q\left(S_{t+2}, A_{t+2}\right) \\&amp; \vdots &amp; \\n=\infty(M C) \quad q_t^{\infty}= &amp; R_{t+1}+\gamma R_{t+2}+\ldots+\gamma^{T-t-1} R_T\end{aligned}\] <p>n-stepæ”¶ç›Šä¸ºï¼š</p> \[q_t^{(n)}=R_{t+1}+\gamma R_{t+2}+\ldots+\gamma^{n-1} R_{t+n}+\gamma^n Q\left(S_{t+n}, A_{t+n}\right)\] <p>n-stepè¿­ä»£æ›´æ–°ï¼š</p> \[Q\left(S_t, A_t\right) \leftarrow Q\left(S_t, A_t\right)+\alpha\left(q_t^{(n)}-Q\left(S_t, A_t\right)\right)\] </li> </ol> <h3 id="332-q-learning-off-policy-td">3.3.2 Q-learning: off-policy TD</h3> <ol> <li>off-policy <ol> <li>Sarsa æ˜¯ä¸€ç§<strong>åœ¨çº¿ç­–ç•¥ï¼ˆon-policyï¼‰</strong>ç®—æ³•ï¼Œå®ƒä¼˜åŒ–çš„æ˜¯å®ƒå®é™…æ‰§è¡Œçš„ç­–ç•¥ï¼Œå®ƒç›´æ¥ç”¨ä¸‹ä¸€æ­¥ä¼šæ‰§è¡Œçš„åŠ¨ä½œå»ä¼˜åŒ– Q è¡¨æ ¼ã€‚<strong>åœ¨çº¿ç­–ç•¥</strong>åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œåªå­˜åœ¨ä¸€ç§ç­–ç•¥ï¼Œå®ƒç”¨ä¸€ç§ç­–ç•¥å»åšåŠ¨ä½œçš„é€‰å–ï¼Œä¹Ÿç”¨ä¸€ç§ç­–ç•¥å»åšä¼˜åŒ–ã€‚æ‰€ä»¥ Sarsa çŸ¥é“å®ƒä¸‹ä¸€æ­¥çš„åŠ¨ä½œæœ‰å¯èƒ½ä¼šè·‘åˆ°æ‚¬å´–é‚£è¾¹å»ï¼Œå®ƒå°±ä¼šåœ¨ä¼˜åŒ–è‡ªå·±çš„ç­–ç•¥çš„æ—¶å€™ï¼Œå°½å¯èƒ½ç¦»æ‚¬å´–è¿œä¸€ç‚¹ã€‚è¿™æ ·å­å°±ä¼šä¿è¯ï¼Œå®ƒä¸‹ä¸€æ­¥å“ªæ€•æ˜¯æœ‰éšæœºåŠ¨ä½œï¼Œå®ƒä¹Ÿè¿˜æ˜¯åœ¨å®‰å…¨åŒºåŸŸå†…ã€‚</li> <li>Qå­¦ä¹ æ˜¯ä¸€ç§<strong>ç¦»çº¿ç­–ç•¥ï¼ˆoff-policyï¼‰</strong>ç®—æ³•ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œ<strong>ç¦»çº¿ç­–ç•¥</strong>åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸¤ç§ä¸åŒçš„ç­–ç•¥ï¼š<strong>ç›®æ ‡ç­–ç•¥ï¼ˆtarget policyï¼‰</strong>å’Œ<strong>è¡Œä¸ºç­–ç•¥ï¼ˆbehavior policyï¼‰</strong>ã€‚ <ul> <li>ç›®æ ‡ç­–ç•¥æ˜¯æˆ‘ä»¬éœ€è¦å»å­¦ä¹ çš„ç­–ç•¥ï¼Œä¸€èˆ¬ç”¨Â \(\pi\)Â æ¥è¡¨ç¤ºã€‚ç›®æ ‡ç­–ç•¥å°±åƒæ˜¯åœ¨åæ–¹æŒ‡æŒ¥æˆ˜æœ¯çš„ä¸€ä¸ªå†›å¸ˆï¼Œå®ƒå¯ä»¥æ ¹æ®è‡ªå·±çš„ç»éªŒæ¥å­¦ä¹ æœ€ä¼˜çš„ç­–ç•¥ï¼Œä¸éœ€è¦å»å’Œç¯å¢ƒäº¤äº’ã€‚</li> <li>è¡Œä¸ºç­–ç•¥æ˜¯æ¢ç´¢ç¯å¢ƒçš„ç­–ç•¥ï¼Œä¸€èˆ¬ç”¨Â <em>Î¼</em>Â æ¥è¡¨ç¤ºã€‚è¡Œä¸ºç­–ç•¥å¯ä»¥å¤§èƒ†åœ°å»æ¢ç´¢åˆ°æ‰€æœ‰å¯èƒ½çš„è½¨è¿¹ï¼Œé‡‡é›†è½¨è¿¹ï¼Œé‡‡é›†æ•°æ®ï¼Œç„¶åæŠŠé‡‡é›†åˆ°çš„æ•°æ®â€œå–‚â€ç»™ç›®æ ‡ç­–ç•¥å­¦ä¹ ã€‚è€Œä¸”â€œå–‚â€ç»™ç›®æ ‡ç­–ç•¥çš„æ•°æ®ä¸­å¹¶ä¸éœ€è¦Â \(a_{t+1}\)ï¼Œè€Œ Sarsa æ˜¯è¦æœ‰Â \(a_{t+1}\)Â çš„ã€‚è¡Œä¸ºç­–ç•¥åƒæ˜¯ä¸€ä¸ªæˆ˜å£«ï¼Œå¯ä»¥åœ¨ç¯å¢ƒé‡Œé¢æ¢ç´¢æ‰€æœ‰çš„åŠ¨ä½œã€è½¨è¿¹å’Œç»éªŒï¼Œç„¶åæŠŠè¿™äº›ç»éªŒäº¤ç»™ç›®æ ‡ç­–ç•¥å»å­¦ä¹ ã€‚æ¯”å¦‚ç›®æ ‡ç­–ç•¥ä¼˜åŒ–çš„æ—¶å€™ï¼ŒQå­¦ä¹ ä¸ä¼šç®¡æˆ‘ä»¬ä¸‹ä¸€æ­¥å»å¾€å“ªé‡Œæ¢ç´¢ï¼Œå®ƒåªé€‰å–å¥–åŠ±æœ€å¤§çš„ç­–ç•¥ã€‚</li> </ul> </li> </ol> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2016-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2016-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2016-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2016.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>off-policyå­¦ä¹ æœ‰å¾ˆå¤šå¥½å¤„ã€‚ <ol> <li>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¢ç´¢ç­–ç•¥æ¥å­¦åˆ°æœ€ä½³çš„ç­–ç•¥ï¼Œå­¦ä¹ æ•ˆç‡é«˜ï¼›</li> <li>å…¶æ¬¡ï¼Œoff-policyå­¦ä¹ å¯ä»¥è®©æˆ‘ä»¬å­¦ä¹ å…¶ä»–æ™ºèƒ½ä½“çš„åŠ¨ä½œï¼Œè¿›è¡Œæ¨¡ä»¿å­¦ä¹ ï¼Œå­¦ä¹ äººæˆ–è€…å…¶ä»–æ™ºèƒ½ä½“äº§ç”Ÿçš„è½¨è¿¹ï¼›</li> <li>æœ€åï¼Œoff-policyå­¦ä¹ å¯ä»¥è®©æˆ‘ä»¬é‡ç”¨æ—§çš„ç­–ç•¥äº§ç”Ÿçš„è½¨è¿¹ï¼Œæ¢ç´¢è¿‡ç¨‹éœ€è¦å¾ˆå¤šè®¡ç®—èµ„æºï¼Œè¿™æ ·å¯ä»¥èŠ‚çœèµ„æºã€‚</li> </ol> </li> <li> <p>ç¦»çº¿ç®—æ³•ï¼š</p> <p>Qå­¦ä¹ æœ‰ä¸¤ç§ç­–ç•¥: è¡Œä¸ºç­–ç•¥å’Œç›®æ ‡ç­–ç•¥ã€‚</p> <ul> <li> <p>ç›®æ ‡ç­–ç•¥ \(\pi\) ç›´æ¥åœ¨ Q è¡¨æ ¼ä¸Šä½¿ç”¨è´ªå¿ƒç­–ç•¥ï¼Œå–å®ƒä¸‹ä¸€æ­¥èƒ½å¾—åˆ°çš„æ‰€æœ‰çŠ¶æ€ï¼Œå³</p> \[\pi\left(s_{t+1}\right)=\underset{a^{\prime}}{\arg \max } Q\left(s_{t+1}, a^{\prime}\right)Â \] </li> <li> <p>è¡Œä¸ºç­–ç•¥ \(\mu\) å¯ä»¥æ˜¯ä¸€ä¸ªéšæœºçš„ç­–ç•¥ï¼Œä½†æˆ‘ä»¬é‡‡å– \(\varepsilon\)-è´ªå¿ƒç­–ç•¥ï¼Œè®©è¡Œä¸ºç­–ç•¥ä¸è‡³äºæ˜¯å®Œå…¨éšæœºçš„ï¼Œå®ƒæ˜¯åŸºäº Q è¡¨æ ¼é€æ¸æ”¹è¿›çš„ã€‚æˆ‘ä»¬å¯ä»¥æ„é€ Q å­¦ä¹ ç›®æ ‡ï¼Œ Qå­¦ä¹ çš„ä¸‹ä¸€ä¸ªåŠ¨ä½œéƒ½æ˜¯é€šè¿‡ argmax æ“ä½œé€‰å‡ºæ¥çš„ï¼Œäºæ˜¯æˆ‘ä»¬å¯å¾—</p> \[\begin{aligned} r_{t+1}+\gamma Q\left(s_{t+1}, A^{\prime}\right) &amp; =r_{t+1}+\gamma Q\left(s_{t+1}, \underset{a^{\prime}}{\arg \max } Q\left(s_{t+1}, a^{\prime}\right)\right) \\ &amp; =r_{t+1}+\gamma \max_{a^{\prime}} Q\left(s_{t+1}, a^{\prime}\right) \end{aligned}\] <p>æ¥ç€æˆ‘ä»¬å¯ä»¥æŠŠ Q å­¦ä¹ æ›´æ–°å†™æˆå¢é‡å­¦ä¹ çš„å½¢å¼ï¼Œæ—¶åºå·®åˆ†ç›®æ ‡å˜æˆäº† \(r_{t+1}+\gamma \max_a Q\left(s_{t+1}, a\right)\) ï¼Œå³</p> \[Q\left(s_t, a_t\right) \leftarrow Q\left(s_t, a_t\right)+\alpha\left[r_{t+1}+\gamma \max_a Q\left(s_{t+1}, a\right)-Q\left(s_t, a_t\right)\right]\] </li> </ul> </li> <li>Q-learningå’ŒSarsaï¼š</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2017-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2017-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2017-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2017.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2018-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2018-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2018-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2018.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>é€šè¿‡å¤‡ä»½å›¾ä¹Ÿå¯ä»¥çœ‹å‡ºå·®å¼‚ï¼š

- Sarsaé‡Œé¢Aå’ŒAâ€™éƒ½æ˜¯é€šè¿‡ä¸€ä¸ªåŒæ ·çš„policyè¿›è¡Œé‡‡æ ·çš„ï¼Œæ‰€ä»¥æ˜¯åœ¨çº¿ç­–ç•¥
- Q-learningé‡Œé¢ï¼ŒAå’ŒAâ€™ä¸æ˜¯åŒä¸€ä¸ªç­–ç•¥ã€‚Aæ˜¯æ¢ç´¢ç­–ç•¥ï¼ˆç›®æ ‡ç­–ç•¥ï¼‰ï¼ŒAâ€™æ˜¯ç›´æ¥é€šè¿‡maxæ“ä½œå¾—åˆ°çš„ç­–ç•¥ï¼ˆè¡Œä¸ºç­–ç•¥ï¼‰ã€‚
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2019-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2019-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2019-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2019.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. DPå’ŒTDçš„æ€»ç»“ï¼š
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter3/Untitled%2020-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter3/Untitled%2020-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter3/Untitled%2020-1400.webp"/> <img src="/assets/img/RL_chapter3/Untitled%2020.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="333-on-policyå’Œoff-policyçš„åŒºåˆ«">3.3.3 on-policyå’Œoff-policyçš„åŒºåˆ«</h3> <p>æ€»ç»“ä¸€ä¸‹åœ¨çº¿ç­–ç•¥å’Œç¦»çº¿ç­–ç•¥çš„åŒºåˆ«ã€‚</p> <ul> <li>åªç”¨äº†ä¸€ä¸ªç­–ç•¥ \(\pi\)ï¼Œå®ƒä¸ä»…ä½¿ç”¨ç­–ç•¥Â \(\pi\)Â å­¦ä¹ ï¼Œè¿˜ä½¿ç”¨ç­–ç•¥Â \(\pi\)Â ä¸ç¯å¢ƒäº¤äº’äº§ç”Ÿç»éªŒã€‚ å¦‚æœç­–ç•¥é‡‡ç”¨Â \(\epsilon\)è´ªå¿ƒç®—æ³•ï¼Œå®ƒéœ€è¦å…¼é¡¾æ¢ç´¢ï¼Œä¸ºäº†å…¼é¡¾æ¢ç´¢å’Œåˆ©ç”¨ï¼Œå®ƒè®­ç»ƒçš„æ—¶å€™ä¼šæ˜¾å¾—æœ‰ç‚¹â€œèƒ†å°â€ã€‚å®ƒåœ¨è§£å†³æ‚¬å´–è¡Œèµ°é—®é¢˜çš„æ—¶å€™ï¼Œä¼šå°½å¯èƒ½åœ°è¿œç¦»æ‚¬å´–è¾¹ï¼Œç¡®ä¿å“ªæ€•è‡ªå·±ä¸å°å¿ƒæ¢ç´¢äº†ä¸€ç‚¹å„¿ï¼Œä¹Ÿè¿˜æ˜¯åœ¨å®‰å…¨åŒºåŸŸå†…ã€‚æ­¤å¤–ï¼Œå› ä¸ºé‡‡ç”¨çš„æ˜¯Â \(\epsilon\)è´ªå¿ƒ ç®—æ³•ï¼Œç­–ç•¥ä¼šä¸æ–­æ”¹å˜ï¼ˆ\(\epsilon\)Â å€¼ä¼šä¸æ–­å˜å°ï¼‰ï¼Œæ‰€ä»¥ç­–ç•¥ä¸ç¨³å®šã€‚</li> <li>æœ‰ä¸¤ç§ç­–ç•¥â€”â€”â€”â€”ç›®æ ‡ç­–ç•¥å’Œè¡Œä¸ºç­–ç•¥ã€‚ <ul> <li>è¡Œä¸ºç­–ç•¥æ¢ç´¢å¾—åˆ°çš„ç»éªŒè½¨è¿¹æ¥ä¼˜åŒ–ç›®æ ‡ç­–ç•¥ï¼Œä»è€Œæ›´æœ‰å¯èƒ½æ¢ç´¢åˆ°æœ€ä½³ç­–ç•¥ã€‚è¡Œä¸ºç­–ç•¥å¯ä»¥é‡‡ç”¨Â \(\epsilon\)è´ªå¿ƒ ç®—æ³•</li> <li>ç›®æ ‡ç­–ç•¥é‡‡ç”¨çš„æ˜¯è´ªå¿ƒç®—æ³•ï¼Œå®ƒç›´æ¥æ ¹æ®è¡Œä¸ºç­–ç•¥é‡‡é›†åˆ°çš„æ•°æ®æ¥é‡‡ç”¨æœ€ä½³ç­–ç•¥ï¼Œæ‰€ä»¥ä¸éœ€è¦å…¼é¡¾æ¢ç´¢ã€‚</li> <li>off-policyæ˜¯é€šè¿‡ä»è¡Œä¸ºç­–ç•¥\(\mu\)ä¸­çš„ç»éªŒé‡‡æ ·æ¥å­¦ä¹ ç›®æ ‡ç­–ç•¥\(\pi\)</li> </ul> </li> <li>æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹ Qå­¦ä¹  å’Œ Sarsa çš„æ›´æ–°å…¬å¼ï¼Œå°±å¯ä»¥å‘ç° Sarsa å¹¶æ²¡æœ‰é€‰å–æœ€å¤§å€¼çš„æœ€å¤§åŒ–æ“ä½œã€‚å› æ­¤ï¼ŒQå­¦ä¹ æ˜¯ä¸€ä¸ªéå¸¸æ¿€è¿›çš„æ–¹æ³•ï¼Œå®ƒå¸Œæœ›æ¯ä¸€æ­¥éƒ½è·å¾—æœ€å¤§çš„åˆ©ç›Šï¼›Sarsa åˆ™ç›¸å¯¹è¾ƒä¸ºä¿å®ˆï¼Œå®ƒä¼šé€‰æ‹©ä¸€æ¡ç›¸å¯¹å®‰å…¨çš„è¿­ä»£è·¯çº¿ã€‚</li> </ul>]]></content><author><name></name></author><category term="Reinforcement-Learning"/><category term="intro"/><summary type="html"><![CDATA[Tabular methods]]></summary></entry><entry><title type="html">ç¬¬å››ç«  Value Function Approximation and Deep Q-learning (ä»·å€¼å‡½æ•°è¿‘ä¼¼å’Œæ·±åº¦Qå­¦ä¹ )</title><link href="https://gszfwsb.github.io/blog/2023/RL-lecture4/" rel="alternate" type="text/html" title="ç¬¬å››ç«  Value Function Approximation and Deep Q-learning (ä»·å€¼å‡½æ•°è¿‘ä¼¼å’Œæ·±åº¦Qå­¦ä¹ )"/><published>2023-10-30T00:00:00+00:00</published><updated>2023-10-30T00:00:00+00:00</updated><id>https://gszfwsb.github.io/blog/2023/RL-lecture4</id><content type="html" xml:base="https://gszfwsb.github.io/blog/2023/RL-lecture4/"><![CDATA[<h1 id="ä¸€å‡½æ•°è¿‘ä¼¼">ä¸€ã€å‡½æ•°è¿‘ä¼¼</h1> <h2 id="11-é—®é¢˜å¼•å…¥å¤§è§„æ¨¡çš„mdpé—®é¢˜å¦‚ä½•ä¼°è®¡ä»·å€¼å‡½æ•°">1.1 é—®é¢˜å¼•å…¥ï¼šå¤§è§„æ¨¡çš„MDPé—®é¢˜å¦‚ä½•ä¼°è®¡ä»·å€¼å‡½æ•°ï¼Ÿ</h2> <p>åœ¨é¢å¯¹å¤§è§„æ¨¡ MDP é—®é¢˜æ—¶ï¼Œè¦é¿å…ç”¨tableå»è¡¨ç¤ºç‰¹å¾ï¼ˆQ-tabelç­‰ï¼‰ï¼Œè€Œæ˜¯é‡‡ç”¨å¸¦å‚æ•°çš„<strong>å‡½æ•°è¿‘ä¼¼</strong>çš„æ–¹å¼å»è¿‘ä¼¼ä¼°è®¡Vã€Qã€Ï€</p> <ol> <li>è¡¨æ ¼å‹æ–¹æ³• <ul> <li>åœ¨è¡¨æ ¼å‹æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡æŸ¥è¡¨çš„æ–¹å¼å»è®¡ç®—ä»·å€¼å‡½æ•°çš„</li> <li>æ¯ä¸€ä¸ªçŠ¶æ€-åŠ¨ä½œå¯¹ \(&lt;s,a&gt;\)æœ‰ä¸€ä¸ªå…ƒç´ \(Q(s,a)\)</li> </ul> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter4/Untitled-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter4/Untitled-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter4/Untitled-1400.webp"/> <img src="/assets/img/RL_chapter4/Untitled.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>MDPçš„æŒ‘æˆ˜ï¼š <ul> <li>å¤ªå¤šçŠ¶æ€å’ŒåŠ¨ä½œéœ€è¦å­˜ä¸‹æ¥</li> <li>å•ç‹¬å­¦ä¹ æ¯ä¸€ä¸ªçŠ¶æ€çš„ä»·å€¼å¾ˆæ…¢</li> </ul> </li> </ol> <h2 id="12-é€šè¿‡å‡½æ•°è¿‘ä¼¼çš„æ–¹æ³•æ¥è§£å†³å¤§è§„æ¨¡rl">1.2 é€šè¿‡å‡½æ•°è¿‘ä¼¼çš„æ–¹æ³•æ¥è§£å†³å¤§è§„æ¨¡RL</h2> <ol> <li>å¦‚ä½•éšå¼å­¦ä¹ æˆ–å­˜å‚¨æ¯ä¸ªçŠ¶æ€ï¼Ÿéœ€è¦å­¦ä¹ çš„åŒ…æ‹¬ï¼š <ol> <li>çŠ¶æ€è½¬ç§»æ¨¡å‹ã€å¥–åŠ±æ¨¡å‹</li> <li>ä»·å€¼å‡½æ•°ï¼ŒQå‡½æ•°</li> <li>ç­–ç•¥</li> </ol> </li> <li> <p>è§£å†³æ–¹æ³•ï¼šé€šè¿‡<strong>ä»·å€¼å‡½æ•°è¿‘ä¼¼ï¼ˆVFAï¼‰</strong>æ¥é€¼è¿‘ã€‚é€šè¿‡å‚æ•°\(\mathbf{w}\)ä¼°è®¡ä»·å€¼å‡½æ•°ã€Qå‡½æ•°å’Œç­–ç•¥ã€‚</p> \[\begin{aligned}\hat{v}(s, \mathbf{w}) &amp; \approx v^\pi(s) \\\hat{q}(s, a, \mathbf{w}) &amp; \approx q^\pi(s, a) \\\hat{\pi}(a, s, \mathbf{w}) &amp; \approx \pi(a \mid s)\end{aligned}\] <ol> <li>å¯ä»¥ä»è§è¿‡çš„çŠ¶æ€æ³›åŒ–åˆ°æ²¡æœ‰è§åˆ°çš„çŠ¶æ€</li> <li>å¯ä»¥é€šè¿‡MCæˆ–è€…TDæ–¹æ³•è®­ç»ƒ\(\mathbf{w}\)</li> </ol> </li> <li>ä¸€äº›è¿‘ä¼¼æ–¹æ³•ï¼šå…¶ä¸­çº¿æ€§æ–¹æ³•å’Œç¥ç»ç½‘ç»œæ˜¯æˆ‘ä»¬å…³æ³¨çš„é‡ç‚¹ <ol> <li>ç‰¹å¾çº¿æ€§ç»„åˆ</li> <li>ç¥ç»ç½‘ç»œ</li> <li>å†³ç­–æ ‘</li> <li>æœ€è¿‘é‚»</li> </ol> </li> </ol> <h1 id="äºŒé¢„æµ‹ä¸­çš„ä»·å€¼å‡½æ•°è¿‘ä¼¼">äºŒã€é¢„æµ‹ä¸­çš„ä»·å€¼å‡½æ•°è¿‘ä¼¼</h1> <h2 id="21-æœ‰oracleæ¨¡å‹é¢„æµ‹vfa">2.1 æœ‰Oracle/æ¨¡å‹é¢„æµ‹VFA</h2> <h3 id="211-åŸºæœ¬å†…å®¹">2.1.1 åŸºæœ¬å†…å®¹</h3> <ol> <li>Oracleï¼šæˆ‘ä»¬çŸ¥é“gtçš„value function \(v^\pi(s)\)ï¼Œå¯¹æ‰€æœ‰çŠ¶æ€\(s\)éƒ½æ˜¯å·²çŸ¥çš„ã€‚</li> <li>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦ä¹ å¯¹\(v^\pi(s)\)çš„è¿‘ä¼¼ã€‚</li> <li> <p>å› æ­¤æˆ‘ä»¬MSEæ¥å®šä¹‰lossï¼š</p> \[J(\mathbf{w})=\mathbb{E}_\pi\left[\left(v^\pi(s)-\hat{v}(s, \mathbf{w})\right)^2\right]\] </li> <li> <p>æ¢¯åº¦ä¸‹é™ï¼š</p> \[\begin{aligned}\Delta \mathbf{w} &amp; =-\frac{1}{2} \alpha \nabla_{\mathbf{w}} J(\mathbf{w}) \\\mathbf{w}_{t+1} &amp; =\mathbf{w}_t+\Delta \mathbf{w}\end{aligned}\] </li> </ol> <h3 id="212-çº¿æ€§æ–¹æ³•">2.1.2 çº¿æ€§æ–¹æ³•</h3> <ol> <li> <p>å¦‚ä½•é€šè¿‡ç‰¹å¾å‘é‡è¡¨ç¤ºçŠ¶æ€ï¼Ÿ</p> \[\mathbf{x}(s)=\left(x_1(s), \ldots, x_n(s)\right)^T\] </li> <li> <p>ä»·å€¼å‡½æ•°â€”â€”ç‰¹å¾çº¿æ€§ç»„åˆï¼š</p> </li> </ol> \[\hat{v}(s, \mathbf{w})=\mathbf{x}(s)^T \mathbf{w}=\sum_{j=1}^n x_j(s) w_j\] <ol> <li>ç›®æ ‡å‡½æ•°ï¼š</li> </ol> \[J(\mathbf{w})=\mathbb{E}_\pi\left[\left(v^\pi(s)-\mathbf{x}(s)^T \mathbf{w}\right)^2\right]\] \[\Delta \mathbf{w}=\alpha\left(v^\pi(s)-\hat{v}(s, \mathbf{w})\right) \mathbf{x}(s)\] <p>ğŸ˜ <strong><em>Update = StepSize Ã— PredictionError Ã— FeatureValue</em></strong></p> <h3 id="213-é€šè¿‡æŸ¥ç‰¹å¾è¡¨çš„çº¿æ€§æ–¹æ³•">2.1.3 é€šè¿‡æŸ¥ç‰¹å¾è¡¨çš„çº¿æ€§æ–¹æ³•</h3> <ol> <li>æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§VFA</li> <li>æŸ¥è¡¨çš„æ–¹å¼æ˜¯é€šè¿‡1-hotå‘é‡å®ç°çš„ï¼Œç‰¹å¾éƒ½æ˜¯0æˆ–1ï¼š</li> </ol> \[\mathbf{x}^{\text {table }}(s)=\left(\mathbf{1}\left(s=s_1\right), \ldots, \mathbf{1}\left(s=s_n\right)\right)^T\] <ol> <li>äº‹å®ä¸Šä»·å€¼å‡½æ•°çš„æ¯ä¸€é¡¹æ°å¥½å°±æ˜¯è®­ç»ƒå‚æ•°ï¼š</li> </ol> \[\hat{v}(s, \mathbf{w})=\left(\mathbf{1}\left(s=s_1\right), \ldots, \mathbf{1}\left(s=s_n\right)\right)\left(w_1, \ldots, w_n\right)^T\\\hat{v}\left(s_k, \mathbf{w}\right)=w_k\] <h2 id="22-æ— æ¨¡å‹é¢„æµ‹vfa">2.2 æ— æ¨¡å‹é¢„æµ‹VFA</h2> <p>å®è·µä¸­ï¼Œæ²¡æœ‰åŠæ³•çŸ¥é“æ‰€æœ‰çŠ¶æ€çš„gtä»·å€¼å‡½æ•°ï¼Œæ²¡æœ‰oracleã€‚</p> <p>å›æƒ³ä¸‹åœ¨æ— æ¨¡å‹çš„é¢„æµ‹ä¸­åšçš„äº‹ï¼š</p> <ol> <li>ç›®æ ‡æ˜¯å»é€šè¿‡ç»™å®šç­–ç•¥ \(\pi\) ä¼°è®¡ä»·å€¼å‡½æ•° \(v^\pi\)</li> <li>ç»´æŠ¤ä¸€ä¸ª \(v^\pi\) æˆ–è€… \(q^\pi\) çš„è¡¨æ ¼</li> <li>æ¯å›åˆè¯„ä¼°æ›´æ–°ï¼ˆMCï¼‰ æˆ– æ¯ä¸€æ­¥è¯„ä¼°æ›´æ–°ï¼ˆTDï¼‰</li> </ol> <h3 id="221-å¢é‡å¼å‡½æ•°è¿‘ä¼¼é¢„æµ‹ç®—æ³•incremental-vfa-prediction-algorithms">2.2.1 <strong>å¢é‡å¼å‡½æ•°è¿‘ä¼¼é¢„æµ‹ç®—æ³•</strong>ï¼ˆIncremental VFA Prediction Algorithmsï¼‰</h3> <ol> <li> <p>åœ¨æœ‰gtä»·å€¼å‡½æ•°çš„æƒ…å½¢ä¸‹ï¼Œæˆ‘ä»¬æœ‰ï¼š</p> \[\Delta \mathbf{w}=\alpha\left(\textcolor{red}{v^\pi(s)}-\hat{v}(s, \mathbf{w})\right) \nabla_{\mathbf{w}} \hat{v}\left(s_t, \mathbf{w}\right)\] </li> <li> <p>åœ¨çœŸå®åœºæ™¯ä¸‹æ²¡æœ‰\(\textcolor{red}{v^\pi(s)}\)ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ±‚æ›¿ä»£æ–¹æ¡ˆï¼š</p> <ul> <li> <p>åœ¨MCä¸­ï¼Œæˆ‘ä»¬ç”¨å®é™…returnä»£æ›¿</p> \[\Delta \mathbf{w}=\alpha\left(\textcolor{red}{G_t}-\hat{v}\left(s_t, \mathbf{w}\right)\right) \nabla_{\mathbf{w}} \hat{v}\left(s_t, \mathbf{w}\right)\] </li> <li> <p>åœ¨TD(0)ä¸­ï¼Œæˆ‘ä»¬ç”¨\(\delta_t\)ä»£æ›¿</p> \[\Delta \mathbf{w}=\alpha\left(\textcolor{red}{R_{t+1}+\gamma \hat{v}\left(s_{t+1}, \mathbf{w}\right)}-\hat{v}\left(s_t, \mathbf{w}\right)\right) \nabla_{\mathbf{w}} \hat{v}\left(s_t, \mathbf{w}\right)\] </li> </ul> </li> </ol> <h3 id="222-åŸºäºvfaçš„mcé¢„æµ‹">2.2.2 åŸºäºVFAçš„MCé¢„æµ‹</h3> <ol> <li>å¥–åŠ± \(G_t\) æ˜¯unbiasedçš„ï¼Œä½†æ˜¯å¯¹äºçœŸæ­£çš„value functionæ˜¯å¸¦æœ‰noiseçš„ï¼Œåªæœ‰é‡‡æ ·å¤§é‡çš„\(G_t\) æ‰èƒ½æ¢å¤å‡º\(v^\pi(s_t)\)ï¼Œå› ä¸º\(\mathbb{E}[G_t]=v^\pi(s_t)\)ã€‚</li> <li> <p>å› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠ \(G_t\) çœ‹æˆlabelï¼Œ\(S_t\) çœ‹æˆinputï¼Œåšä¸€ä¸ªç›‘ç£å­¦ä¹ ä»»åŠ¡ã€‚</p> \[&lt;S_1, G_1&gt;,&lt;S_2, G_2&gt;, \ldots,&lt;s_t, G_T&gt;\] </li> <li> <p>MCç­–ç•¥è¯„ä¼°æ›´æ–°å¯ä»¥å†™ä¸ºï¼š</p> \[\begin{aligned} \Delta \mathbf{w} &amp; =\alpha\left(G_t-\hat{v}\left(s_t, \mathbf{w}\right)\right) \nabla_{\mathbf{w}} \hat{v}\left(s_t, \mathbf{w}\right) \\ &amp; =\alpha\left(G_t-\hat{v}\left(s_t, \mathbf{w}\right)\right) \mathbf{x}\left(s_t\right) \end{aligned}\] </li> <li>MCé¢„æµ‹åœ¨çº¿æ€§/éçº¿æ€§VFAä¸­éƒ½å¯ä»¥æ”¶æ•›åˆ°globelæœ€ä¼˜ã€‚</li> </ol> <h3 id="223-åŸºäºvfaçš„tdé¢„æµ‹">2.2.3 åŸºäºVFAçš„TDé¢„æµ‹</h3> <ol> <li>TDç›®æ ‡\(R_{t+1}+\gamma \hat{v}\left(s_{t+1}, \mathbf{w}\right)\)æ˜¯biasedçš„ï¼Œå› ä¸º\(\mathbb{E}[R_{t+1}+\gamma \hat{v}\left(s_{t+1}, \mathbf{w}\right)]\neq v^\pi (s_t)\)</li> <li> <p>æˆ‘ä»¬æœ‰ç±»ä¼¼çš„ç›‘ç£å­¦ä¹ è®­ç»ƒpairå¦‚ä¸‹ï¼š</p> \[&lt;S_1, R_2+\gamma \hat{v}\left(s_2, \mathbf{w}\right)&gt;,&lt;S_2, R_3+\gamma \hat{v}\left(s_3, \mathbf{w}\right)&gt;, \ldots,&lt;S_{T-1}, R_T&gt;\] </li> <li> <p>TD(0)ä¸­çš„æ›´æ–°å¯ä»¥å†™ä¸ºï¼š</p> \[\begin{aligned}\Delta \mathbf{w} &amp; =\alpha\left(R+\gamma \hat{v}\left(s^{\prime}, \mathbf{w}\right)-\hat{v}(s, \mathbf{w})\right) \nabla_{\mathbf{w}} \hat{v}(s, \mathbf{w}) \\&amp; =\alpha\left(R+\gamma \hat{v}\left(s^{\prime}, \mathbf{w}\right)-\hat{v}(s, \mathbf{w})\right) \mathbf{x}(s)\end{aligned}\] <p>è¿™ä¸ªä¹Ÿå«åšsemi-gradientï¼Œå› ä¸ºæˆ‘ä»¬å¿½ç•¥äº†æ”¹å˜æƒé‡å‘é‡\(\mathbf{w}\)å¯¹äºtargetçš„æ•ˆåº”ã€‚</p> </li> <li>çº¿æ€§TD(0)æ‰å¯ä»¥æ”¶æ•›åˆ°globelæœ€ä¼˜ã€‚</li> </ol> <h1 id="ä¸‰-æ§åˆ¶ä¸­çš„ä»·å€¼å‡½æ•°è¿‘ä¼¼">ä¸‰ã€ æ§åˆ¶ä¸­çš„ä»·å€¼å‡½æ•°è¿‘ä¼¼</h1> <p>å¹¿ä¹‰ç­–ç•¥è¿­ä»£ï¼š</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter4/Untitled%201-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter4/Untitled%201-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter4/Untitled%201-1400.webp"/> <img src="/assets/img/RL_chapter4/Untitled%201.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ul> <li>ç­–ç•¥è¯„ä¼°ï¼šè¿‘ä¼¼ç­–ç•¥è¯„ä¼°ï¼Œ\(\hat{q}(., ., \mathbf{w}) \approx q^\pi\)</li> <li>ç­–ç•¥æ”¹è¿›ï¼š\(\varepsilon\)-è´ªå¿ƒç­–ç•¥æ”¹è¿›</li> </ul> <h2 id="31-æœ‰oracleæ¨¡å‹æ§åˆ¶vfa">3.1 æœ‰Oracle/æ¨¡å‹æ§åˆ¶VFA</h2> <ol> <li> <p>è¿‘ä¼¼åŠ¨ä½œä»·å€¼å‡½æ•°ï¼š</p> \[\hat{q}(s, a, \mathbf{w}) \approx q^\pi(s, a)\] </li> <li> <p>loss function:</p> \[J(\mathbf{w})=\mathbb{E}_\pi\left[\left(q^\pi(s, a)-\hat{q}(s, a, \mathbf{w})\right)^2\right]\] </li> <li> <p>æ¢¯åº¦æ±‚è§£ï¼š</p> \[\Delta \mathbf{w}=\alpha\left(q^\pi(s, a)-\hat{q}(s, a, \mathbf{w})\right) \nabla_{\mathbf{w}} \hat{q}(s, a, \mathbf{w})\] </li> </ol> <h2 id="32-æ— æ¨¡å‹æ§åˆ¶ä¸­çš„vfa">3.2 æ— æ¨¡å‹æ§åˆ¶ä¸­çš„VFA</h2> <h3 id="321-å¢é‡æ§åˆ¶ç®—æ³•incremental-control-algorithm">3.2.1 å¢é‡æ§åˆ¶ç®—æ³•ï¼ˆIncremental Control Algorithmï¼‰</h3> <p>ç±»ä¼¼çš„ï¼ŒçœŸå®æƒ…å†µä¸­æˆ‘ä»¬æ²¡æœ‰oracleäº†ã€‚</p> <ol> <li> <p>MCï¼š</p> \[\Delta \mathbf{w}=\alpha\left(\textcolor{red}{G_t}-\hat{q}\left(s_t, a_t, \mathbf{w}\right)\right) \nabla_{\mathbf{w}} \hat{q}\left(s_t, a_t, \mathbf{w}\right)\] </li> <li> <p>Sarsaï¼š</p> \[\Delta \mathbf{w}=\alpha\left(\textcolor{red}{R_{t+1}+\gamma \hat{q}\left(s_{t+1}, a_{t+1}, \mathbf{w}\right)}-\hat{q}\left(s_t, a_t, \mathbf{w}\right)\right) \nabla_{\mathbf{w}} \hat{q}\left(s_t, a_t, \mathbf{w}\right)\] </li> <li> <p>Q-learningï¼š</p> \[\Delta \mathbf{w}=\alpha\left(\textcolor{red}{R_{t+1}+\gamma \max _a \hat{q}\left(s_{t+1}, a, \mathbf{w}\right)}-\hat{q}\left(s_t, a_t, \mathbf{w}\right)\right) \nabla_{\mathbf{w}} \hat{q}\left(s_t, a_t, \mathbf{w}\right)\] </li> <li> <p>Semi-gradient Sarsaç®—æ³•æµç¨‹ï¼š</p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter4/Untitled%202-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter4/Untitled%202-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter4/Untitled%202-1400.webp"/> <img src="/assets/img/RL_chapter4/Untitled%202.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="322-æ”¶æ•›æ€§åˆ†æsarsaq-learning">3.2.2 æ”¶æ•›æ€§åˆ†æï¼ˆSarsa/Q-learningï¼‰</h3> <ol> <li>TDä¸­çš„VFAä¸éµä»ä»»ä½•ä¸€ä¸ªLoss function</li> <li>è¿™ä¸ªæ›´æ–°åŒ…å«ä¸¤ä¸ªè¿‘ä¼¼ï¼Œéƒ½ä¼šå¼•å…¥å™ªå£°ï¼š <ol> <li>è´å°”æ›¼å¤‡ä»½å…¬å¼ä¸­çš„è¿‘ä¼¼</li> <li>è¿‘ä¼¼ä»·å€¼å‡½æ•°çš„è¿‘ä¼¼</li> </ol> </li> <li>ä¸€ä¸ªæŒ‘æˆ˜ï¼šè¡Œä¸ºç­–ç•¥å’Œç›®æ ‡ç­–ç•¥ä¸åŒï¼Œå› æ­¤ä»·å€¼å‡½æ•°çš„VFAå¯èƒ½æ²¡æ³•æ”¶æ•›ã€‚</li> <li>æ­»äº¡ä¸‰è§’ï¼š <ol> <li>å‡½æ•°è¿‘ä¼¼ï¼šè¿‘ä¼¼ä¼šå¼•å…¥è¯¯å·®</li> <li>bootstrapï¼šTDä¾èµ–äºä¹‹å‰çš„ä¼°è®¡ä¼šå¼•å…¥biasï¼ŒMCæ–¹æ³•é¿å…äº†è¿™ä¸ªé—®é¢˜</li> <li>off-policyè®­ç»ƒï¼šé‡‡æ ·åˆ†å¸ƒå’Œå®é™…åˆ†å¸ƒå·®å¼‚æ¯”è¾ƒå¤§</li> </ol> </li> <li>æ”¶æ•›æ€§æ€»ç»“ï¼š</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter4/Untitled%203-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter4/Untitled%203-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter4/Untitled%203-1400.webp"/> <img src="/assets/img/RL_chapter4/Untitled%203.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="323-batchå¼ºåŒ–å­¦ä¹ ">3.2.3 batchå¼ºåŒ–å­¦ä¹ </h3> <ol> <li>æƒ³æ³•ï¼š <ol> <li>å¢é‡æ¢¯åº¦ä¸‹é™æ›´æ–°æ˜¯ç®€å•çš„ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æœ‰æ•ˆç‡çš„é‡‡æ ·æ–¹å¼ï¼Œæ¯èµ°ä¸€æ­¥ä¼˜åŒ–ä¸€æ¬¡ã€‚</li> <li>åŸºäºbatchçš„æ–¹æ³•ä¼šæ‰¾ä¸€æ‰¹ä¸­çš„æ•°æ®ã€‚</li> </ol> </li> <li> <p>å»ºæ¨¡ï¼šå‡è®¾ç»éªŒåŒ…å«äº†\(&lt;state, value&gt;\)å¯¹ã€‚</p> \[D=\{&lt;s_i,v_i&gt;\}_{t=1}^T\] <p>è¿­ä»£æ—¶é‡å¤ä¸¤æ­¥æ“ä½œï¼š</p> <ol> <li>éšæœºé‡‡æ ·ä¸€å¯¹ï¼Œ\(&lt;s, v^\pi&gt;\sim \mathcal{D}\)</li> <li>ç”¨æ¢¯åº¦ä¸‹é™æ³•è¿›è¡Œä¼˜åŒ–ï¼š\(\Delta \mathbf{w}=\alpha\left(v^\pi-\hat{v}(s, \mathbf{w})\right) \nabla_{\mathbf{w}} \hat{v}(s, \mathbf{w})\)</li> </ol> <p>ç­‰ä»·äºMSE loss</p> \[\mathbf{w}^{L S}=\underset{\mathbf{w}}{\arg \min } \sum_{t=1}^T\left(v_t^\pi-\hat{v}\left(s_t, \mathbf{w}\right)\right)^2\] </li> </ol> <h1 id="ä¸‰æ·±åº¦qç½‘ç»œ">ä¸‰ã€æ·±åº¦Qç½‘ç»œ</h1> <ol> <li>çº¿æ€§VFA vs éçº¿æ€§VFA <ol> <li>çº¿æ€§VFAé€šå¸¸åœ¨ç»™å®šæ­£ç¡®çš„ç‰¹å¾æ—¶æ•ˆæœå¾ˆå¥½ï¼Œä½†æ˜¯éœ€è¦äººå·¥è®¾è®¡ç‰¹å¾é›†ã€‚</li> <li>éçº¿æ€§VFAä¸éœ€è¦äººå·¥æ¶‰åŠç‰¹å¾ï¼Œç›´æ¥ç”¨DNN</li> </ol> </li> <li>æ·±åº¦å¼ºåŒ–å­¦ä¹  <ol> <li>DNNéœ€è¦è¡¨ç¤ºï¼šä»·å€¼å‡½æ•°ã€ç­–ç•¥å‡½æ•°ä»¥åŠç¯å¢ƒæ¨¡å‹</li> <li>ä¼˜åŒ–ï¼šSGD</li> </ol> </li> </ol> <h2 id="31-deep-q-learning-dqn">3.1 Deep Q-Learning (DQN)</h2> <ol> <li>DQNé€šè¿‡ç¥ç»ç½‘ç»œè¡¨ç¤ºQå‡½æ•°</li> <li>DQNç©é›…è¾¾åˆ©æ¸¸æˆï¼š <ol> <li>ç«¯åˆ°ç«¯å­¦ä¹ \(Q(s,a)\)ï¼Œç›´æ¥æŠŠåƒç´ å¸§ä½œä¸ºè¾“å…¥</li> <li>è¾“å…¥æœ€è¿‘4å¸§çŠ¶æ€\(s\)çš„åƒç´ </li> <li>è¾“å‡ºæ˜¯\(Q(s,a)\)ä»£è¡¨18ä¸ªæŒ‰é’®ä½ç½®</li> <li>å¥–åŠ±æ˜¯è¿™ä¸€æ­¥çš„åˆ†æ•°</li> </ol> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter4/Untitled%204-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter4/Untitled%204-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter4/Untitled%204-1400.webp"/> <img src="/assets/img/RL_chapter4/Untitled%204.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>ä¸¤ä¸ªé‡è¦çš„é—®é¢˜ï¼š <ol> <li>æ ·æœ¬ä¹‹é—´çš„å…³ç³»æ€ä¹ˆå¤„ç†ï¼Ÿåƒç´ çº§åˆ«çš„å…³è”å¾ˆé«˜ã€‚è§£å†³ï¼šexperience replay</li> <li>targetæ˜¯å¸¦æœ‰noiseçš„ã€‚è§£å†³ï¼šå›ºå®šQ targets</li> </ol> </li> </ol> <h2 id="32-dqnexperience-replay">3.2 DQNï¼šexperience replay</h2> <ol> <li>ä¸ºäº†å‡å°‘æ ·æœ¬ä¹‹é—´çš„å…³è”æ€§ï¼Œæˆ‘ä»¬æŠŠ \((s_t,a_t,r_t,s_{t+1})\) å­˜è¿›ä¸€ä¸ªå›æ”¾çŠ¶æ€è½¬ç§»memory \(D\)ï¼Œè¿™æ˜¯éšæœºæ‰“ä¹±çš„ã€‚å¸Œæœ›é‡‡æ ·å‡ºæ¥çš„ç»éªŒå’Œç›®å‰çŠ¶æ€æ²¡æœ‰å¾ˆå¼ºçš„ç›¸å…³æ€§ã€‚</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter4/Untitled%205-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter4/Untitled%205-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter4/Untitled%205-1400.webp"/> <img src="/assets/img/RL_chapter4/Untitled%205.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>ç»éªŒå›æ”¾å…·ä½“æ­¥éª¤ï¼š <ol> <li>åœ¨æ•°æ®é›†ä¸­é‡‡æ ·ç»éªŒï¼š\(\left(s, a, r, s^{\prime}\right) \sim \mathcal{D}\)</li> <li>è®¡ç®—é‡‡æ ·å‡ºçš„ä»·å€¼ç›®æ ‡ï¼š\(r+\gamma \max _{a^{\prime}} \hat{Q}\left(s^{\prime}, a^{\prime}, \mathbf{w}\right)\)</li> <li> <p>é€šè¿‡SGDç®—æ³•æ›´æ–°ç½‘ç»œæƒé‡:</p> \[\Delta \mathbf{w}=\alpha\left(r+\gamma \max _{a^{\prime}} \hat{Q}\left(s^{\prime}, a^{\prime}, \mathbf{w}\right)-Q(s, a, \mathbf{w})\right) \nabla_{\mathbf{w}} \hat{Q}(s, a, \mathbf{w})\] </li> </ol> </li> <li>å›ºå®šQç›®æ ‡ <ol> <li>ä¸ºäº†æé«˜è®­ç»ƒçš„ç¨³å®šæ€§ï¼Œå¸Œæœ›åœ¨å¤šæ¬¡æ›´æ–°æ—¶ï¼Œè®¡ç®—targetæ—¶å›ºå®šå…¶æƒé‡ã€‚</li> <li>ç”¨ä¸€ç»„æ–°çš„å‚æ•°\(\mathbf{w^-}\)ä½œä¸ºä½¿ç”¨çš„æƒé‡ï¼Œ\(\mathbf{w}\)æ˜¯æˆ‘ä»¬éœ€è¦æ›´æ–°çš„æƒé‡ã€‚</li> <li>å›ºå®šç›®æ ‡çš„ç»éªŒå›æ”¾å…·ä½“æ­¥éª¤ï¼š <ol> <li>åœ¨æ•°æ®é›†ä¸­é‡‡æ ·ç»éªŒï¼š\(\left(s, a, r, s^{\prime}\right) \sim \mathcal{D}\)</li> <li>è®¡ç®—é‡‡æ ·å‡ºçš„ä»·å€¼ç›®æ ‡ï¼š\(r+\gamma \max _{a^{\prime}} \hat{Q}\left(s^{\prime}, a^{\prime}, \textcolor{red}{\mathbf{w}^-} \right)\)</li> <li> <p>é€šè¿‡SGDç®—æ³•æ›´æ–°ç½‘ç»œæƒé‡:</p> \[\Delta \mathbf{w}=\alpha\left(r+\gamma \max _{a^{\prime}} \hat{Q}\left(s^{\prime}, a^{\prime}, \textcolor{red}{\mathbf{w}^{-}}\right)-Q(s, a, \mathbf{w})\right) \nabla_{\mathbf{w}} \hat{Q}(s, a, \mathbf{w})\] </li> </ol> </li> </ol> <p>ğŸ˜ ä¸ºä»€ä¹ˆéœ€è¦å›ºå®šç›®æ ‡ï¼Ÿ ä¸€å¼€å§‹æ›´æ–°çš„æ—¶å€™ï¼Œå¯¹äºQçš„ä¼°è®¡å’ŒQçš„ç›®æ ‡æ¯ä¸€æ­¥éƒ½åœ¨å˜åŒ–ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›Qçš„ä¼°è®¡å¯ä»¥é€¼è¿‘Qçš„ç›®æ ‡ï¼Œé‚£ä¹ˆä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼å°±æ˜¯å›ºå®šQçš„ç›®æ ‡ï¼Œè®©å¯¹Qçš„ä¼°è®¡æ›´ç²¾å‡†ã€‚</p> </li> </ol>]]></content><author><name></name></author><category term="Reinforcement-Learning"/><category term="intro"/><summary type="html"><![CDATA[VFA and Q-learning]]></summary></entry><entry><title type="html">ç¬¬äº”ç«  Policy Optimization Foundation (ç­–ç•¥ä¼˜åŒ–åŸºç¡€ç¯‡)</title><link href="https://gszfwsb.github.io/blog/2023/RL-lecture5/" rel="alternate" type="text/html" title="ç¬¬äº”ç«  Policy Optimization Foundation (ç­–ç•¥ä¼˜åŒ–åŸºç¡€ç¯‡)"/><published>2023-10-30T00:00:00+00:00</published><updated>2023-10-30T00:00:00+00:00</updated><id>https://gszfwsb.github.io/blog/2023/RL-lecture5</id><content type="html" xml:base="https://gszfwsb.github.io/blog/2023/RL-lecture5/"><![CDATA[<h1 id="ä¸€åŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ ">ä¸€ã€åŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ </h1> <ol> <li>åŸºäºä»·å€¼çš„RLå’ŒåŸºäºç­–ç•¥çš„RLæœ‰ä½•åŒºåˆ«ï¼Ÿ <ol> <li> <p><strong>å†³å®šæ€§ç­–ç•¥</strong>æ˜¯ç›´æ¥é€šè¿‡è´ªå¿ƒç®—æ³•ï¼Œç”±ä»·å€¼å‡½æ•°ç”Ÿæˆæˆ‘ä»¬åº”è¯¥é‡‡å–çš„åŠ¨ä½œï¼š</p> \[a_t=\arg\max_a Q\left(a, s_t\right)\] </li> <li> <p><strong>éšæœºæ€§ç­–ç•¥</strong>ï¼šæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å»ºæ¨¡ç­–ç•¥å‡½æ•°ä¸ºä¸€ä¸ªå‚æ•°åŒ–æ¦‚ç‡åˆ†å¸ƒ\(\pi_{\theta}(a\mid s)\)ï¼Œå‚æ•°ä¸º\(\theta\)</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> </figure></div></div> </li> </ol> </li> </ol> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> <p>&lt;/figure&gt;</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        &lt;/div&gt;
    &lt;/div&gt;

    
3. å¯¹æ¯”ï¼š
    
    | åŸºäºä»·å€¼çš„RL | åŸºäºç­–ç•¥çš„RL | æ¼”å‘˜-è¯„è®ºå‘˜ |
    | --- | --- | --- |
    | å­¦ä¹ ä»·å€¼å‡½æ•° | æ²¡æœ‰ä»·å€¼å‡½æ•° | åŒæ—¶å­¦ç­–ç•¥å’Œä»·å€¼å‡½æ•° |
    | é€šè¿‡ä»·å€¼å‡½æ•°å¾—åˆ°éšå¼çš„ç­–ç•¥ | ç›´æ¥å­¦ä¹ ç­–ç•¥ |  |
</code></pre></div></div> <ol> <li>policy-based RLç‰¹ç‚¹: æœ‰ç‚¹ç±»ä¼¼ç›‘ç£å­¦ä¹  <ol> <li>ä¼˜åŠ¿ï¼š <ol> <li>æ›´å¥½çš„æ”¶æ•›æ€§ï¼šå¯ä»¥ä¿è¯æ”¶æ•›ï¼Œè‡³å°‘æ˜¯local optimum</li> <li>ç­–ç•¥æ¢¯åº¦åœ¨é«˜ç»´åŠ¨ä½œç©ºé—´æ˜¯æ›´æœ‰æ•ˆçš„</li> <li>ç­–ç•¥æ¢¯åº¦å¯ä»¥å­¦ä¹ éšæœºç­–ç•¥ï¼Œä½†æ˜¯ä»·å€¼å‡½æ•°ä¸èƒ½ã€‚</li> </ol> </li> <li>åŠ£åŠ¿ï¼š <ol> <li>ç»å¸¸ä¼šæ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜è§£</li> <li>ç­–ç•¥è¯„ä¼°ä¼šæœ‰å¾ˆå¤§çš„æ–¹å·®</li> </ol> </li> </ol> </li> </ol> <h1 id="äºŒmcç­–ç•¥æ¢¯åº¦">äºŒã€MCç­–ç•¥æ¢¯åº¦</h1> <h2 id="21-ç­–ç•¥ä¼˜åŒ–">2.1 ç­–ç•¥ä¼˜åŒ–</h2> <ol> <li>ç­–ç•¥ä¼˜åŒ–ç›®æ ‡ï¼šç»™å®šä¸€ä¸ªå¸¦å‚ \(\theta\) ç­–ç•¥è¿‘ä¼¼å™¨ \(\pi_{\theta}(s,a)\)ï¼Œæ‰¾åˆ°æœ€ä¼˜\(\theta\)</li> <li>å¦‚ä½•è¡¡é‡ç­–ç•¥ \(\pi_{\theta}(s,a)\) çš„è´¨é‡ï¼Ÿ <ol> <li> <p>åœ¨ç¦»æ•£ï¼ˆæœ‰è½®æ•°ï¼‰ç¯å¢ƒä¸­æˆ‘ä»¬ç”¨<strong>å¼€å§‹ä»·å€¼</strong></p> \[J_1(\theta)=V^{\pi_\theta}\left(s_1\right)=\mathbb{E}_{\pi_\theta}\left[v_1\right]\] </li> <li> <p>åœ¨è¿ç»­çš„ç¯å¢ƒï¼ˆæ²¡æœ‰ç»ˆæ­¢ï¼‰æˆ‘ä»¬å¯ä»¥ç”¨<strong>ä»·å€¼å‡å€¼</strong>æˆ–è€…<strong>å›æŠ¥å‡å€¼</strong></p> <ul> <li> <p>ä»·å€¼å‡å€¼ï¼š</p> \[J_{a v V}(\theta)=\sum_s d^{\pi_\theta}(s) V^{\pi_\theta}(s)\] </li> <li> <p>å›æŠ¥å‡å€¼ï¼š</p> \[J_{a v R}(\theta)=\sum_s d^{\pi_\theta}(s) \sum_a \pi_\theta(s, a) R(s, a)\] <p>å…¶ä¸­\(\pi_\theta\)çš„é©¬å°”å¯å¤«åˆ†å¸ƒç¨³æ€åˆ†å¸ƒæ˜¯\(d^{\pi_\theta}\)ã€‚</p> </li> </ul> </li> </ol> </li> <li> <p>ç­–ç•¥ä»·å€¼ï¼šå’Œæˆ‘ä»¬åœ¨åŸºäºä»·å€¼çš„RLä¸­å®šä¹‰ä¸€æ ·ã€‚</p> \[\begin{aligned}J(\theta) &amp; =\mathbb{E}_{\tau \sim \pi_\theta}\left[\sum_t R\left(s_t^\tau, a_t^\tau\right)\right] \\&amp; \approx \frac{1}{m} \sum_m \sum_t R\left(s_t^m, a_t^m\right)\end{aligned}\] <ul> <li>\(\tau\)æ˜¯æˆ‘ä»¬ä»ç­–ç•¥å‡½æ•°\(\pi_\theta\)ä¸­çš„é‡‡æ ·è½¨è¿¹</li> <li>æˆ‘ä»¬å¿½ç•¥æŠ˜æ‰£</li> </ul> </li> <li> <p>åŸºäºç­–ç•¥çš„RLçš„ç›®æ ‡ï¼šæ‰¾åˆ°å‚æ•°ä½¿å¾—\(J(\theta)\)æœ€å¤§åŒ–</p> \[\theta^*=\underset{\theta}{\arg \max } \mathbb{E}_{\tau \sim \pi_\theta}\left[\sum_t R\left(s_t^\tau, a_t^\tau\right)\right]\] <ul> <li>å¦‚æœ\(J(\theta)\)å¯å¾®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŸºäºæ¢¯åº¦çš„æ–¹æ³•è§£</li> </ul> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%201-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%201-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%201-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%201.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ul> <li>å¦‚æœ\(J(\theta)\)ä¸å¯å¾®æˆ–è€…éš¾ä»¥æ±‚å¯¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›ä¸ç”¨æ¢¯åº¦çš„é»‘ç›’ä¼˜åŒ–æ–¹æ³•ï¼š äº¤å‰ç†µæ³• (CEM)</li> </ul> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%202-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%202-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%202-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%202.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>æœ‰é™å·®åˆ†</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%203-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%203-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%203-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%203.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>è®¡ç®—ç­–ç•¥æ¢¯åº¦ï¼š <ol> <li>å‡è®¾ç­–ç•¥é0æ—¶å¤„å¤„å¯å¾®ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¢¯åº¦\(\nabla_\theta \pi_\theta(s, a)\)</li> <li> <p>ä¸€ä¸ªè®¡ç®—trick (likelihood ratios)ï¼šä¼˜åŒ–ç›®æ ‡å°±æ˜¯\(\nabla_\theta \log \pi_\theta(s, a)\)</p> \[\textcolor{blue}{\begin{aligned}\nabla_\theta \pi_\theta(s, a) &amp; =\pi_\theta(s, a) \frac{\nabla_\theta \pi_\theta(s, a)}{\pi_\theta(s, a)} \\&amp; =\pi_\theta(s, a) \nabla_\theta \log \pi_\theta(s, a)\end{aligned}}\] </li> </ol> <ul> <li> <p>ä¾‹1ï¼šé«˜æ–¯ç­–ç•¥</p> <p>åœ¨è¿ç»­åŠ¨ä½œç©ºé—´ï¼Œä¸€ä¸ªé«˜æ–¯ç­–ç•¥çš„å®šä¹‰ååˆ†è‡ªç„¶ã€‚å…¶å‡å€¼æ˜¯çŠ¶æ€ç‰¹å¾çš„çº¿æ€§ç»„åˆï¼š\(\mu(s)=\phi(s)^T \theta\)ã€‚æ–¹å·®å¯ä»¥æ˜¯å‚æ•°åŒ–çš„ä¹Ÿå¯ä»¥æ˜¯å¸¸æ•°ã€‚ç­–ç•¥æ˜¯è¿ç»­ã€é«˜æ–¯çš„ï¼Œå³\(a \sim \mathcal{N}\left(\mu(s), \sigma^2\right)\)</p> <p>é‚£ä¹ˆåˆ†æ•°ä¸ºï¼š</p> \[\nabla_\theta \log \pi_\theta(s, a)=\frac{(a-\mu(s)) \phi(s)}{\sigma^2}\] </li> <li> <p>ä¾‹2ï¼šsoftmaxç­–ç•¥</p> <p>ç®€å•ç­–ç•¥æ¨¡å‹ï¼Œç”¨ç‰¹å¾çº¿æ€§ç»„åˆä½œä¸ºåŠ¨ä½œæƒé‡ã€‚å…¶åŠ¨ä½œæ¦‚ç‡å’Œæƒé‡å¤§å°æŒ‡æ•°æˆæ­£æ¯”ï¼Œå³</p> \[\pi_\theta(s, a)=\frac{\exp ^{\phi(s, a)^T \theta}}{\sum_{a^{\prime}} \exp ^{\phi\left(s, a^{\prime}\right)^T \theta}}\] <p>é‚£ä¹ˆåˆ†æ•°ä¸ºï¼š</p> \[\nabla_\theta \log \pi_\theta(s, a)=\phi(s, a)-\mathbb{E}_{\pi_\theta}[\phi(s, .)]\] </li> </ul> </li> </ol> <h2 id="22-å•æ­¥mdpçš„ç­–ç•¥æ¢¯åº¦">2.2 å•æ­¥MDPçš„ç­–ç•¥æ¢¯åº¦</h2> <p>è€ƒè™‘å•æ­¥MDPçš„ç®€å•æƒ…å†µï¼š ä»çŠ¶æ€\(s\sim d(s)\)å¼€å§‹ï¼Œåˆ°ä¸€ä¸ªæ—¶é—´å•ä½åç»“æŸï¼Œå¥–åŠ±ä¸º\(r=R(s,a)\)ã€‚æˆ‘ä»¬ç”¨ä¼¼ç„¶æ¯”ä¾‹å»è®¡ç®—ç­–ç•¥æ¢¯åº¦ï¼š</p> \[\begin{aligned}J(\theta) =\mathbb{E}_{\pi_\theta}[r] =\sum_{s \in \mathcal{S}} d(s) \sum_{a \in \mathcal{A}} \pi_\theta(s, a) r\end{aligned}\] <p>å…¶æ¢¯åº¦ä¸ºï¼š</p> \[\begin{aligned}\nabla_\theta J(\theta) &amp; =\sum_{s \in \mathcal{S}} d(s) \sum_{a \in \mathcal{A}} \pi_\theta(s, a) \nabla_\theta \log \pi_\theta(s, a) r \\&amp; =\mathbb{E}_{\pi_\theta}\left[r \nabla_\theta \log \pi_\theta(s, a)\right]\end{aligned}\] <h2 id="23-å¤šæ­¥mdpçš„ç­–ç•¥æ¢¯åº¦">2.3 å¤šæ­¥MDPçš„ç­–ç•¥æ¢¯åº¦</h2> <ol> <li>ä¸€å›åˆçš„è½¨è¿¹å¯ä»¥è¡¨ç¤ºä¸ºï¼š\(\tau=\left(s_0, a_0, r_1, \ldots s_{T-1}, a_{T-1}, r_T, s_T\right) \sim\left(\pi_\theta, P\left(s_{t+1} \mid s_t, a_t\right)\right)\)</li> <li>å…¶è½¨è¿¹çš„å¥–åŠ±ä¸º\(R(\tau)=\sum_{t=0}^{T-1} R\left(s_t, a_t\right)\)</li> <li> <p>ç­–ç•¥ç›®æ ‡ä¸ºï¼š</p> \[J(\theta)=\mathbb{E}_{\pi_\theta}\left[\sum_{t=0}^{T-1} R\left(s_t, a_t\right)\right]=\sum_\tau P(\tau;\theta) R(\tau)\] <p>å…¶ä¸­\(P(\tau;\theta)=d(s_0)\pi_{\theta}(a_0\mid s_0)p(s_1\mid s_0,a_0)\cdots \pi_{\theta}(a_{T-1}\mid s_{T-1})p(s_T \mid s_{T-1},a_{T-1})=d\left(s_0\right) \prod_{t=0}^{T-1} \pi_\theta\left(a_t \mid s_t\right) p\left(s_{t+1} \mid s_t, a_t\right)\)è¡¨ç¤ºæ‰§è¡Œç­–ç•¥\(\pi_\theta\)æ—¶åœ¨è½¨è¿¹ä¸­çš„æ¦‚ç‡</p> </li> <li> <p>æ€»ä½“ç›®æ ‡ï¼šmax \(J(\theta)\)</p> \[\theta^*=\underset{\theta}{\arg \max } J(\theta)=\underset{\theta}{\arg \max } \sum_\tau P(\tau;\theta) R(\tau)\] </li> <li> <p>è®¡ç®—æ¢¯åº¦ï¼š</p> \[\begin{aligned}\nabla_\theta J(\theta) &amp; =\nabla_\theta \sum_\tau P(\tau;\theta) R(\tau) \\&amp; =\sum_\tau \nabla_\theta P(\tau;\theta) R(\tau) \\&amp; =\sum_\tau \frac{P(\tau;\theta)}{P(\tau;\theta)} \nabla_\theta P(\tau;\theta) R(\tau) \\&amp; =\sum_\tau P(\tau;\theta) R(\tau) \frac{\nabla_\theta P(\tau;\theta)}{P(\tau;\theta)} \\&amp; =\sum_\tau P(\tau;\theta) R(\tau) \nabla_\theta \log P(\tau;\theta)\end{aligned}\] </li> <li> <p>ç»éªŒä¼°è®¡ç­–ç•¥ï¼Œè¿‘ä¼¼ï¼š</p> \[\nabla_\theta J(\theta) \approx \frac{1}{m} \sum_{i=1}^m R\left(\tau_i\right) \nabla_\theta \log P\left(\tau_i;\theta\right)\] </li> <li> <p>åˆ†è§£è½¨è¿¹ä¸ºçŠ¶æ€å’ŒåŠ¨ä½œ \(\nabla_\theta \log P(\tau;\theta)\)</p> \[\begin{aligned}\nabla_\theta \log P(\tau;\theta) &amp; =\nabla_\theta \log \left[d\left(s_0\right) \prod_{t=0}^{T-1} \pi_\theta\left(a_t \mid s_t\right) p\left(s_{t+1} \mid s_t, a_t\right)\right] \\&amp; =\nabla_\theta\left[\log d\left(s_0\right)+\sum_{t=0}^{T-1} \log \pi_\theta\left(a_t \mid s_t\right)+\log p\left(s_{t+1} \mid s_t, a_t\right)\right] \\&amp; =\sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\end{aligned}\] \[\textcolor{blue}{\nabla_\theta J(\theta) \approx \frac{1}{m} \sum_{i=1}^m R\left(\tau_i\right) \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t^i \mid s_t^i\right)}\] <p>æˆ‘ä»¬ä¸éœ€è¦çŸ¥é“<strong>è½¬ç§»æ¨¡å‹</strong>ã€‚</p> </li> </ol> <h1 id="ä¸‰å‡å°‘ç­–ç•¥æ¢¯åº¦çš„æ–¹å·®">ä¸‰ã€å‡å°‘ç­–ç•¥æ¢¯åº¦çš„æ–¹å·®</h1> <h2 id="31-ç†è§£æ¢¯åº¦ä¼˜åŒ–çš„è¿‡ç¨‹">3.1 ç†è§£æ¢¯åº¦ä¼˜åŒ–çš„è¿‡ç¨‹</h2> <p>æˆ‘ä»¬è€ƒå¯Ÿçš„æ¢¯åº¦æ˜¯\(E_{\tau \sim \pi_\theta}[R(\tau)]\).æ›´ä¸€èˆ¬çš„ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è®¡ç®—å‡½æ•°\(f(x)\)çš„æœŸæœ›ï¼Œæˆ‘ä»¬æœ‰ï¼š</p> \[\begin{aligned}\nabla_\theta \mathbb{E}_{p(x;\theta)}[f(x)] &amp; =\mathbb{E}_{p(x;\theta)}\left[f(x) \nabla_\theta \log p(x;\theta)\right] \\&amp; \approx \frac{1}{S} \sum_{s=1}^S f\left(x_s\right) \nabla_\theta \log p\left(x_s;\theta\right), \text { where } x_s \sim p(x;\theta)\end{aligned}\] <ol> <li>å¦‚ä½•ç†è§£æ¢¯åº¦ï¼š <ol> <li>ç§»åŠ¨åˆ†å¸ƒ\(p\)ï¼ˆä¼˜åŒ–å‚æ•°\(\theta\)ï¼‰ä½¿å¾—å…¶æœªæ¥çš„æ ·æœ¬\(x\)å¯ä»¥å¾—åˆ°æ›´é«˜çš„åˆ†æ•°</li> <li>å‘é‡\(f(x)\nabla_\theta \log p(x;\theta)\)æŠŠæ ·æœ¬çš„log-likelihoodæ¨å‘ä¸€ä¸ªè¡¨ç¤ºå®ƒçš„åˆ†æ•°ã€‚</li> </ol> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%204-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%204-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%204-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%204.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>ä¸æå¤§ä¼¼ç„¶æ¯”è¾ƒï¼š <ol> <li> <p>ç­–ç•¥æ¢¯åº¦ä¼°è®¡ï¼š</p> \[\nabla_\theta J(\theta) \approx \frac{1}{M} \sum_{m=1}^M\left(\sum_{t=1}^T \nabla_\theta \log \pi_\theta\left(a_{t, m} \mid s_{t, m}\right)\right)\textcolor{red}{\left(\sum_{t=1}^T r\left(s_{t, m}, a_{t, m}\right)\right)}\] </li> <li> <p>æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š</p> \[\nabla_\theta J_{M L}(\theta) \approx \frac{1}{M} \sum_{m=1}^M\left(\sum_{t=1}^T \nabla_\theta \log \pi_\theta\left(a_{t, m} \mid s_{t, m}\right)\right)\] </li> </ol> <p>ä¸»è¦åŒºåˆ«ï¼š<strong>ç»™å¥½çš„åŠ¨ä½œæ›´å¤§çš„å¯èƒ½æ€§ï¼Œç»™ä¸å¥½çš„åŠ¨ä½œæ›´å°çš„å¯èƒ½æ€§</strong></p> </li> </ol> <h2 id="32-ç­–ç•¥æ¢¯åº¦ä¸­æ–¹å·®è¾ƒå¤§çš„é—®é¢˜">3.2 ç­–ç•¥æ¢¯åº¦ä¸­æ–¹å·®è¾ƒå¤§çš„é—®é¢˜</h2> <ol> <li> <p>æˆ‘ä»¬çš„ä¼˜åŒ–å¦‚ä¸‹ï¼š</p> \[\nabla_\theta J(\theta) \approx \frac{1}{m} \sum_{i=1}^m R\left(\tau_i\right) \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t^i \mid s_t^i\right)\] <ul> <li>å°½ç®¡æ˜¯Unbiasedï¼Œä½†æ˜¯å¾ˆNoisy</li> <li>å¦‚ä½•ä¿®æ”¹ï¼Ÿ <ul> <li>ç”¨æ—¶é—´å› æœ</li> <li>å¼•å…¥baseline</li> </ul> </li> </ul> </li> <li> <p>é€šè¿‡æ—¶é—´å› æœè§£å†³å¤§æ–¹å·®é—®é¢˜ï¼š</p> <ol> <li>æ­¤å‰æˆ‘ä»¬æœ‰ï¼š\(\nabla_\theta \mathbb{E}_\tau[R]=\mathbb{E}_\tau \left[\left(\sum_{t=0}^{T-1} r_t\right)\left(\sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right)\right]\)</li> <li> <p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°æŸä¸€æ—¶åˆ»çš„å•ä¸€å¥–åŠ±ï¼š</p> \[\nabla_\theta \mathbb{E}_\tau\left[r_{t^{\prime}}\right]=\mathbb{E}_\tau\left[r_{t^{\prime}} \sum_{t=0}^{t^{\prime}} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] </li> <li> <p>é€šè¿‡å¯¹\(t\)æ±‚å’Œï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š</p> \[\begin{aligned}\nabla_\theta J(\theta)=\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R] &amp; =\mathbb{E}_\tau\left[\sum_{t^{\prime}=0}^{T-1} r_{t^{\prime}} \sum_{t=0}^{t^{\prime}} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right] \\&amp; =\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right) \sum_{\textcolor{red}{t^{\prime}=t}}^{T-1} r_{t^{\prime}}\right] \\&amp; =\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} G_t \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\end{aligned}\] </li> <li> <p>å› æ­¤æˆ‘ä»¬æœ‰ï¼š</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} G_t \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] <ul> <li>\(G_t=\sum_{t^{\prime}=t}^{T-1} r_{t^{\prime}}\) æ˜¯\(t\)æ­¥è½¨è¿¹ä¸­çš„å›æŠ¥</li> <li>å› æœï¼šæ—¶é—´é åçš„ç­–ç•¥ä¸èƒ½å½±å“æ—¶é—´é å‰çš„ç­–ç•¥</li> <li>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„ä¼°è®¡æ›´æ–°ï¼š</li> </ul> \[\nabla_\theta \mathbb{E}[R] \approx \frac{1}{m} \sum_{i=1}^m \sum_{t=0}^{T-1} G_t^{(i)} \cdot \nabla_\theta \log \pi_\theta\left(a_t^i \mid s_t^i\right)\] </li> </ol> <p>ğŸ˜ ä¾‹ï¼š<strong>REINFORCE: ä¸€ç§MCç­–ç•¥æ¢¯åº¦ç®—æ³•</strong></p> <p>ç®—æ³•ç®€å•ä»ç­–ç•¥ä¸­é‡‡æ ·å¤šä¸ªè½¨è¿¹çš„æ ·æœ¬ï¼Œå¹¶ä¸”åŒæ—¶æ›´æ–°\(\theta\)å‚æ•°ï¼š</p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%205-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%205-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%205-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%205.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>é€šè¿‡å¼•å…¥baselineè§£å†³æ–¹å·®å¤§çš„é—®é¢˜ï¼š <ol> <li> <p>åŸå§‹æ›´æ–°ï¼š\(G_t=\sum_{t^{\prime}=t}^{T-1} r_{t^{\prime}}\)å¯èƒ½æœ‰å¾ˆå¤§çš„æ–¹å·®</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \textcolor{red}{G_t} \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] </li> <li> <p>å¯ä»¥é€šè¿‡å‡å»ä¸€ä¸ªbaselineæ¥å‡å°æ–¹å·®</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \textcolor{red}{(G_t-b(s_t))} \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] </li> <li> <p>ä¸€ä¸ªå¥½çš„baselineå°±æ˜¯æœŸæœ›å¥–åŠ±ï¼š</p> \[b\left(s_t\right)=\mathbb{E}\left[r_t+r_{t+1}+\ldots+r_{T-1}\right]\] </li> <li> <p>è§£é‡Šï¼šæˆ‘ä»¬ä¼˜åŒ–çš„ä¸å†æ˜¯\(G_t\)æœ¬èº«ï¼Œè€Œæ˜¯\(G_t\)å¯ä»¥æ¯”baselineå¥½å¤šå°‘ã€‚å¯ä»¥è¯æ˜è¿™æ ·å¯ä»¥é™ä½æ–¹å·®ï¼š</p> \[\begin{aligned}\mathbb{E}_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right) b\left(s_t\right)\right] &amp; =0, \\E_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\left(G_t-b\left(s_t\right)\right)\right] &amp; =E_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right) G_t\right] \\\operatorname{Var}_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\left(G_t-b\left(s_t\right)\right)\right] &amp; &lt;\operatorname{Var}_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right) G_t\right]\end{aligned}\] </li> <li> <p>åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™baselineä¸€ä¸ªå‚æ•°æ¥è¿›è¡Œå­¦ä¹ ï¼š</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \textcolor{red}{(G_t-b_{\mathbf{w}}(s_t))} \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] <p>\(\mathbf{w}\)ç”¨äºè®­ç»ƒbaselineï¼Œå› æ­¤æˆ‘ä»¬æœ‰ä¸¤å¥—å‚æ•°ï¼š\(\mathbf{w}\)å’Œ\(\theta\).</p> </li> </ol> <p>ğŸ˜ å¸¦æœ‰baselineçš„ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼š</p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%206-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%206-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%206-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%206.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h1 id="å››æ¼”å‘˜-è¯„è®ºå‘˜">å››ã€<strong>æ¼”å‘˜-è¯„è®ºå‘˜</strong></h1> <ol> <li> <p>é™¤äº†å¼•å…¥baselineå’Œæ—¶é—´å› æœï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å¼•å…¥Criticçš„æ–¹å¼æ¥é™ä½æ–¹å·®ï¼Œè¿™å°±å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç®—æ³•ã€‚</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \textcolor{red}{G_t} \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] <ul> <li>å®è·µä¸Š\(G_t\)æ˜¯MCç­–ç•¥æ¢¯åº¦çš„ä¸€ä¸ªæ ·æœ¬ï¼Œæ˜¯å¯¹\(Q^{\pi_\theta}(s_t,a_t)\)çš„ä¸€ä¸ªunbiased noisyä¼°è®¡ã€‚</li> <li> <p>å®é™…ä¸Šæˆ‘ä»¬å¯ä»¥ä¸ç”¨\(G_t\)ï¼Œè€Œç”¨ä¸€ä¸ªè¯„è®ºå‘˜å»ä¼°è®¡Qå‡½æ•°ã€‚</p> \[Q_{\mathbf{w}}(s, a) \approx Q^{\pi_\theta}(s, a)\] \[\nabla_\theta J(\theta)=\mathbb{E}_{\pi_\theta}\left[\sum_{t=0}^{T-1} Q_{\textcolor{red}{\mathbf{w}}}\left(s_t, a_t\right) \cdot \nabla_\theta \log \pi_{\textcolor{red}\theta}\left(a_t \mid s_t\right)\right]\] </li> </ul> </li> <li> <p>ä¸Šå¼å°±æ˜¯Actor-Criticç­–ç•¥æ¢¯åº¦ï¼š</p> <ul> <li>Actorï¼špolicy functionï¼Œç”¨äºç”ŸæˆåŠ¨ä½œï¼Œå­¦ä¹ å‚æ•°\(\theta\)</li> <li> <p>Criticï¼švalue functionï¼Œè¡¡é‡åŠ¨ä½œçš„å›æŠ¥ï¼Œå­¦ä¹ å‚æ•°\(\mathbf{w}\)</p> <blockquote> <p>Criticï¼šç±»ä¼¼äºç­–ç•¥è¯„ä¼°çš„ä½œç”¨</p> </blockquote> </li> </ul> </li> </ol> <h2 id="41-åŠ¨ä½œä»·å€¼åŠ¨ä½œè¯„è®ºå‘˜ç®—æ³•qac">4.1 åŠ¨ä½œä»·å€¼åŠ¨ä½œè¯„è®ºå‘˜ç®—æ³•(QAC)</h2> <ol> <li> <p>ç”¨ä¸€ä¸ªçº¿æ€§ä»·å€¼å‡½æ•°è¿‘ä¼¼ï¼š</p> \[Q_{\mathbf{w}}(s, a)=\psi(s, a)^T \mathbf{w}\] <p>å…¶ä¸­ï¼Œè¯„è®ºå‘˜ç”¨ä¸€ä¸ªçº¿æ€§TD(0)æ¥æ›´æ–°å‚æ•°\(\mathbf{w}\)ï¼ŒäºŒæ¼”å‘˜é€šè¿‡ç­–ç•¥æ¢¯åº¦æ›´æ–°å‚æ•°\(\theta\).</p> </li> <li>å…·ä½“ç®—æ³•æµç¨‹ï¼š</li> <li>æ¼”å‘˜-è¯„è®ºå‘˜å‡½æ•°è¿‘ä¼¼æ–¹æ³•ï¼š</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%207-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%207-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%207-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%207.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>æˆ‘ä»¬å¯ä»¥æœ‰ä¸¤ä¸ªä¸åŒçš„å‡½æ•°æ¥è¿‘ä¼¼ç­–ç•¥å‡½æ•°å’Œä»·å€¼å‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªå…±äº«çš„ç½‘ç»œæ¥æ¶‰åŠåŒæ—¶å¾—åˆ°ä¸¤ä¸ªå‡½æ•°ã€‚</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%208-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%208-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%208-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%208.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="42-å¸¦baslineçš„æ¼”å‘˜-è¯„è®ºå‘˜ç®—æ³•a2c--tdac">4.2 å¸¦baslineçš„æ¼”å‘˜-è¯„è®ºå‘˜ç®—æ³•(A2C &amp; TDAC)</h2> <ol> <li> <p>æˆ‘ä»¬å®šä¹‰Qå‡½æ•°å¦‚ä¸‹ï¼š</p> \[Q^{\pi, \gamma}(s, a)=\mathbb{E}_\pi\left[r_1+\gamma r_2+\ldots \mid s_1=s, a_1=a\right]\] <p>é‚£ä¹ˆå…¶å®ä»·å€¼å‡½æ•°å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„baselineï¼š</p> \[\begin{aligned}V^{\pi, \gamma}(s) &amp; =\mathbb{E}_\pi\left[r_1+\gamma r_2+\ldots \mid s_1=s\right] \\&amp; =\mathbb{E}_{a \sim \pi}\left[Q^{\pi, \gamma}(s, a)\right]\end{aligned}\] </li> <li> <p>advantage functionï¼šæˆ‘ä»¬å®šä¹‰å¸¦æœ‰baselineï¼ˆä»·å€¼å‡½æ•°ï¼‰çš„Qå‡½æ•°ä¸ºadvantage functionï¼Œå³</p> \[A^{\pi, \gamma}(s, a)=Q^{\pi, \gamma}(s, a)-V^{\pi, \gamma}(s)\] </li> <li> <p>ç­–ç•¥æ¢¯åº¦ä¸ºï¼š</p> \[\nabla_\theta J(\theta)=\mathbb{E}_{\pi_\theta}\left[\nabla_\theta \log \pi_\theta(s, a) A^{\pi, \gamma}(s, a)\right]\] </li> <li> <p>åœ¨ç­–ç•¥æ¢¯åº¦é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨MCæ¥ä¼°è®¡å›æŠ¥ï¼Œä¹Ÿå¯ä»¥ç”¨TDæ–¹æ³•æ¥ä¼°è®¡ã€‚å¦‚æœæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªnæ­¥çš„å›æŠ¥ï¼Œæˆ‘ä»¬æœ‰ï¼š</p> \[\begin{aligned}n=1(T D) &amp; G_t^{(1)}=r_{t+1}+\gamma v\left(s_{t+1}\right) \\n=2 \quad &amp; G_t^{(2)}=r_{t+1}+\gamma r_{t+2}+\gamma^2 v\left(s_{t+2}\right) \\n=\infty(M C) &amp; G_t^{(\infty)}=r_{t+1}+\gamma r_{t+2}+\ldots+\gamma^{T-t-1} r_T\end{aligned}\] <p>é‚£ä¹ˆæˆ‘ä»¬çš„advantage functionä¼°è®¡å¯ä»¥å†™ä¸ºï¼š</p> \[\begin{aligned}&amp; \hat{A}_t^{(1)}=r_{t+1}+\gamma v\left(s_{t+1}\right)-v\left(s_t\right) \\&amp; \hat{A}_t^{(2)}=r_{t+1}+\gamma r_{t+2}+\gamma^2 v\left(s_{t+2}\right)-v\left(s_t\right) \\&amp; \hat{A}_t^{(\infty)}=r_{t+1}+\gamma r_{t+2}+\ldots+\gamma^{T-t-1} r_T-v\left(s_t\right)\end{aligned}\] <p>æ³¨æ„åˆ°ï¼Œ\(\hat{A}^{(\infty)}\)æœ‰å¤§varï¼Œå°biasï¼Œè€Œ\(\hat{A}^{(1)}\)æœ‰å°varï¼Œå¤§biasã€‚</p> </li> <li> <p>ä¸åŒæ—¶é—´å°ºåº¦çš„æ¼”å‘˜ï¼š</p> <p>ç­–ç•¥æ¢¯åº¦å¯ä»¥åœ¨å¾ˆå¤šæ—¶é—´å°ºåº¦ä¸Šä¼°è®¡</p> \[\nabla_\theta J(\theta)=\mathbb{E}_{\pi_\theta}\left[\nabla_\theta \log \pi_\theta(s, a) A^{\pi_\theta}(s, a)\right]\] <ul> <li> <p>MCæ¼”å‘˜-è¯„è®ºå‘˜ç­–ç•¥æ¢¯åº¦ç”¨<strong>æ•´ä¸ªå›æŠ¥</strong>è¯¯å·®æ¥ä¼˜åŒ–ï¼š</p> \[\nabla_\theta J(\theta)=\alpha\left(G_t-V_\kappa\left(s_t\right)\right) \nabla_\theta \log \pi_\theta\left(s_t, a_t\right)\] </li> <li> <p>TDæ¼”å‘˜-è¯„è®ºå‘˜ç­–ç•¥æ¢¯åº¦ç”¨TDè¯¯å·®æ¥ä¼˜åŒ–ï¼š</p> \[\nabla_\theta J(\theta)=\alpha\left(r+\gamma V_\kappa\left(s_{t+1}\right)-V_\kappa\left(s_t\right)\right) \nabla_\theta \log \pi_\theta\left(s_t, a_t\right)\] </li> <li> <p>kæ­¥TDæ¼”å‘˜-è¯„è®ºå‘˜ç­–ç•¥æ¢¯åº¦ç”¨kæ­¥å›æŠ¥è¯¯å·®æ¥ä¼˜åŒ–ï¼š</p> \[\nabla_\theta J(\theta)=\alpha\left(\sum_{i=0}^k \gamma^i r_{t+i}+\gamma^k V_\kappa\left(s_{t+k}\right)-V_\kappa\left(s_t\right)\right) \nabla_\theta \log \pi_\theta\left(s_t, a_t\right)\] </li> </ul> <blockquote> <p>TDç®—æ³•åªéœ€è¦ä¼˜åŒ–criticçš„å‚æ•°\(\kappa\)ï¼</p> </blockquote> </li> </ol> <h1 id="äº”ç­–ç•¥æ¢¯åº¦å°ç»“">äº”ã€ç­–ç•¥æ¢¯åº¦å°ç»“</h1> <ol> <li>ç­–ç•¥æ¢¯åº¦å¯ä»¥è§£å†³ä¸å¯å¾®çš„æƒ…å½¢ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡éšæœºç­–ç•¥é‡‡æ ·æ¥ç»“ç®—</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%209-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%209-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%209-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%209.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>è®­ç»ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬ä¼šäº§ç”Ÿä¸€äº›æ ·æœ¬ï¼ˆå›¾ä¸­ä¸åŒåˆ†æ”¯ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä¸åŒæ ·æœ¬å°½å¯èƒ½å¾—åˆ°æ¯”è¾ƒå¥½çš„ç»“æœï¼ˆæ¯”å¦‚å°çš„lossï¼‰ã€‚</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%2010-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%2010-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%2010-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%2010.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>ç­–ç•¥æ¢¯åº¦æ‹“å±•ï¼šå¤§éƒ¨åˆ†SOTAçš„RLæ–¹æ³•éƒ½æ˜¯åŸºäºç­–ç•¥çš„ã€‚</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%2011-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%2011-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%2011-1400.webp"/> <img src="/assets/img/RL_chapter5/Untitled%2011.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>ä¸åŒRLæµæ´¾ï¼š <ol> <li>åŸºäºä»·å€¼çš„RLï¼šé€šè¿‡DPè§£å†³RL <ol> <li>ç»å…¸RLå’Œæ§åˆ¶è®º</li> <li>ä»£è¡¨æ€§ç®—æ³•ï¼šDeep Q-learningå’Œå…¶å˜ç§</li> <li>ä»£è¡¨ç ”ç©¶äººå‘˜ï¼šRichard Suttonï¼ŒDavid Silver</li> <li>ä»£è¡¨æœºæ„ï¼šDeepmind</li> </ol> </li> <li>åŸºäºç­–ç•¥çš„RLï¼šé€šè¿‡å­¦ä¹ è§£å†³RL <ol> <li>æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ </li> <li>ä»£è¡¨æ€§ç®—æ³•ï¼šPGå’Œå…¶å˜ç§</li> <li>ä»£è¡¨ç ”ç©¶äººå‘˜ï¼šPieter Abeel, Sergey Levine, John Schulman</li> <li>ä»£è¡¨æœºæ„ï¼šOpenAI, Berkeley</li> </ol> </li> </ol> </li> </ol>]]></content><author><name></name></author><category term="Reinforcement-Learning"/><category term="intro"/><summary type="html"><![CDATA[PO]]></summary></entry><entry><title type="html">ç¬¬äºŒç«  Markov Decision Process (é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹)</title><link href="https://gszfwsb.github.io/blog/2023/RL-lecture2/" rel="alternate" type="text/html" title="ç¬¬äºŒç«  Markov Decision Process (é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹)"/><published>2023-10-29T00:00:00+00:00</published><updated>2023-10-29T00:00:00+00:00</updated><id>https://gszfwsb.github.io/blog/2023/RL-lecture2</id><content type="html" xml:base="https://gszfwsb.github.io/blog/2023/RL-lecture2/"><![CDATA[<p>å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œæ™ºèƒ½ä½“ä¸ç¯å¢ƒå°±æ˜¯è¿™æ ·è¿›è¡Œäº¤äº’çš„ï¼Œè¿™ä¸ªäº¤äº’è¿‡ç¨‹å¯ä»¥é€šè¿‡é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹æ¥è¡¨ç¤ºï¼Œæ‰€ä»¥é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹æ˜¯å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬æ¡†æ¶ã€‚</p> <p>åœ¨ä»‹ç»é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»‹ç»å®ƒçš„ç®€åŒ–ç‰ˆæœ¬ï¼šé©¬å°”å¯å¤«è¿‡ç¨‹ï¼ˆMarkov processï¼ŒMPï¼‰ä»¥åŠé©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹ï¼ˆMarkov reward processï¼ŒMRPï¼‰ã€‚é€šè¿‡ä¸è¿™ä¸¤ç§è¿‡ç¨‹çš„æ¯”è¾ƒï¼Œæˆ‘ä»¬å¯ä»¥æ›´å®¹æ˜“ç†è§£é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬ä¼šä»‹ç»é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¸­çš„<strong>ç­–ç•¥è¯„ä¼°ï¼ˆpolicy evaluationï¼‰</strong>ï¼Œå°±æ˜¯å½“ç»™å®šå†³ç­–åï¼Œæˆ‘ä»¬æ€ä¹ˆå»è®¡ç®—å®ƒçš„ä»·å€¼å‡½æ•°ã€‚æœ€åï¼Œæˆ‘ä»¬ä¼šä»‹ç»é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„æ§åˆ¶ï¼Œå…·ä½“æœ‰<strong>ç­–ç•¥è¿­ä»£ï¼ˆpolicy iterationï¼‰</strong>Â å’Œ<strong>ä»·å€¼è¿­ä»£ï¼ˆvalue iterationï¼‰</strong>ä¸¤ç§ç®—æ³•ã€‚åœ¨é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¸­ï¼Œå®ƒçš„ç¯å¢ƒæ˜¯å…¨éƒ¨å¯è§‚æµ‹çš„ã€‚ä½†æ˜¯å¾ˆå¤šæ—¶å€™ç¯å¢ƒé‡Œé¢æœ‰äº›é‡æ˜¯ä¸å¯è§‚æµ‹çš„ï¼Œä½†æ˜¯è¿™ä¸ªéƒ¨åˆ†è§‚æµ‹çš„é—®é¢˜ä¹Ÿå¯ä»¥è½¬æ¢æˆé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„é—®é¢˜ã€‚</p> <h1 id="ä¸€é©¬å°”å¯å¤«è¿‡ç¨‹">ä¸€ã€é©¬å°”å¯å¤«è¿‡ç¨‹</h1> <p>MPå®šä¹‰</p> <ul> <li>\(S\) æœ‰é™çŠ¶æ€é›†</li> <li>\(P^a\) åŠ¨ä½œè½¬ç§»æ¨¡å‹ï¼Œ\(P\left(s_{t+1}=s^{\prime} \mid s_t=s\right)\)</li> <li>æŠ˜æ‰£é“¶å­ \(\gamma \in[0,1]\)</li> <li>MDP æ˜¯ä¸€ä¸ªå…ƒç»„: \((S, P, \gamma)\)ã€‚</li> </ul> <h2 id="11-é©¬å°”å¯å¤«æ€§è´¨">1.1 é©¬å°”å¯å¤«æ€§è´¨</h2> <p>åœ¨éšæœºè¿‡ç¨‹ä¸­ï¼Œé©¬å°”å¯å¤«æ€§è´¨ (Markov property) æ˜¯æŒ‡ä¸€ä¸ªéšæœºè¿‡ç¨‹åœ¨ç»™å®šç°åœ¨çŠ¶æ€åŠæ‰€æœ‰è¿‡å»çŠ¶æ€æƒ…å†µä¸‹ï¼Œå…¶æœ«æ¥çŠ¶æ€çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒä»…ä¾èµ–äº<strong>å½“å‰çŠ¶æ€</strong>ã€‚ä»¥ç¦»æ•£éšæœºè¿‡ç¨‹ä¸ºä¾‹ï¼Œå‡è®¾éšæœºå˜é‡ \(X_0, X_1, \cdots, X_T\) æ„æˆä¸€ä¸ªéšæœºè¿‡ç¨‹ã€‚è¿™äº›éšæœºå˜é‡çš„æ‰€æœ‰å¯èƒ½å–å€¼çš„é›†åˆè¢«ç§°ä¸ºçŠ¶æ€ç©ºé—´ (state space) ã€‚å¦‚æœ \(X_{t+1}\) å¯¹äºè¿‡å»çŠ¶æ€çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒä»…æ˜¯ \(X_t\) çš„ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™</p> \[p\left(X_{t+1}=x_{t+1} \mid X_{0: t}=x_{0: t}\right)=p\left(X_{t+1}=x_{t+1} \mid X_t=x_t\right)\] <p>å…¶ä¸­ï¼Œ \(X_{0: t}\) è¡¨ç¤ºå˜é‡é›†åˆ \(X_0, X_1, \cdots, X_t ï¼Œ x_{0: t}\) ä¸ºåœ¨çŠ¶æ€ç©ºé—´ä¸­çš„çŠ¶æ€åºåˆ— \(x_0, x_1, \cdots, x_t\) ã€‚é©¬å°”å¯å¤«æ€§è´¨ä¹Ÿå¯ä»¥æè¿°ä¸ºç»™å®šå½“å‰çŠ¶æ€æ—¶ï¼Œå°†æ¥çš„çŠ¶æ€ä¸è¿‡å»çŠ¶æ€æ˜¯<strong>æ¡ä»¶ç‹¬ç«‹</strong>çš„ã€‚å¦‚æœæŸä¸€ä¸ªè¿‡ç¨‹æ»¡è¶³é©¬å°”å¯å¤«æ€§è´¨ï¼Œé‚£ä¹ˆæœ«æ¥çš„è½¬ç§»ä¸è¿‡å»çš„æ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒåªå–å†³äºç°åœ¨ã€‚é©¬å°”å¯å¤«æ€§è´¨æ˜¯ æ‰€æœ‰é©¬å°”å¯å¤«è¿‡ç¨‹çš„åŸºç¡€ã€‚</p> <h2 id="12-é©¬å°”å¯å¤«é“¾">1.2 é©¬å°”å¯å¤«é“¾</h2> <p>é©¬å°”å¯å¤«è¿‡ç¨‹æ˜¯ä¸€ç»„å…·æœ‰é©¬å°”å¯å¤«æ€§è´¨çš„éšæœºå˜é‡åºåˆ— \(s_1, \cdots, s_t\) ï¼Œå…¶ä¸­ä¸‹ä¸€ä¸ªæ—¶åˆ»çš„çŠ¶æ€ \(s_{t+1}\) åªå–å†³äºå½“å‰çŠ¶æ€ \(s_t\) ã€‚æˆ‘ä»¬è®¾çŠ¶æ€çš„å†å²ä¸º \(h_t=\left\{s_1, s_2, s_3, \ldots, s_t\right\}\) ( \(h_t\) åŒ…å«äº†ä¹‹å‰çš„æ‰€æœ‰çŠ¶æ€)ï¼Œåˆ™é©¬å°”å¯å¤«è¿‡ç¨‹æ»¡è¶³æ¡ä»¶:</p> \[p\left(s_{t+1} \mid s_t\right)=p\left(s_{t+1} \mid h_t\right)\] <p>ä»å½“å‰ \(s_t\) è½¬ç§»åˆ° \(s_{t+1}\) ï¼Œå®ƒæ˜¯ç›´æ¥å°±ç­‰äºå®ƒä¹‹å‰æ‰€æœ‰çš„çŠ¶æ€è½¬ç§»åˆ° \(s_{t+1}\) ã€‚<strong>ç¦»æ•£æ—¶é—´çš„é©¬å°”å¯å¤«è¿‡ç¨‹</strong>ä¹Ÿç§°ä¸º<strong>é©¬å°”å¯å¤«é“¾</strong> (Markov chain) ã€‚é©¬å°”å¯å¤«é“¾æ˜¯æœ€ç®€å•çš„é©¬å°”å¯å¤«è¿‡ç¨‹ï¼Œå…¶çŠ¶æ€æ˜¯æœ‰é™çš„ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥ç”¨çŠ¶æ€è½¬ç§»çŸ©é˜µ (state transition matrix) \(\boldsymbol{P}\) æ¥æè¿°çŠ¶æ€è½¬ç§» \(p\left(s_{t+1}=s^{\prime} \mid s_t=s\right)\) :</p> \[\boldsymbol{P}=\left(\begin{array}{cccc} p\left(s_1 \mid s_1\right) &amp; p\left(s_2 \mid s_1\right) &amp; \ldots &amp; p\left(s_N \mid s_1\right) \\ p\left(s_1 \mid s_2\right) &amp; p\left(s_2 \mid s_2\right) &amp; \ldots &amp; p\left(s_N \mid s_2\right) \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ p\left(s_1 \mid s_N\right) &amp; p\left(s_2 \mid s_N\right) &amp; \ldots &amp; p\left(s_N \mid s_N\right) \end{array}\right)\] <p>çŠ¶æ€è½¬ç§»çŸ©é˜µç±»ä¼¼äºæ¡ä»¶æ¦‚ç‡ (conditional probability)ï¼Œå®ƒè¡¨ç¤ºå½“æˆ‘ä»¬çŸ¥é“å½“å‰æˆ‘ä»¬åœ¨çŠ¶æ€ \(s_t\) æ—¶ï¼Œåˆ°è¾¾ä¸‹é¢æ‰€æœ‰çŠ¶æ€çš„æ¦‚ç‡ã€‚æ‰€ä»¥å®ƒçš„æ¯ä¸€è¡Œæè¿°çš„æ˜¯ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°è¾¾æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹çš„æ¦‚ç‡ã€‚</p> <h1 id="äºŒé©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹">äºŒã€é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹</h1> <p>MRPå®šä¹‰</p> <ul> <li>\(S\) æœ‰é™çŠ¶æ€é›†</li> <li>\(P\) è½¬ç§»æ¨¡å‹ï¼Œ\(P\left(s_{t+1}=s^{\prime} \mid s_t=s\right)\)</li> <li>\(R\) å¥–åŠ±å‡½æ•° \(R\left(s_t=s, \right)=\mathbb{E}\left[r_t \mid s_t=s\right]\)</li> <li>æŠ˜æ‰£é“¶å­ \(\gamma \in[0,1]\)</li> <li>MDP æ˜¯ä¸€ä¸ªå…ƒç»„: \((S, P, R, \gamma)\)ã€‚</li> </ul> <h2 id="21-å›æŠ¥å’Œä»·å€¼å‡½æ•°">2.1 å›æŠ¥å’Œä»·å€¼å‡½æ•°</h2> <p>é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹ï¼ˆMarkov reward process, MRPï¼‰æ˜¯<strong>é©¬å°”å¯å¤«é“¾</strong>åŠ ä¸Š<strong>å¥–åŠ±å‡½æ•°</strong>ã€‚åœ¨é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹ä¸­ï¼ŒçŠ¶æ€è½¬ç§»çŸ©é˜µå’ŒçŠ¶æ€éƒ½ä¸é©¬å°”å¯å¤«é“¾ä¸€æ ·ï¼Œåªæ˜¯å¤šäº†<strong>å¥–åŠ±å‡½æ•°ï¼ˆreward functionï¼‰</strong>ã€‚å¥–åŠ±å‡½æ•°\(R\)æ˜¯ä¸€ä¸ªæœŸæœ›ï¼Œè¡¨ç¤ºå½“æˆ‘ä»¬åˆ°è¾¾æŸä¸€ä¸ªçŠ¶æ€çš„æ—¶å€™ï¼Œå¯ä»¥è·å¾—å¤šå¤§çš„å¥–åŠ±ã€‚è¿™é‡Œå¦å¤–å®šä¹‰äº†æŠ˜æ‰£å› å­\(\gamma\)ã€‚å¦‚æœçŠ¶æ€æ•°æ˜¯æœ‰é™çš„ï¼Œé‚£ä¹ˆ\(R\)å¯ä»¥æ˜¯ä¸€ä¸ªå‘é‡ã€‚</p> <ol> <li>èŒƒå›´ï¼ˆhorizonï¼‰ï¼šæ˜¯æŒ‡ä¸€ä¸ªå›åˆçš„é•¿åº¦ï¼ˆæ¯ä¸ªå›åˆæœ€å¤§çš„æ—¶é—´æ­¥æ•°ï¼‰ï¼Œå®ƒæ˜¯ç”±æœ‰é™ä¸ªæ­¥æ•°å†³å®šçš„ã€‚</li> <li> <p>å›æŠ¥ï¼ˆreturnï¼‰ï¼šå¯ä»¥å®šä¹‰ä¸ºå¥–åŠ±çš„é€æ­¥å åŠ ï¼Œæ—¶åˆ»\(t\)åçš„å¥–åŠ±åºåˆ—ä¸ºï¼š</p> \[G_t=r_{t+1}+\gamma r_{t+2}+\gamma^2 r_{t+3}+\gamma^3 r_{t+4}+\ldots+\gamma^{T-t-1} r_T\] <p>å…¶ä¸­ï¼Œ \(T\) æ˜¯æœ€ç»ˆæ—¶åˆ»ï¼Œ \(\gamma\) æ˜¯æŠ˜æ‰£å› å­ï¼Œè¶Šå¾€åå¾—åˆ°çš„å¥–åŠ±ï¼ŒæŠ˜æ‰£è¶Šå¤šã€‚è¿™è¯´æ˜æˆ‘ä»¬æ›´å¸Œæœ›å¾—åˆ°ç°æœ‰çš„å¥–åŠ±ï¼Œå¯¹æœ«æ¥çš„å¥–åŠ±è¦æ‰“æŠ˜æ‰£ã€‚å½“æˆ‘ä»¬æœ‰äº†å› æŠ¥ä¹‹åï¼Œå°±å¯ä»¥å®šä¹‰çŠ¶æ€çš„ä»·å€¼äº†ï¼Œå°±æ˜¯çŠ¶æ€ä»·å€¼å‡½æ•°ï¼ˆstate-value functionï¼‰ã€‚å¯¹äºé©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹ï¼ŒçŠ¶æ€ä»·å€¼å‡½æ•°è¢«å®šä¹‰æˆå›æŠ¥çš„æœŸæœ›ï¼Œå³</p> \[\begin{aligned} V_t(s) &amp; =\mathbb{E}\left[G_t \mid s_t=s\right] \\ &amp; =\mathbb{E}\left[r_{t+1}+\gamma r_{t+2}+\gamma^2 r_{t+3}+\ldots+\gamma^{T-t-1} r_T \mid s_t=s\right] \end{aligned}\] <p>å…¶ä¸­ï¼Œ \(G_t\) æ˜¯ä¹‹å‰å®šä¹‰çš„æŠ˜æ‰£å›æŠ¥ï¼ˆdiscounted return) ã€‚æˆ‘ä»¬å¯¹ \(G_t\) å–äº†ä¸€ä¸ªæœŸæœ›ï¼ŒæœŸæœ›å°±æ˜¯ä»è¿™ä¸ªçŠ¶æ€å¼€å§‹ï¼Œæˆ‘ä»¬å¯èƒ½è·å¾—å¤šå¤§çš„ä»·å€¼ã€‚æ‰€ä»¥æœŸæœ›ä¹Ÿå¯ä»¥çœ‹æˆæœ«æ¥å¯èƒ½è·å¾—å¥–åŠ±çš„å½“å‰ä»·å€¼çš„è¡¨ç°ï¼Œå°±æ˜¯å½“æˆ‘ä»¬è¿›å…¥æŸä¸€ä¸ªçŠ¶æ€åï¼Œæˆ‘ä»¬ç°åœ¨æœ‰å¤šå¤§çš„ä»·å€¼ã€‚</p> <p>ğŸ˜ ä¸ºä»€ä¹ˆç”¨æŠ˜æ‰£å› å­ï¼Ÿ</p> <p><strong>ç¬¬ä¸€</strong>ï¼Œæœ‰äº›é©¬å°”å¯å¤«è¿‡ç¨‹æ˜¯å¸¦ç¯çš„ï¼Œå®ƒå¹¶ä¸ä¼šç»ˆç»“ï¼Œæˆ‘ä»¬æƒ³é¿å…æ— ç©·çš„å¥–åŠ±ã€‚</p> <p><strong>ç¬¬äºŒ</strong>ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½å»ºç«‹å®Œç¾çš„æ¨¡æ‹Ÿç¯å¢ƒçš„æ¨¡å‹ï¼Œæˆ‘ä»¬å¯¹æœªæ¥çš„è¯„ä¼°ä¸ä¸€å®šæ˜¯å‡†ç¡®çš„ï¼Œæˆ‘ä»¬ä¸ä¸€å®šå®Œå…¨ä¿¡ä»»æ¨¡å‹ï¼Œå› ä¸ºè¿™ç§ä¸ç¡®å®šæ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹æœªæ¥çš„è¯„ä¼°å¢åŠ ä¸€ä¸ªæŠ˜æ‰£ã€‚æˆ‘ä»¬æƒ³æŠŠè¿™ä¸ªä¸ç¡®å®šæ€§è¡¨ç¤ºå‡ºæ¥ï¼Œå¸Œæœ›å°½å¯èƒ½å¿«åœ°å¾—åˆ°å¥–åŠ±ï¼Œè€Œä¸æ˜¯åœ¨æœªæ¥æŸä¸€ä¸ªç‚¹å¾—åˆ°å¥–åŠ±ã€‚</p> <p><strong>ç¬¬ä¸‰</strong>ï¼Œå¦‚æœå¥–åŠ±æ˜¯æœ‰å®é™…ä»·å€¼çš„ï¼Œæˆ‘ä»¬å¯èƒ½æ›´å¸Œæœ›ç«‹åˆ»å°±å¾—åˆ°å¥–åŠ±ï¼Œè€Œä¸æ˜¯åé¢å†å¾—åˆ°å¥–åŠ±ï¼ˆç°åœ¨çš„é’±æ¯”ä»¥åçš„é’±æ›´æœ‰ä»·å€¼ï¼‰ã€‚</p> <p><strong>æœ€å</strong>ï¼Œæˆ‘ä»¬ä¹Ÿæ›´æƒ³å¾—åˆ°å³æ—¶å¥–åŠ±ã€‚æœ‰äº›æ—¶å€™å¯ä»¥æŠŠæŠ˜æ‰£å› å­è®¾ä¸º 0ï¼Œæˆ‘ä»¬å°±åªå…³æ³¨å½“å‰çš„å¥–åŠ±ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠæŠ˜æ‰£å› å­è®¾ä¸º 1ï¼Œï¼Œå¯¹æœªæ¥çš„å¥–åŠ±å¹¶æ²¡æœ‰æ‰“æŠ˜æ‰£ï¼Œæœªæ¥è·å¾—çš„å¥–åŠ±ä¸å½“å‰è·å¾—çš„å¥–åŠ±æ˜¯ä¸€æ ·çš„ã€‚æŠ˜æ‰£å› å­å¯ä»¥ä½œä¸ºå¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“çš„ä¸€ä¸ªè¶…å‚æ•°æ¥è¿›è¡Œè°ƒæ•´ï¼Œé€šè¿‡è°ƒæ•´æŠ˜æ‰£å› å­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸åŒåŠ¨ä½œçš„æ™ºèƒ½ä½“ã€‚</p> </li> </ol> <h2 id="22-è´å°”æ›¼æ–¹ç¨‹">2.2 è´å°”æ›¼æ–¹ç¨‹</h2> <p>ä»ä»·å€¼å‡½æ•°é‡Œé¢æ¨å¯¼å‡º<strong>è´å°”æ›¼æ–¹ç¨‹ï¼ˆBellman equationï¼‰</strong>ï¼Œå…ˆä¸Šç»“è®ºï¼š</p> \[V(s)=\underbrace{R(s)}_{\text {å³æ—¶å¥–åŠ± }}+\underbrace{\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s\right) V\left(s^{\prime}\right)}_{\text {æœ«æ¥å¥–åŠ±çš„æŠ˜æ‰£æ€»å’Œ }}\] <p>å…¶ä¸­ï¼Œ</p> <ul> <li>\(s^{\prime}\) å¯ä»¥çœ‹æˆæœ«æ¥çš„æ‰€æœ‰çŠ¶æ€ï¼Œ</li> <li>\(p\left(s^{\prime} \mid s\right)\) æ˜¯æŒ‡ä»å½“å‰çŠ¶æ€è½¬ç§»åˆ°æœ«æ¥çŠ¶æ€çš„æ¦‚ç‡ã€‚</li> <li>\(V\left(s^{\prime}\right)\) ä»£è¡¨çš„æ˜¯æœ«æ¥æŸä¸€ä¸ªçŠ¶æ€çš„ä»·å€¼ã€‚æˆ‘ä»¬ä»å½“å‰çŠ¶æ€å¼€å§‹ï¼Œæœ‰ä¸€å®šçš„æ¦‚ç‡å»åˆ°æœ«æ¥çš„æ‰€æœ‰çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠ \(p\left(s^{\prime} \mid s\right)\) å†™ä¸Šå»ã€‚æˆ‘ä»¬å¾—åˆ°äº†æœ«æ¥çŠ¶æ€åï¼Œä¹˜ä¸€ä¸ª \(\gamma\) ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠæœ«æ¥çš„å¥–åŠ±æ‰“æŠ˜æ‰£ã€‚</li> <li>\(\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s\right) V\left(s^{\prime}\right)\) å¯ä»¥çœ‹æˆæœ«æ¥å¥–åŠ±çš„æŠ˜æ‰£æ€»å’Œ (discounted sum of future reward)ã€‚ è´å°”æ›¼æ–¹ç¨‹å®šä¹‰äº†å½“å‰çŠ¶æ€ä¸æœ«æ¥çŠ¶æ€ä¹‹é—´çš„å…³ç³»ã€‚æœ«æ¥å¥–åŠ±çš„æŠ˜æ‰£æ€»å’ŒåŠ ä¸Šå³æ—¶å¥–åŠ±ï¼Œå°±ç»„æˆäº†è´å°”æ›¼æ–¹ç¨‹ã€‚</li> <li> <p>æ¨å¯¼è¿‡ç¨‹</p> <p>å¯ä»¥å…ˆè¯æ˜ï¼š\(\mathbb{E}\left[V\left(s_{t+1}\right) \mid s_t\right]=\mathbb{E}\left[\mathbb{E}\left[G_{t+1} \mid s_{t+1}\right] \mid s_t\right]=\mathbb{E}\left[G_{t+1} \mid s_t\right]\)ã€‚ä»¤\(s=s_t, g^{\prime}=G_{t+1}, s^{\prime}=s_{t+1}\)</p> \[\begin{aligned}\mathbb{E}\left[\mathbb{E}\left[G_{t+1} \mid s_{t+1}\right] \mid s_t\right] &amp; =\mathbb{E}\left[\mathbb{E}\left[g^{\prime} \mid s^{\prime}\right] \mid s\right] \\&amp; =\mathbb{E}\left[\sum_{g^{\prime}} g^{\prime} p\left(g^{\prime} \mid s^{\prime}\right) \mid s\right] \\&amp; =\sum_{s^{\prime}} \sum_{g^{\prime}} g^{\prime} p\left(g^{\prime} \mid s^{\prime}, s\right) p\left(s^{\prime} \mid s\right) \\&amp; =\sum_{s^{\prime}} \sum_{g^{\prime}} \frac{g^{\prime} p\left(g^{\prime} \mid s^{\prime}, s\right) p\left(s^{\prime} \mid s\right) p(s)}{p(s)} \\&amp; =\sum_{s^{\prime}} \sum_{g^{\prime}} \frac{g^{\prime} p\left(g^{\prime} \mid s^{\prime}, s\right) p\left(s^{\prime}, s\right)}{p(s)} \\&amp; =\sum_{s^{\prime}} \sum_{g^{\prime}} \frac{g^{\prime} p\left(g^{\prime}, s^{\prime}, s\right)}{p(s)} \\&amp; =\sum_{s^{\prime}} \sum_{g^{\prime}} g^{\prime} p\left(g^{\prime}, s^{\prime} \mid s\right) \\&amp; =\sum_{g^{\prime}} \sum_{s^{\prime}} g^{\prime} p\left(g^{\prime}, s^{\prime} \mid s\right) \\&amp; =\sum_{g^{\prime}} g^{\prime} p\left(g^{\prime} \mid s\right) \\&amp; =\mathbb{E}\left[g^{\prime} \mid s\right]=\mathbb{E}\left[G_{t+1} \mid s_t\right]\end{aligned}\] \[\begin{aligned}V(s) &amp; =\mathbb{E}\left[G_t \mid s_t=s\right] \\&amp; =\mathbb{E}\left[R_{t+1}+\gamma R_{t+2}+\gamma^2 R_{t+3}+\ldots \mid s_t=s\right] \\&amp; =\mathbb{E}\left[R_{t+1} \mid s_t=s\right]+\gamma \mathbb{E}\left[R_{t+2}+\gamma R_{t+3}+\gamma^2 R_{t+4}+\ldots \mid s_t=s\right] \\&amp; =R(s)+\gamma \mathbb{E}\left[G_{t+1} \mid s_t=s\right] \\&amp; =R(s)+\gamma \mathbb{E}\left[V\left(s_{t+1}\right) \mid s_t=s\right] \\&amp; =R(s)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s\right) V\left(s^{\prime}\right)\end{aligned}\] </li> </ul> <p>å¯ä»¥æŠŠè´å°”æ›¼æ–¹ç¨‹å†™æˆçŸ©é˜µçš„å½¢å¼ï¼š</p> \[\left(\begin{array}{c}V\left(s_1\right) \\V\left(s_2\right) \\\vdots \\V\left(s_N\right)\end{array}\right)=\left(\begin{array}{c}R\left(s_1\right) \\R\left(s_2\right) \\\vdots \\R\left(s_N\right)\end{array}\right)+\gamma\left(\begin{array}{cccc}p\left(s_1 \mid s_1\right) &amp; p\left(s_2 \mid s_1\right) &amp; \ldots &amp; p\left(s_N \mid s_1\right) \\p\left(s_1 \mid s_2\right) &amp; p\left(s_2 \mid s_2\right) &amp; \ldots &amp; p\left(s_N \mid s_2\right) \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\p\left(s_1 \mid s_N\right) &amp; p\left(s_2 \mid s_N\right) &amp; \ldots &amp; p\left(s_N \mid s_N\right)\end{array}\right)\left(\begin{array}{c}V\left(s_1\right) \\V\left(s_2\right) \\\vdots \\V\left(s_N\right)\end{array}\right)\] <p>æ¯ä¸€è¡Œæ¥çœ‹ï¼Œå‘é‡\(V\)ä¹˜çŠ¶æ€è½¬ç§»çŸ©é˜µé‡Œé¢çš„æŸä¸€è¡Œï¼Œå†åŠ ä¸Šå®ƒå½“å‰å¯ä»¥å¾—åˆ°çš„å¥–åŠ±ï¼Œå°±ä¼šå¾—åˆ°å®ƒå½“å‰çš„ä»·å€¼ã€‚å½“æˆ‘ä»¬æŠŠè´å°”æ›¼æ–¹ç¨‹å†™æˆçŸ©é˜µå½¢å¼åï¼Œå¯ä»¥ç›´æ¥æ±‚è§£ï¼š</p> \[\begin{aligned}&amp; \boldsymbol{V}=\boldsymbol{R}+\gamma \boldsymbol{P} \boldsymbol{V} \\&amp; \boldsymbol{V}=(\boldsymbol{I}-\gamma \boldsymbol{P})^{-1} \boldsymbol{R} \end{aligned}\] <p>ä½†æ˜¯æ±‚è§£å¤æ‚åº¦æ˜¯\(O(N^3)\)ã€‚æ±‚è§£ç®—æ³•æœ‰<strong>è’™ç‰¹å¡æ´›</strong>ã€<strong>åŠ¨æ€è§„åˆ’</strong>å’Œ<strong>æ—¶åºå·®åˆ†å­¦ä¹ </strong></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter2/Untitled-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter2/Untitled-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter2/Untitled-1400.webp"/> <img src="/assets/img/RL_chapter2/Untitled.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter2/Untitled%201-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter2/Untitled%201-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter2/Untitled%201-1400.webp"/> <img src="/assets/img/RL_chapter2/Untitled%201.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h1 id="ä¸‰é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹">ä¸‰ã€é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹</h1> <p>MDPå®šä¹‰</p> <ul> <li>\(S\) æœ‰é™çŠ¶æ€é›†</li> <li>\(A\) æœ‰é™åŠ¨ä½œé›†</li> <li>\(P^a\) åŠ¨ä½œè½¬ç§»æ¨¡å‹ï¼Œ\(P\left(s_{t+1}=s^{\prime} \mid s_t=s, a_t=a\right)\)</li> <li>\(R\) å¥–åŠ±å‡½æ•° \(R\left(s_t=s, a_t=a\right)=\mathbb{E}\left[r_t \mid s_t=s, a_t=a\right]\)</li> <li>æŠ˜æ‰£å› å­ \(\gamma \in[0,1]\)</li> <li>MDP æ˜¯ä¸€ä¸ªå…ƒç»„: \((S, A, P, R, \gamma)\)ã€‚</li> </ul> <h2 id="31-ç­–ç•¥">3.1 ç­–ç•¥</h2> <ol> <li> <p>ç­–ç•¥å®šä¹‰äº†åœ¨æŸä¸€ä¸ªçŠ¶æ€åº”è¯¥é‡‡å–ä»€ä¹ˆæ ·çš„åŠ¨ä½œã€‚çŸ¥é“å½“å‰çŠ¶æ€åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå½“å‰çŠ¶æ€ä»£å…¥ç­–ç•¥å‡½æ•°æ¥å¾—åˆ°ä¸€ä¸ªæ¦‚ç‡ï¼Œå³</p> \[\pi(a \mid s)=p\left(a_t=a \mid s_t=s\right)\] <p>æ¦‚ç‡ä»£è¡¨åœ¨æ‰€æœ‰å¯èƒ½çš„åŠ¨ä½œé‡Œé¢æ€æ ·é‡‡å–è¡ŒåŠ¨ï¼Œæ¯”å¦‚å¯èƒ½æœ‰ 0.7 çš„æ¦‚ç‡å¾€å·¦èµ°ï¼Œæœ‰ 0.3 çš„æ¦‚ç‡å¾€å³èµ°ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¦‚ç‡çš„è¡¨ç¤ºã€‚å¦å¤–ç­–ç•¥ä¹Ÿå¯èƒ½æ˜¯ç¡®å®šçš„ï¼Œå®ƒæœ‰å¯èƒ½ç›´æ¥è¾“å‡ºä¸€ä¸ªå€¼ï¼Œæˆ–è€…ç›´æ¥å‘Šè¯‰æˆ‘ä»¬å½“å‰åº”è¯¥é‡‡å–ä»€ä¹ˆæ ·çš„åŠ¨ä½œï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåŠ¨ä½œçš„æ¦‚ç‡ã€‚å‡è®¾æ¦‚ç‡å‡½æ•°æ˜¯å¹³ç¨³çš„ï¼ˆstationaryï¼‰ï¼Œä¸åŒæ—¶é—´ç‚¹ï¼Œæˆ‘ä»¬é‡‡å–çš„åŠ¨ä½œå…¶å®éƒ½æ˜¯åœ¨å¯¹ç­–ç•¥å‡½æ•°è¿›è¡Œé‡‡æ ·ã€‚</p> </li> <li> <p>å·²çŸ¥é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹å’Œç­–ç•¥Â \(\pi\) ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹è½¬æ¢æˆé©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹ã€‚åœ¨é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹é‡Œé¢ï¼ŒçŠ¶æ€è½¬ç§»å‡½\(P(sâ€²âˆ£s,a)\)Â åŸºäºå®ƒå½“å‰çš„çŠ¶æ€ä»¥åŠå®ƒå½“å‰çš„åŠ¨ä½œã€‚å› ä¸ºæˆ‘ä»¬ç°åœ¨å·²çŸ¥ç­–ç•¥å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å·²çŸ¥åœ¨æ¯ä¸€ä¸ªçŠ¶æ€ä¸‹ï¼Œå¯èƒ½é‡‡å–çš„åŠ¨ä½œçš„æ¦‚ç‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æŠŠåŠ¨ä½œè¿›è¡ŒåŠ å’Œï¼ŒmarginalizeÂ \(a\)ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¯¹äºé©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹çš„è½¬ç§»ï¼Œè¿™é‡Œå°±æ²¡æœ‰åŠ¨ä½œï¼Œ</p> \[P_\pi\left(s^{\prime} \mid s\right)=\sum_{a \in A} \pi(a \mid s) p\left(s^{\prime} \mid s, a\right)\] <p>å¯¹äºå¥–åŠ±å‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠåŠ¨ä½œå»æ‰ï¼Œè¿™æ ·å°±ä¼šå¾—åˆ°ç±»ä¼¼äºé©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹çš„å¥–åŠ±å‡½æ•°ï¼Œå³</p> \[r_\pi(s)=\sum_{a \in A} \pi(a \mid s) R(s, a)\] </li> </ol> <h2 id="32-åŒè¿‡ç¨‹å¥–åŠ±è¿‡ç¨‹çš„åŒºåˆ«">3.2 åŒè¿‡ç¨‹ã€å¥–åŠ±è¿‡ç¨‹çš„åŒºåˆ«</h2> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter2/Untitled%202-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter2/Untitled%202-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter2/Untitled%202-1400.webp"/> <img src="/assets/img/RL_chapter2/Untitled%202.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>é©¬å°”å¯å¤«è¿‡ç¨‹/é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹çš„çŠ¶æ€è½¬ç§»æ˜¯ç›´æ¥å†³å®šçš„ã€‚æ¯”å¦‚å½“å‰çŠ¶æ€æ˜¯\(s\)ï¼Œé‚£ä¹ˆç›´æ¥é€šè¿‡è½¬ç§»æ¦‚ç‡å†³å®šä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯ä»€ä¹ˆã€‚</li> <li>ä½†å¯¹äºé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼Œå®ƒçš„ä¸­é—´å¤šäº†ä¸€å±‚åŠ¨ä½œ\(a\), å³æ™ºèƒ½ä½“åœ¨å½“å‰çŠ¶æ€çš„æ—¶å€™ï¼Œé¦–å…ˆè¦å†³å®šé‡‡å–æŸä¸€ç§åŠ¨ä½œï¼Œè¿™æ ·æˆ‘ä»¬ä¼šåˆ°è¾¾æŸä¸€ä¸ªé»‘è‰²çš„èŠ‚ç‚¹ã€‚åˆ°è¾¾è¿™ä¸ªé»‘è‰²çš„èŠ‚ç‚¹åï¼Œå› ä¸ºæœ‰ä¸€å®šçš„ä¸ç¡®å®šæ€§ï¼Œæ‰€ä»¥å½“æ™ºèƒ½ä½“å½“å‰çŠ¶æ€ä»¥åŠæ™ºèƒ½ä½“å½“å‰é‡‡å–çš„åŠ¨ä½œå†³å®šè¿‡åï¼Œæ™ºèƒ½ä½“è¿›å…¥æœªæ¥çš„çŠ¶æ€å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒã€‚åœ¨å½“å‰çŠ¶æ€ä¸æœªæ¥çŠ¶æ€è½¬ç§»è¿‡ç¨‹ä¸­å¤šäº†ä¸€å±‚å†³ç­–æ€§ï¼Œè¿™æ˜¯é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¸ä¹‹å‰çš„é©¬å°”å¯å¤«è¿‡ç¨‹/é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹å¾ˆä¸åŒçš„ä¸€ç‚¹ã€‚åœ¨é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¸­ï¼ŒåŠ¨ä½œæ˜¯ç”±æ™ºèƒ½ä½“å†³å®šçš„ï¼Œæ™ºèƒ½ä½“ä¼šé‡‡å–åŠ¨ä½œæ¥å†³å®šæœªæ¥çš„çŠ¶æ€è½¬ç§»ã€‚</li> </ol> <h2 id="33-ä»·å€¼å‡½æ•°">3.3 ä»·å€¼å‡½æ•°</h2> <p>é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¸­çš„ä»·å€¼å‡½æ•°å¯å®šä¹‰ä¸º</p> \[V_\pi(s)=\mathbb{E}_\pi\left[G_t \mid s_t=s\right]\] <p>å…¶ä¸­ï¼ŒæœŸæœ›åŸºäºæˆ‘ä»¬é‡‡å–çš„ç­–ç•¥ã€‚å½“ç­–ç•¥å†³å®šåï¼Œæˆ‘ä»¬é€šè¿‡å¯¹ç­–ç•¥è¿›è¡Œé‡‡æ ·æ¥å¾—åˆ°ä¸€ä¸ªæœŸæœ›ï¼Œè®¡ç®—å‡ºå®ƒçš„ä»·å€¼å‡½æ•°ã€‚è¿™é‡Œæˆ‘ä»¬å¦å¤–å¼•å…¥äº†ä¸€ä¸ªÂ <strong>Q å‡½æ•°ï¼ˆQ-functionï¼‰</strong>ã€‚Q å‡½æ•°ä¹Ÿè¢«ç§°ä¸º<strong>åŠ¨ä½œä»·å€¼å‡½æ•°ï¼ˆaction-value functionï¼‰</strong>ã€‚Q å‡½æ•°å®šä¹‰çš„æ˜¯åœ¨æŸä¸€ä¸ªçŠ¶æ€é‡‡å–æŸä¸€ä¸ªåŠ¨ä½œï¼Œå®ƒæœ‰å¯èƒ½å¾—åˆ°çš„å›æŠ¥çš„ä¸€ä¸ªæœŸæœ›ï¼Œå³</p> \[Q_\pi(s, a)=\mathbb{E}_\pi\left[G_t \mid s_t=s, a_t=a\right]\] <p>è¿™é‡Œçš„æœŸæœ›å…¶å®ä¹Ÿæ˜¯åŸºäºç­–ç•¥å‡½æ•°çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ç­–ç•¥å‡½æ•°è¿›è¡Œä¸€ä¸ªåŠ å’Œï¼Œç„¶åå¾—åˆ°å®ƒçš„ä»·å€¼ã€‚ å¯¹ Q å‡½æ•°ä¸­çš„åŠ¨ä½œè¿›è¡ŒåŠ å’Œï¼Œå°±å¯ä»¥å¾—åˆ°ä»·å€¼å‡½æ•°ï¼š</p> \[V_\pi(s)=\sum_{a \in A} \pi(a \mid s) Q_\pi(s, a)\] <h2 id="34-è´å°”æ›¼æœŸæœ›æ–¹ç¨‹">3.4 è´å°”æ›¼æœŸæœ›æ–¹ç¨‹</h2> <p>æˆ‘ä»¬å¯ä»¥æŠŠçŠ¶æ€ä»·å€¼å‡½æ•°å’Œ Q å‡½æ•°æ‹†è§£æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šå³æ—¶å¥–åŠ±å’Œåç»­çŠ¶æ€çš„æŠ˜æ‰£ä»·å€¼ï¼ˆdiscounted value of successor stateï¼‰ã€‚ é€šè¿‡å¯¹ä»·å€¼å‡½æ•°è¿›è¡Œåˆ†è§£ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªç±»ä¼¼äºä¹‹å‰é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹çš„è´å°”æ›¼æ–¹ç¨‹â€”â€”â€”â€”<strong>è´å°”æ›¼æœŸæœ›æ–¹ç¨‹ï¼ˆBellman expectation equationï¼‰</strong></p> \[V_\pi(s)=\mathbb{E}_\pi\left[r_{t+1}+\gamma V_\pi\left(s_{t+1}\right) \mid s_t=s\right]\] \[V_\pi(s)=\sum_{a \in A} \pi(a \mid s)\left(R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) V_\pi\left(s^{\prime}\right)\right)\] <ul> <li> <p>æ¨å¯¼ï¼š</p> \[\begin{aligned}Q(s, a) &amp; =\mathbb{E}\left[G_t \mid s_t=s, a_t=a\right] \\&amp; =\mathbb{E}\left[r_{t+1}+\gamma r_{t+2}+\gamma^2 r_{t+3}+\ldots \mid s_t=s, a_t=a\right] \\&amp; =\mathbb{E}\left[r_{t+1} \mid s_t=s, a_t=a\right]+\gamma \mathbb{E}\left[r_{t+2}+\gamma r_{t+3}+\gamma^2 r_{t+4}+\ldots \mid s_t=s, a_t=a\right] \\&amp; =R(s, a)+\gamma \mathbb{E}\left[G_{t+1} \mid s_t=s, a_t=a\right] \\&amp; =R(s, a)+\gamma \mathbb{E}\left[V\left(s_{t+1}\right) \mid s_t=s, a_t=a\right] \\&amp; =R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) V\left(s^{\prime}\right)\end{aligned}\] </li> </ul> <p>å¯¹äº Q å‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åšç±»ä¼¼çš„åˆ†è§£ï¼Œå¾—åˆ° Q å‡½æ•°çš„è´å°”æ›¼æœŸæœ›æ–¹ç¨‹ï¼š</p> \[Q_\pi(s, a)=\mathbb{E}_\pi\left[r_{t+1}+\gamma Q_\pi\left(s_{t+1}, a_{t+1}\right) \mid s_t=s, a_t=a\right]\] \[Q_\pi(s, a)=R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) \sum_{a^{\prime} \in A} \pi\left(a^{\prime} \mid s^{\prime}\right) Q_\pi\left(s^{\prime}, a^{\prime}\right)\\=R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right)\textcolor{orange}{V_\pi (s')}\] <p>ğŸ’¡ è¿™é‡Œå¯ä»¥é€šè¿‡Vå‡½æ•°æ±‚å‡ºQå‡½æ•°ï¼</p> <h2 id="35-å¤‡ä»½å›¾">3.5 å¤‡ä»½å›¾</h2> <p>å¯¹äºæŸä¸€ä¸ªçŠ¶æ€ï¼Œå®ƒçš„å½“å‰ä»·å€¼æ˜¯ä¸å®ƒçš„æœªæ¥ä»·å€¼çº¿æ€§ç›¸å…³çš„ã€‚ æˆ‘ä»¬ç§°ä¸º<strong>å¤‡ä»½å›¾ï¼ˆbackup diagramï¼‰</strong>æˆ–å›æº¯å›¾ï¼Œå› ä¸ºå®ƒä»¬æ‰€ç¤ºçš„å…³ç³»æ„æˆäº†æ›´æ–°æˆ–å¤‡ä»½æ“ä½œçš„åŸºç¡€ï¼Œè€Œè¿™äº›æ“ä½œæ˜¯å¼ºåŒ–å­¦ä¹ æ–¹æ³•çš„æ ¸å¿ƒã€‚è¿™äº›æ“ä½œå°†ä»·å€¼ä¿¡æ¯ä»ä¸€ä¸ªçŠ¶æ€ï¼ˆæˆ–çŠ¶æ€-åŠ¨ä½œå¯¹ï¼‰çš„åç»§çŠ¶æ€ï¼ˆæˆ–çŠ¶æ€-åŠ¨ä½œå¯¹ï¼‰è½¬ç§»å›å®ƒã€‚ æ¯ä¸€ä¸ªç©ºå¿ƒåœ†åœˆä»£è¡¨ä¸€ä¸ªçŠ¶æ€ï¼Œæ¯ä¸€ä¸ªå®å¿ƒåœ†åœˆä»£è¡¨ä¸€ä¸ªçŠ¶æ€-åŠ¨ä½œå¯¹ã€‚</p> <ol> <li> <p>å¯¹äºV-functionï¼š</p> \[v_\pi(s)=\sum_{a \in A} \pi(a \mid s)\left(R(s, a)+\gamma \sum_{s^{\prime} \in S} P\left(s^{\prime} \mid s, a\right) v_\pi\left(s^{\prime}\right)\right)\] </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter2/Untitled%203-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter2/Untitled%203-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter2/Untitled%203-1400.webp"/> <img src="/assets/img/RL_chapter2/Untitled%203.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li> <p>å¯¹äºQ-function</p> \[q_\pi(s, a)=R(s, a)+\gamma \sum_{s^{\prime} \in S} P\left(s^{\prime} \mid s, a\right) \sum_{a^{\prime} \in A} \pi\left(a^{\prime} \mid s^{\prime}\right) q_\pi\left(s^{\prime}, a^{\prime}\right)\] </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter2/Untitled%204-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter2/Untitled%204-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter2/Untitled%204-1400.webp"/> <img src="/assets/img/RL_chapter2/Untitled%204.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="36-ç­–ç•¥è¯„ä¼°">3.6 ç­–ç•¥è¯„ä¼°</h2> <p>å·²çŸ¥é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä»¥åŠè¦é‡‡å–çš„ç­–ç•¥\(\pi\)ï¼Œè®¡ç®—ä»·å€¼å‡½æ•°\(V_\pi(s)\)çš„è¿‡ç¨‹å°±æ˜¯<strong>ç­–ç•¥è¯„ä¼°ï¼ˆä»·å€¼é¢„æµ‹ï¼‰</strong>ã€‚ä¹Ÿå°±æ˜¯é¢„æµ‹æˆ‘ä»¬å½“å‰é‡‡å–çš„ç­–ç•¥æœ€ç»ˆä¼šäº§ç”Ÿå¤šå°‘ä»·å€¼ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡è´å°”æ›¼æœŸæœ›æ–¹ç¨‹æ¥å¾—åˆ°ä»·å€¼å‡½æ•°ï¼š</p> \[V^\pi_t(s)=R_\pi(s)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, \pi(s)\right) V^\pi_{t-1}\left(s^{\prime}\right)\] <p>æˆ‘ä»¬å¯ä»¥ä¸åœç”¨è´å°”æ›¼æœŸæœ›æ–¹ç¨‹è¿­ä»£ï¼Œæœ€åä»·å€¼å‡½æ•°ä¼šæ”¶æ•›ã€‚æ”¶æ•›ä¹‹åï¼Œä»·å€¼å‡½æ•°çš„å€¼å°±æ˜¯æ¯ä¸€ä¸ªçŠ¶æ€çš„ä»·å€¼ã€‚</p> <h2 id="37-é¢„æµ‹å’Œæ§åˆ¶">3.7 é¢„æµ‹å’Œæ§åˆ¶</h2> <p>é¢„æµ‹ (prediction) å’Œæ§åˆ¶ (control) æ˜¯é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹é‡Œé¢çš„æ ¸å¿ƒé—®é¢˜ã€‚</p> <ol> <li><strong>é¢„æµ‹</strong>ï¼ˆè¯„ä¼°ä¸€ä¸ªç»™å®šçš„ç­–ç•¥) : é¢„æµ‹æ˜¯æŒ‡ç»™å®šä¸€ä¸ªé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä»¥åŠä¸€ä¸ªç­–ç•¥ \(\pi\) ï¼Œè®¡ç®—å®ƒçš„<strong>ä»·å€¼å‡½æ•°</strong>ï¼Œä¹Ÿå°±æ˜¯<strong>è®¡ç®—æ¯ä¸ªçŠ¶æ€çš„ä»·å€¼</strong>ã€‚ <ol> <li>è¾“å…¥æ˜¯é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ \(&lt;S, A, P, R, \gamma&gt;\) å’Œç­–ç•¥ \(\pi\) ï¼Œ</li> <li>è¾“å‡ºæ˜¯ä»·å€¼å‡½æ•° \(V_\pi\) ã€‚</li> </ol> </li> <li><strong>æ§åˆ¶</strong> (æœç´¢æœ€ä½³ç­–ç•¥) : æ§åˆ¶å°±æ˜¯æˆ‘ä»¬å»<strong>å¯»æ‰¾ä¸€ä¸ªæœ€ä½³çš„ç­–ç•¥</strong>ï¼Œç„¶ååŒæ—¶<strong>è¾“å‡ºå®ƒçš„æœ€ä½³ä»·å€¼å‡½æ•°</strong>ä»¥åŠæœ€<strong>ä½³ç­–ç•¥</strong>ã€‚ <ol> <li>è¾“å…¥æ˜¯é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ \(&lt;S, A, P, R, \gamma&gt;\) ï¼Œ</li> <li>è¾“å‡ºæ˜¯<strong>æœ€ä½³ä»·å€¼å‡½æ•°</strong> (optimal value function) \(V^*\)å’Œ<strong>æœ€ä½³ç­–ç•¥</strong> (optimal policyï¼‰ <em>\(\pi^*\)</em> ã€‚</li> </ol> </li> </ol> <p>ğŸ˜ åœ¨é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹é‡Œé¢ï¼Œé¢„æµ‹å’Œæ§åˆ¶éƒ½å¯ä»¥é€šè¿‡åŠ¨æ€è§„åˆ’è§£å†³ã€‚è¦å¼ºè°ƒçš„æ˜¯ï¼Œè¿™ä¸¤è€…çš„åŒºåˆ«å°±åœ¨äºï¼Œé¢„æµ‹é—®é¢˜æ˜¯ç»™å®šä¸€ä¸ªç­–ç•¥ï¼Œæˆ‘ä»¬è¦ç¡®å®šå®ƒçš„ä»·å€¼å‡½æ•°æ˜¯å¤šå°‘ã€‚è€Œæ§åˆ¶é—®é¢˜æ˜¯åœ¨æ²¡æœ‰ç­–ç•¥çš„å‰æä¸‹ï¼Œæˆ‘ä»¬è¦ç¡®å®šæœ€ä½³çš„ä»·å€¼å‡½æ•°ä»¥åŠå¯¹åº”çš„å†³ç­–æ–¹æ¡ˆã€‚å®é™…ä¸Šï¼Œè¿™ä¸¤è€…æ˜¯é€’è¿›çš„å…³ç³»ï¼Œåœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬<strong>é€šè¿‡è§£å†³é¢„æµ‹é—®é¢˜ï¼Œè¿›è€Œè§£å†³æ§åˆ¶é—®é¢˜</strong>ã€‚</p> <h2 id="38-é¢„æµ‹ç­–ç•¥è¯„ä¼°">3.8 é¢„æµ‹ï¼ˆç­–ç•¥è¯„ä¼°ï¼‰</h2> <p>ç­–ç•¥è¯„ä¼°å°±æ˜¯ç»™å®šé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹å’Œç­–ç•¥ï¼Œè¯„ä¼°æˆ‘ä»¬å¯ä»¥è·å¾—å¤šå°‘ä»·å€¼ï¼Œå³å¯¹äºå½“å‰ç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¤šå¤§çš„ä»·å€¼ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠ<strong>è´å°”æ›¼æœŸæœ›å¤‡ä»½ï¼ˆBellman expectation backupï¼‰</strong>Â ï¼Œå˜æˆè¿­ä»£çš„è¿‡ç¨‹ï¼Œåå¤è¿­ä»£ç›´åˆ°æ”¶æ•›ã€‚è¿™ä¸ªè¿­ä»£è¿‡ç¨‹å¯ä»¥çœ‹ä½œ<strong>åŒæ­¥å¤‡ä»½ï¼ˆsynchronous backupï¼‰</strong>Â çš„è¿‡ç¨‹ã€‚</p> \[V_{t+1}(s)=\sum_{a \in A} \pi(a \mid s)\left(R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) V_t\left(s^{\prime}\right)\right)\] <p>ç­–ç•¥è¯„ä¼°çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯æŠŠå¦‚å¼æ‰€ç¤ºçš„è´å°”æ›¼æœŸæœ›å¤‡ä»½åå¤è¿­ä»£ï¼Œç„¶åå¾—åˆ°ä¸€ä¸ªæ”¶æ•›çš„ä»·å€¼å‡½æ•°çš„å€¼ã€‚å› ä¸ºå·²ç»ç»™å®šäº†<strong>ç­–ç•¥å‡½æ•°</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠå®ƒç®€åŒ–æˆä¸€ä¸ª<strong>é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹</strong>çš„è¡¨è¾¾å½¢å¼ï¼Œç›¸å½“äºæŠŠ\(a\)å»æ‰ï¼Œå³</p> \[V_{t+1}(s)=r_\pi(s)+\gamma p_\pi\left(s^{\prime} \mid s\right) V_t\left(s^{\prime}\right)\] <h2 id="39-æ§åˆ¶">3.9 æ§åˆ¶</h2> <p>ç­–ç•¥è¯„ä¼°æ˜¯æŒ‡ç»™å®šé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹å’Œç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥ä¼°ç®—å‡ºä»·å€¼å‡½æ•°çš„å€¼ã€‚å¦‚æœæˆ‘ä»¬åªæœ‰é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼Œé‚£ä¹ˆåº”è¯¥å¦‚ä½•å¯»æ‰¾æœ€ä½³çš„ç­–ç•¥ï¼Œä»è€Œå¾—åˆ°<strong>æœ€ä½³ä»·å€¼å‡½æ•°ï¼ˆoptimal value functionï¼‰</strong>å‘¢ï¼Ÿ</p> <p>æœ€ä½³ä»·å€¼å‡½æ•°çš„å®šä¹‰ä¸ºï¼š</p> \[V^*(s)=\max _\pi V_\pi(s)\] \[\pi^*(s)=\underset{\pi}{\arg \max } V_\pi(s)\] <p>å½“å–å¾—æœ€ä½³ä»·å€¼å‡½æ•°åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹ \(Q\) å‡½æ•°è¿›è¡Œæœ€å¤§åŒ–æ¥å¾—åˆ°æœ€ä½³ç­–ç•¥ï¼ˆè¿™é‡Œæ˜¯deterministicçš„ï¼ï¼‰ï¼š</p> \[\pi^*(a \mid s)= \begin{cases}1, &amp; a=\underset{a \in A}{\arg \max } Q^*(s, a) \\ 0, &amp; \text { å…¶ä»– }\end{cases}\] <p>å½“\(Q\)å‡½æ•°æ”¶æ•›åï¼Œå› ä¸º\(Q\)å‡½æ•°æ˜¯å…³äºçŠ¶æ€ä¸åŠ¨ä½œçš„å‡½æ•°ï¼Œæ‰€ä»¥å¦‚æœåœ¨æŸä¸ªçŠ¶æ€é‡‡å–æŸä¸ªåŠ¨ä½œï¼Œå¯ä»¥ä½¿å¾—\(Q\)å‡½æ•°æœ€å¤§åŒ–ï¼Œé‚£ä¹ˆè¿™ä¸ªåŠ¨ä½œå°±æ˜¯æœ€ä½³çš„åŠ¨ä½œã€‚å¦‚æœæˆ‘ä»¬èƒ½ä¼˜åŒ–å‡ºä¸€ä¸ª \(Q\) å‡½æ•°\(Q^*(s,a)\)ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨\(Q\)å‡½æ•°ä¸­å–ä¸€ä¸ªè®©\(Q\)å‡½æ•°å€¼æœ€å¤§åŒ–çš„åŠ¨ä½œçš„å€¼ï¼Œå°±å¯ä»¥æå–å‡ºæœ€ä½³ç­–ç•¥ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç­–ç•¥è¿­ä»£å’Œä»·å€¼è¿­ä»£æ¥è§£å†³é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„æ§åˆ¶é—®é¢˜ã€‚</p> <h2 id="310-ç­–ç•¥è¿­ä»£">3.10 ç­–ç•¥è¿­ä»£</h2> <ol> <li>ç­–ç•¥è¿­ä»£ç”±ä¸¤ä¸ªæ­¥éª¤ç»„æˆï¼š<strong>ç­–ç•¥è¯„ä¼°</strong>å’Œ<strong>ç­–ç•¥æ”¹è¿›</strong>ï¼ˆpolicy improvementï¼‰ã€‚ <ol> <li>ç­–ç•¥è¯„ä¼°ï¼šå½“å‰æˆ‘ä»¬åœ¨ä¼˜åŒ–ç­–ç•¥\(\pi\)ï¼Œåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­å¾—åˆ°ä¸€ä¸ªæœ€æ–°çš„ç­–ç•¥ã€‚æˆ‘ä»¬å…ˆä¿è¯è¿™ä¸ªç­–ç•¥ä¸å˜ï¼Œç„¶åä¼°è®¡å®ƒçš„ä»·å€¼ï¼Œå³ç»™å®šå½“å‰çš„ç­–ç•¥å‡½æ•°æ¥ä¼°è®¡çŠ¶æ€ä»·å€¼å‡½æ•°ã€‚ é€šè¿‡<strong>è´å°”æ›¼æœŸæœ›æ–¹ç¨‹</strong>è¿­ä»£ï¼Œå¾—åˆ°ä»·å€¼å‡½æ•°\(V_{\pi_i}\)ã€‚</li> <li> <p>ç­–ç•¥æ”¹è¿›ï¼šå¾—åˆ°ä»·å€¼å‡½æ•°åï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ¨ç®—å‡ºå®ƒçš„ \(Q\) å‡½æ•°ã€‚å¾—åˆ° \(Q\) å‡½æ•°åï¼Œæˆ‘ä»¬ç›´æ¥å¯¹ \(Q\) å‡½æ•°è¿›è¡Œæœ€å¤§åŒ–ï¼Œé€šè¿‡åœ¨ \(Q\) å‡½æ•°åšä¸€ä¸ªè´ªå¿ƒçš„æœç´¢æ¥è¿›ä¸€æ­¥æ”¹è¿›ç­–ç•¥ã€‚è¿™ä¸¤ä¸ªæ­¥éª¤ä¸€ç›´åœ¨è¿­ä»£è¿›è¡Œã€‚åœ¨ç­–ç•¥è¿­ä»£é‡Œé¢ï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåˆå§‹åŒ–çš„çŠ¶æ€ä»·å€¼å‡½æ•°\(V\)å’Œç­–ç•¥\(\pi\)ï¼Œç„¶ååœ¨è¿™ä¸¤ä¸ªæ­¥éª¤ä¹‹é—´è¿­ä»£ã€‚</p> \[Q_{\pi_i}(s, a)=R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) V_{\pi_i}\left(s^{\prime}\right)\] <p>å¯¹äºæ¯ä¸ªçŠ¶æ€ï¼Œç­–ç•¥æ”¹è¿›ä¼šå¾—åˆ°å®ƒçš„æ–°ä¸€è½®çš„ç­–ç•¥ï¼Œå¯¹äºæ¯ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬å–ä½¿å®ƒå¾—åˆ°æœ€å¤§å€¼çš„åŠ¨ä½œï¼Œå³</p> \[\pi_{i+1}(s)=\underset{a}{\arg \max } Q_{\pi_i}(s, a)\] </li> </ol> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter2/Untitled%205-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter2/Untitled%205-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter2/Untitled%205-1400.webp"/> <img src="/assets/img/RL_chapter2/Untitled%205.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>ä¸Šé¢çš„çº¿å°±æ˜¯æˆ‘ä»¬å½“å‰çŠ¶æ€ä»·å€¼å‡½æ•°çš„å€¼ï¼Œä¸‹é¢çš„çº¿æ˜¯ç­–ç•¥çš„å€¼ã€‚ ç­–ç•¥è¿­ä»£çš„è¿‡ç¨‹ä¸è¸¢çš®çƒä¸€æ ·ã€‚æˆ‘ä»¬å…ˆç»™å®šå½“å‰å·²æœ‰çš„ç­–ç•¥å‡½æ•°ï¼Œè®¡ç®—å®ƒçš„çŠ¶æ€ä»·å€¼å‡½æ•°ã€‚ç®—å‡ºçŠ¶æ€ä»·å€¼å‡½æ•°åï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ª Q å‡½æ•°ã€‚æˆ‘ä»¬å¯¹Q å‡½æ•°é‡‡å–è´ªå¿ƒçš„ç­–ç•¥ï¼Œè¿™æ ·å°±åƒè¸¢çš®çƒï¼Œâ€œè¸¢â€å›ç­–ç•¥ã€‚ç„¶åè¿›ä¸€æ­¥æ”¹è¿›ç­–ç•¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ”¹è¿›çš„ç­–ç•¥åï¼Œå®ƒè¿˜ä¸æ˜¯æœ€ä½³çš„ç­–ç•¥ï¼Œæˆ‘ä»¬å†è¿›è¡Œç­–ç•¥è¯„ä¼°ï¼Œåˆä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„ä»·å€¼å‡½æ•°ã€‚åŸºäºè¿™ä¸ªæ–°çš„ä»·å€¼å‡½æ•°å†è¿›è¡Œ Q å‡½æ•°çš„æœ€å¤§åŒ–ï¼Œè¿™æ ·é€æ¸è¿­ä»£ï¼ŒçŠ¶æ€ä»·å€¼å‡½æ•°å’Œç­–ç•¥å°±ä¼šæ”¶æ•›ã€‚</p> <ol> <li> <p>è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹: å½“æˆ‘ä»¬ä¸€ç›´é‡‡å– argmax æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªå•è°ƒçš„é€’å¢ã€‚é€šè¿‡é‡‡å–è¿™ç§è´ªå¿ƒæ“ä½œï¼ˆargmax æ“ä½œï¼‰ï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°æ›´å¥½çš„æˆ–è€…ä¸å˜çš„ç­–ç•¥ï¼Œè€Œä¸ä¼šä½¿ä»·å€¼å‡½æ•°å˜å·®ã€‚æ‰€ä»¥å½“æ”¹è¿›åœæ­¢åï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°ä¸€ä¸ªæœ€ä½³ç­–ç•¥ã€‚å½“æ”¹è¿›åœæ­¢åï¼Œæˆ‘ä»¬å–è®© Q å‡½æ•°å€¼æœ€å¤§åŒ–çš„åŠ¨ä½œï¼ŒQ å‡½æ•°å°±ä¼šç›´æ¥å˜æˆä»·å€¼å‡½æ•°ï¼Œå³</p> \[Q_\pi\left(s, \pi^{\prime}(s)\right)=\max _{a \in A} Q_\pi(s, a)=Q_\pi(s, \pi(s))=V_\pi(s)\] \[V_\pi(s)=\max _{a \in A} Q_\pi(s, a)\] <p>ğŸ’¡ è¿™é‡Œå› ä¸º\(V_\pi(s)=\sum_{a \in A} \pi(a \mid s) Q_\pi(s, a)\)ï¼Œè€Œ\(\pi(a \mid s)\)æ˜¯åªæœ‰\(a=\pi^*(s)\)ä¸º1</p> <p>è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹è¡¨æ˜ï¼šæœ€ä½³ç­–ç•¥ä¸‹çš„ä¸€ä¸ªçŠ¶æ€çš„ä»·å€¼å¿…é¡»ç­‰äºåœ¨è¿™ä¸ªçŠ¶æ€ä¸‹é‡‡å–æœ€å¥½åŠ¨ä½œå¾—åˆ°çš„å›æŠ¥çš„æœŸæœ›ã€‚ å½“é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹æ»¡è¶³è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹çš„æ—¶å€™ï¼Œæ•´ä¸ªé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹å·²ç»è¾¾åˆ°æœ€ä½³çš„çŠ¶æ€ã€‚</p> <p>åªæœ‰å½“æ•´ä¸ªçŠ¶æ€å·²ç»æ”¶æ•›åï¼Œæˆ‘ä»¬å¾—åˆ°æœ€ä½³ä»·å€¼å‡½æ•°åï¼Œè´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹æ‰ä¼šæ»¡è¶³ã€‚æ»¡è¶³è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹åï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æœ€å¤§åŒ–æ“ä½œï¼Œå³</p> \[\begin{aligned} Q^*(s, a) &amp; =R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) V^*\left(s^{\prime}\right) \\ &amp; =R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) \max _a Q^*\left(s^{\prime}, a^{\prime}\right) \end{aligned}\] </li> </ol> <h2 id="311-ä»·å€¼è¿­ä»£">3.11 ä»·å€¼è¿­ä»£</h2> <ol> <li> <p>æœ€ä¼˜æ€§åŸç†</p> <p>æˆ‘ä»¬ä»å¦ä¸€ä¸ªè§’åº¦æ€è€ƒé—®é¢˜ï¼ŒåŠ¨æ€è§„åˆ’çš„æ–¹æ³•å°†ä¼˜åŒ–é—®é¢˜åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ã€‚ç¬¬ä¸€æ­¥æ‰§è¡Œçš„æ˜¯æœ€ä¼˜çš„åŠ¨ä½œã€‚ä¹‹ååç»§çš„çŠ¶æ€çš„æ¯ä¸€æ­¥éƒ½æŒ‰ç…§æœ€ä¼˜çš„ç­–ç•¥å»åšï¼Œæœ€åçš„ç»“æœå°±æ˜¯æœ€ä¼˜çš„ã€‚</p> </li> <li>æœ€ä¼˜æ€§åŸç†å®šç†ï¼ˆprinciple of optimality theoremï¼‰ï¼š ä¸€ä¸ªç­–ç•¥\(Ï€(aâˆ£s)\)Â åœ¨çŠ¶æ€Â \(s\)Â è¾¾åˆ°äº†æœ€ä¼˜ä»·å€¼ï¼Œä¹Ÿå°±æ˜¯Â \(V^Ï€(s)=V^âˆ—(s)\) æˆç«‹ï¼Œå½“ä¸”ä»…å½“å¯¹äºä»»ä½•èƒ½å¤Ÿä»Â \(s\)Â åˆ°è¾¾çš„Â \(s'\)ï¼Œéƒ½å·²ç»è¾¾åˆ°äº†æœ€ä¼˜ä»·å€¼ã€‚ä¹Ÿå°±æ˜¯å¯¹äºæ‰€æœ‰çš„\(s'\)ï¼Œ\(V^Ï€(s')=V^âˆ—(s')\) Â æ’æˆç«‹ã€‚</li> <li> <p>ç¡®è®¤æ€§ä»·å€¼è¿­ä»£</p> <p>å¦‚æœæˆ‘ä»¬çŸ¥é“å­é—®é¢˜Â \(V^âˆ—(s')\) çš„æœ€ä¼˜è§£ï¼Œå°±å¯ä»¥é€šè¿‡ä»·å€¼è¿­ä»£æ¥å¾—åˆ°æœ€ä¼˜çš„\(V^âˆ—(s)\)çš„è§£ã€‚ä»·å€¼è¿­ä»£å°±æ˜¯æŠŠè´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹å½“æˆä¸€ä¸ªæ›´æ–°è§„åˆ™æ¥è¿›è¡Œï¼Œå³</p> \[V(s) \leftarrow \max _{a \in A}\left(R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) V\left(s^{\prime}\right)\right)\] <p>åªæœ‰å½“æ•´ä¸ªé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹å·²ç»è¾¾åˆ°æœ€ä½³çš„çŠ¶æ€æ—¶ï¼Œå¼æ‰æ»¡è¶³ã€‚ä½†æˆ‘ä»¬å¯ä»¥æŠŠå®ƒè½¬æ¢æˆä¸€ä¸ªå¤‡ä»½çš„ç­‰å¼ã€‚å¤‡ä»½çš„ç­‰å¼å°±æ˜¯ä¸€ä¸ªè¿­ä»£çš„ç­‰å¼ã€‚æˆ‘ä»¬ä¸åœåœ°è¿­ä»£è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹ï¼Œä»·å€¼å‡½æ•°å°±èƒ½é€æ¸è¶‹å‘äºæœ€ä½³çš„ä»·å€¼å‡½æ•°ï¼Œè¿™æ˜¯ä»·å€¼è¿­ä»£ç®—æ³•çš„ç²¾é«“ã€‚</p> <p>ä¸ºäº†å¾—åˆ°æœ€ä½³çš„\(V^*\)Â ï¼Œå¯¹äºæ¯ä¸ªçŠ¶æ€çš„Â \(V\)ï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹è¿›è¡Œè¿­ä»£ï¼Œè¿­ä»£å¤šæ¬¡ä¹‹åï¼Œä»·å€¼å‡½æ•°å°±ä¼šæ”¶æ•›ã€‚è¿™ç§ä»·å€¼è¿­ä»£ç®—æ³•ä¹Ÿè¢«ç§°ä¸º<strong>ç¡®è®¤æ€§ä»·å€¼è¿­ä»£</strong>ï¼ˆdeterministic value iterationï¼‰ã€‚</p> </li> <li>å…·ä½“ç®—æ³•ï¼šä»·å€¼è¿­ä»£ç®—æ³•çš„è¿‡ç¨‹å¦‚ä¸‹ã€‚ <ul> <li>åˆå§‹åŒ–: ä»¤ \(k=1\)ï¼Œå¯¹äºæ‰€æœ‰çŠ¶æ€ \(s ï¼Œ V_0(s)=0\) ã€‚</li> <li>å¯¹äº \(k=1: H\) ( \(H\) æ˜¯è®© \(V(s)\) æ”¶æ•›æ‰€éœ€çš„è¿­ä»£æ¬¡æ•°) <ul> <li> <p>å¯¹äºæ‰€æœ‰çŠ¶æ€ \(s\)</p> \[\begin{gathered} Q_{k+1}(s, a)=R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) V_k\left(s^{\prime}\right) \\ V_{k+1}(s)=\max_a Q_{k+1}(s, a) \end{gathered}\] </li> <li> \[k \leftarrow k+1\] </li> </ul> </li> <li> <p>åœ¨è¿­ä»£åæå–æœ€ä¼˜ç­–ç•¥:</p> \[\pi(s)=\underset{a}{\arg \max }\left[R(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime} \mid s, a\right) V_{H+1}\left(s^{\prime}\right)\right]\] </li> </ul> </li> </ol> <h2 id="312-å¯¹æ¯”ç­–ç•¥è¿­ä»£å’Œä»·å€¼è¿­ä»£">3.12 å¯¹æ¯”ç­–ç•¥è¿­ä»£å’Œä»·å€¼è¿­ä»£</h2> <p>è¿™ä¸¤ä¸ªç®—æ³•éƒ½å¯ä»¥è§£é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„æ§åˆ¶é—®é¢˜ã€‚</p> <ol> <li>ç­–ç•¥è¿­ä»£åˆ†ä¸¤æ­¥ã€‚ <ol> <li>é¦–å…ˆè¿›è¡Œç­–ç•¥è¯„ä¼°ï¼Œå³å¯¹å½“å‰å·²ç»æœç´¢åˆ°çš„ç­–ç•¥å‡½æ•°è¿›è¡Œä¼°å€¼ï¼Œé€šè¿‡è¿­ä»£è®¡ç®—å‡ºä»·å€¼å‡½æ•°\(V\)</li> <li>å¾—åˆ°ä¼°å€¼åï¼Œæˆ‘ä»¬è¿›è¡Œç­–ç•¥æ”¹è¿›ï¼Œå³æŠŠ \(Q\) å‡½æ•°ç®—å‡ºæ¥ï¼Œè¿›è¡Œè¿›ä¸€æ­¥æ”¹è¿›ã€‚ä¸æ–­é‡å¤è¿™ä¸¤æ­¥ï¼Œç›´åˆ°ç­–ç•¥æ”¶æ•›ã€‚</li> </ol> </li> <li>ä»·å€¼è¿­ä»£ç›´æ¥ä½¿ç”¨<strong>è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹</strong>è¿›è¡Œè¿­ä»£ï¼Œä»è€Œå¯»æ‰¾æœ€ä½³çš„ä»·å€¼å‡½æ•°ã€‚æ‰¾åˆ°æœ€ä½³ä»·å€¼å‡½æ•°åï¼Œæˆ‘ä»¬å†æå–ä¸€æ¬¡æœ€ä½³ç­–ç•¥ï¼ˆä¸€æ—¦ä»·å€¼å‡½æ•°æ˜¯æœ€ä¼˜çš„ï¼Œç­–ç•¥ä¹Ÿæ˜¯æœ€ä¼˜çš„ï¼‰ã€‚</li> </ol> <h2 id="313-æ€»ç»“">3.13 æ€»ç»“</h2> <table> <thead> <tr> <th>é—®é¢˜</th> <th>è´å°”æ›¼æ–¹ç¨‹</th> <th>ç®—æ³•</th> </tr> </thead> <tbody> <tr> <td>é¢„æµ‹</td> <td>è´å°”æ›¼æœŸæœ›æ–¹ç¨‹</td> <td>ç­–ç•¥è¯„ä¼°</td> </tr> <tr> <td>æ§åˆ¶</td> <td>è´å°”æ›¼æœŸæœ›æ–¹ç¨‹</td> <td>ç­–ç•¥è¿­ä»£</td> </tr> <tr> <td>æ§åˆ¶</td> <td>è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹</td> <td>ä»·å€¼è¿­ä»£</td> </tr> </tbody> </table>]]></content><author><name></name></author><category term="Reinforcement-Learning"/><category term="intro"/><summary type="html"><![CDATA[MDP]]></summary></entry><entry><title type="html">ç¬¬ä¸€ç«  Overview (è¯¾ç¨‹æ¦‚æ‹¬ä¸RLåŸºç¡€)</title><link href="https://gszfwsb.github.io/blog/2023/RL-lecture1/" rel="alternate" type="text/html" title="ç¬¬ä¸€ç«  Overview (è¯¾ç¨‹æ¦‚æ‹¬ä¸RLåŸºç¡€)"/><published>2023-10-26T00:00:00+00:00</published><updated>2023-10-26T00:00:00+00:00</updated><id>https://gszfwsb.github.io/blog/2023/RL-lecture1</id><content type="html" xml:base="https://gszfwsb.github.io/blog/2023/RL-lecture1/"><![CDATA[<h1 id="ä¸€å¼ºåŒ–å­¦ä¹ æ¦‚è¿°">ä¸€ã€å¼ºåŒ–å­¦ä¹ æ¦‚è¿°</h1> <p>ä»€ä¹ˆæ˜¯å¼ºåŒ–å­¦ä¹ ï¼šå¼ºåŒ–å­¦ä¹  (reinforcement learning, RL) è®¨è®ºçš„é—®é¢˜æ˜¯<strong>æ™ºèƒ½ä½“ (agent)</strong> æ€ä¹ˆåœ¨å¤æ‚ã€ä¸ç¡®å®šçš„<strong>ç¯å¢ƒ</strong> (environment) é‡Œé¢å»æœ€å¤§åŒ–å®ƒèƒ½è·å¾—çš„<strong>å¥–åŠ±</strong>ã€‚å¦‚å›¾æ‰€ç¤º, å¼ºåŒ–å­¦ä¹ ç”±ä¸¤éƒ¨åˆ†ç»„æˆ: æ™ºèƒ½ä½“å’Œç¯å¢ƒã€‚åœ¨å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ä¸­, æ™ºèƒ½ä½“ä¸ç¯å¢ƒä¸€ç›´åœ¨äº¤äº’ï¼š</p> <ol> <li>æ™ºèƒ½ä½“åœ¨ç¯å¢ƒé‡Œé¢è·å–æŸä¸ªçŠ¶æ€å, å®ƒä¼šåˆ©ç”¨è¯¥çŠ¶æ€è¾“å‡º ä¸€ä¸ª<strong>åŠ¨ä½œ</strong> (action), è¿™ä¸ªåŠ¨ä½œä¹Ÿç§°ä¸º<strong>å†³ç­–</strong>(decision)ã€‚</li> <li>ç„¶åè¿™ä¸ªåŠ¨ä½œä¼šåœ¨<strong>ç¯å¢ƒ</strong>ä¹‹ä¸­è¢«æ‰§è¡Œ, ç¯å¢ƒä¼šæ ¹æ®æ™ºèƒ½ä½“é‡‡å–çš„åŠ¨ä½œ, è¾“å‡ºä¸‹ä¸€ä¸ª<strong>çŠ¶æ€</strong>ä»¥åŠå½“å‰è¿™ä¸ªåŠ¨ä½œå¸¦æ¥çš„<strong>å¥–åŠ±</strong>ã€‚æ™ºèƒ½ä½“çš„ç›®çš„å°±æ˜¯å°½å¯èƒ½å¤šåœ°ä»ç¯å¢ƒä¸­è·å–å¥–åŠ±ã€‚</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter1/Untitled-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter1/Untitled-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter1/Untitled-1400.webp"/> <img src="/assets/img/RL_chapter1/Untitled.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="11-å¼ºåŒ–å­¦ä¹ ä¸ç›‘ç£å­¦ä¹ ">1.1 å¼ºåŒ–å­¦ä¹ ä¸ç›‘ç£å­¦ä¹ </h2> <ol> <li>ç›‘ç£å­¦ä¹ ï¼šç›‘ç£å­¦ä¹ ï¼ˆsupervised learningï¼‰é¦–å…ˆå‡è®¾æˆ‘ä»¬æœ‰å¤§é‡è¢«æ ‡æ³¨çš„æ•°æ®ï¼Œè¿™äº›å›¾ç‰‡éƒ½è¦æ»¡è¶³<strong>ç‹¬ç«‹åŒåˆ†å¸ƒ</strong>ï¼Œå³å®ƒä»¬ä¹‹é—´æ˜¯æ²¡æœ‰å…³è”å…³ç³»çš„ã€‚æ‰€ä»¥åœ¨ç›‘ç£å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸¤ä¸ªå‡è®¾ã€‚ <ol> <li>è¾“å…¥çš„æ•°æ®ï¼ˆæ ‡æ³¨çš„æ•°æ®ï¼‰éƒ½åº”æ˜¯æ²¡æœ‰å…³è”çš„ã€‚å› ä¸ºå¦‚æœè¾“å…¥çš„æ•°æ®æœ‰å…³è”ï¼Œå­¦ä¹ å™¨ï¼ˆlearnerï¼‰æ˜¯ä¸å¥½å­¦ä¹ çš„ï¼›</li> <li>æˆ‘ä»¬å‘Šè¯‰å­¦ä¹ å™¨æ­£ç¡®çš„æ ‡ç­¾æ˜¯ä»€ä¹ˆï¼Œè¿™æ ·å®ƒå¯ä»¥é€šè¿‡æ­£ç¡®çš„æ ‡ç­¾æ¥ä¿®æ­£è‡ªå·±çš„é¢„æµ‹ã€‚</li> </ol> </li> <li>åœ¨å¼ºåŒ–å­¦ä¹ é‡Œé¢ï¼Œç›‘ç£å­¦ä¹ çš„ä¸¤ä¸ªå‡è®¾å…¶å®éƒ½ä¸æ»¡è¶³ã€‚ <ol> <li>æ™ºèƒ½ä½“å¾—åˆ°çš„è§‚æµ‹ï¼ˆobservationï¼‰ä¸æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„ï¼Œä¸Šä¸€å¸§ä¸ä¸‹ä¸€å¸§é—´å…¶å®æœ‰éå¸¸å¼ºçš„è¿ç»­æ€§ã€‚æˆ‘ä»¬å¾—åˆ°çš„æ•°æ®æ˜¯ç›¸å…³çš„æ—¶é—´åºåˆ—æ•°æ®ï¼Œä¸æ»¡è¶³ç‹¬ç«‹åŒåˆ†å¸ƒã€‚</li> <li>å¦å¤–ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç«‹åˆ»è·å¾—åé¦ˆï¼Œæ¸¸æˆæ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬å“ªä¸ªåŠ¨ä½œæ˜¯æ­£ç¡®åŠ¨ä½œã€‚æ¯”å¦‚æˆ‘ä»¬ç°åœ¨æŠŠæœ¨æ¿å¾€å³ç§»ï¼Œè¿™åªä¼šä½¿å¾—çƒå¾€ä¸Šæˆ–è€…å¾€å·¦å»ä¸€ç‚¹å„¿ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šå¾—åˆ°ç«‹åˆ»çš„åé¦ˆã€‚å› æ­¤ï¼Œå¼ºåŒ–å­¦ä¹ ä¹‹æ‰€ä»¥è¿™ä¹ˆå›°éš¾ï¼Œæ˜¯å› ä¸ºæ™ºèƒ½ä½“ä¸èƒ½å¾—åˆ°å³æ—¶çš„åé¦ˆï¼Œç„¶è€Œæˆ‘ä»¬ä¾ç„¶å¸Œæœ›æ™ºèƒ½ä½“åœ¨è¿™ä¸ªç¯å¢ƒé‡Œé¢å­¦ä¹ ã€‚</li> </ol> </li> <li>åŒºåˆ«æ€»ç»“ï¼š <ol> <li>å¼ºåŒ–å­¦ä¹ è¾“å…¥çš„æ ·æœ¬æ˜¯åºåˆ—æ•°æ®ï¼Œè€Œä¸åƒç›‘ç£å­¦ä¹ é‡Œé¢æ ·æœ¬éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚</li> <li>å­¦ä¹ å™¨å¹¶æ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬æ¯ä¸€æ­¥æ­£ç¡®çš„åŠ¨ä½œåº”è¯¥æ˜¯ä»€ä¹ˆï¼Œå­¦ä¹ å™¨éœ€è¦è‡ªå·±å»å‘ç°å“ªäº›åŠ¨ä½œå¯ä»¥å¸¦æ¥ æœ€å¤šçš„å¥–åŠ±ï¼Œåªèƒ½é€šè¿‡ä¸åœåœ°å°è¯•æ¥å‘ç°æœ€æœ‰åˆ©çš„åŠ¨ä½œã€‚</li> <li>æ™ºèƒ½ä½“è·å¾—è‡ªå·±èƒ½åŠ›çš„è¿‡ç¨‹ï¼Œå…¶å®æ˜¯ä¸æ–­åœ°è¯•é”™æ¢ç´¢ï¼ˆtrial-and-error explorationï¼‰çš„è¿‡ç¨‹ã€‚æ¢ç´¢ ï¼ˆexplorationï¼‰å’Œåˆ©ç”¨ï¼ˆexploitationï¼‰æ˜¯å¼ºåŒ–å­¦ä¹ é‡Œé¢éå¸¸æ ¸å¿ƒçš„é—®é¢˜ã€‚å…¶ä¸­ï¼Œæ¢ç´¢æŒ‡å°è¯•ä¸€äº›æ–°çš„åŠ¨ä½œï¼Œ è¿™äº›æ–°çš„åŠ¨ä½œæœ‰å¯èƒ½ä¼šä½¿æˆ‘ä»¬å¾—åˆ°æ›´å¤šçš„å¥–åŠ±ï¼Œä¹Ÿæœ‰å¯èƒ½ä½¿æˆ‘ä»¬â€œä¸€æ— æ‰€æœ‰â€ï¼›åˆ©ç”¨æŒ‡é‡‡å–å·²çŸ¥çš„å¯ä»¥è·å¾—æœ€å¤šå¥–åŠ±çš„åŠ¨ä½œï¼Œé‡å¤æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“è¿™æ ·åšå¯ä»¥è·å¾—ä¸€å®šçš„å¥–åŠ±ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¢ ç´¢å’Œåˆ©ç”¨ä¹‹é—´è¿›è¡Œæƒè¡¡ï¼Œè¿™ä¹Ÿæ˜¯åœ¨ç›‘ç£å­¦ä¹ é‡Œé¢æ²¡æœ‰çš„æƒ…å†µã€‚</li> <li>åœ¨å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰éå¸¸å¼ºçš„ç›‘ç£è€…ï¼ˆsupervisorï¼‰ï¼Œåªæœ‰<strong>å¥–åŠ±ä¿¡å·ï¼ˆreward signalï¼‰</strong>ï¼Œå¹¶ä¸”å¥–åŠ±ä¿¡å·æ˜¯å»¶è¿Ÿçš„ã€‚</li> </ol> </li> </ol> <h2 id="12-å¼ºåŒ–å­¦ä¹ çš„ç‰¹å¾">1.2 å¼ºåŒ–å­¦ä¹ çš„ç‰¹å¾</h2> <ol> <li>å¼ºåŒ–å­¦ä¹ ä¼šè¯•é”™æ¢ç´¢ï¼Œå®ƒé€šè¿‡æ¢ç´¢ç¯å¢ƒæ¥è·å–å¯¹ç¯å¢ƒçš„ç†è§£ã€‚</li> <li>å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“ä¼šä»ç¯å¢ƒé‡Œé¢è·å¾—å»¶è¿Ÿçš„å¥–åŠ±ã€‚</li> <li>åœ¨å¼ºåŒ–å­¦ä¹ çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ—¶é—´éå¸¸é‡è¦ã€‚å› ä¸ºæˆ‘ä»¬å¾—åˆ°çš„æ˜¯æœ‰æ—¶é—´å…³è”çš„æ•°æ®ï¼ˆsequential dataï¼‰ï¼Œ è€Œä¸æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„æ•°æ®ã€‚</li> <li>æ™ºèƒ½ä½“çš„åŠ¨ä½œä¼šå½±å“å®ƒéšåå¾—åˆ°çš„æ•°æ®ã€‚åœ¨è®­ç»ƒæ™ºèƒ½ä½“çš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¹Ÿæ˜¯é€šè¿‡æ­£åœ¨å­¦ä¹ çš„æ™ºèƒ½ä½“ä¸ç¯å¢ƒäº¤äº’æ¥å¾—åˆ°æ•°æ®çš„ã€‚æ‰€ä»¥å¦‚æœåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ™ºèƒ½ä½“ä¸èƒ½ä¿æŒç¨³å®šï¼Œå°±ä¼šä½¿æˆ‘ä»¬é‡‡é›†åˆ°çš„æ•°æ®éå¸¸ç³Ÿç³•ã€‚æˆ‘ä»¬é€šè¿‡æ•°æ®æ¥è®­ç»ƒæ™ºèƒ½ä½“ï¼Œå¦‚æœæ•°æ®æœ‰é—®é¢˜ï¼Œæ•´ä¸ªè®­ç»ƒè¿‡ç¨‹å°±ä¼šå¤±è´¥ã€‚æ‰€ä»¥åœ¨å¼ºåŒ–å­¦ä¹ é‡Œé¢ä¸€ä¸ªéå¸¸é‡è¦çš„é—®é¢˜å°±æ˜¯ï¼Œæ€ä¹ˆè®©æ™ºèƒ½ä½“çš„åŠ¨ä½œä¸€ç›´ç¨³å®šåœ°æå‡ã€‚</li> </ol> <h1 id="äºŒåºåˆ—å†³ç­–">äºŒã€åºåˆ—å†³ç­–</h1> <h2 id="21-æ™ºèƒ½ä½“å’Œç¯å¢ƒ">2.1 æ™ºèƒ½ä½“å’Œç¯å¢ƒ</h2> <p>å¼ºåŒ–å­¦ä¹ ç ”ç©¶çš„é—®é¢˜æ˜¯æ™ºèƒ½ä½“ä¸ç¯å¢ƒäº¤äº’çš„é—®é¢˜ã€‚æ™ºèƒ½ä½“æŠŠå®ƒçš„åŠ¨ä½œè¾“å‡ºç»™ç¯å¢ƒï¼Œç¯å¢ƒå–å¾—è¿™ä¸ªåŠ¨ä½œåä¼šè¿›è¡Œä¸‹ä¸€æ­¥ï¼ŒæŠŠä¸‹ä¸€æ­¥çš„è§‚æµ‹ä¸è¿™ä¸ªåŠ¨ä½œå¸¦æ¥çš„å¥–åŠ±è¿”è¿˜ç»™æ™ºèƒ½ä½“ã€‚è¿™æ ·çš„äº¤äº’ä¼šäº§ç”Ÿå¾ˆå¤šè§‚æµ‹ï¼Œæ™ºèƒ½ä½“çš„ç›®çš„æ˜¯ä»è¿™äº›è§‚æµ‹ä¹‹ä¸­å­¦åˆ°èƒ½æœ€å¤§åŒ–å¥–åŠ±çš„ç­–ç•¥ã€‚</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter1/Untitled%201-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter1/Untitled%201-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter1/Untitled%201-1400.webp"/> <img src="/assets/img/RL_chapter1/Untitled%201.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="22-å¥–åŠ±">2.2 å¥–åŠ±</h2> <p>å¥–åŠ±æ˜¯ç”±ç¯å¢ƒç»™çš„ä¸€ç§<strong>æ ‡é‡çš„åé¦ˆä¿¡å·</strong>ï¼ˆscalar feedback signalï¼‰ï¼Œè¿™ç§ä¿¡å·å¯æ˜¾ç¤ºæ™ºèƒ½ä½“åœ¨æŸä¸€æ­¥é‡‡ å–æŸä¸ªç­–ç•¥çš„è¡¨ç°å¦‚ä½•ã€‚å¼ºåŒ–å­¦ä¹ çš„ç›®çš„å°±æ˜¯æœ€å¤§åŒ–æ™ºèƒ½ä½“å¯ä»¥è·å¾—çš„å¥–åŠ±ï¼Œæ™ºèƒ½ä½“åœ¨ç¯å¢ƒé‡Œé¢å­˜åœ¨çš„ç›®çš„å°±æ˜¯æœ€å¤§åŒ–å®ƒçš„æœŸæœ›çš„ç´¯ç§¯å¥–åŠ±ï¼ˆexpected cumulative rewardï¼‰ã€‚ä¸åŒçš„ç¯å¢ƒä¸­ï¼Œå¥–åŠ±ä¹Ÿæ˜¯ä¸åŒçš„ã€‚</p> <h2 id="23-åºåˆ—å†³ç­–">2.3 åºåˆ—å†³ç­–</h2> <p>åœ¨ä¸€ä¸ªå¼ºåŒ–å­¦ä¹ ç¯å¢ƒé‡Œé¢ï¼Œæ™ºèƒ½ä½“çš„ç›®çš„å°±æ˜¯é€‰å–ä¸€ç³»åˆ—çš„åŠ¨ä½œæ¥æœ€å¤§åŒ–å¥–åŠ±ï¼Œæ‰€ä»¥è¿™äº›é€‰å–çš„åŠ¨ä½œ å¿…é¡»æœ‰é•¿æœŸçš„å½±å“ã€‚ä½†åœ¨è¿™ä¸ªè¿‡ç¨‹é‡Œé¢ï¼Œæ™ºèƒ½ä½“çš„å¥–åŠ±å…¶å®æ˜¯è¢«å»¶è¿Ÿäº†çš„ï¼Œå°±æ˜¯æˆ‘ä»¬ç°åœ¨é€‰å–çš„æŸä¸€æ­¥åŠ¨ä½œï¼Œå¯èƒ½è¦ç­‰åˆ°å¾ˆä¹…åæ‰çŸ¥é“è¿™ä¸€æ­¥åˆ°åº•äº§ç”Ÿäº†ä»€ä¹ˆæ ·çš„å½±å“ã€‚å¼ºåŒ–å­¦ä¹ é‡Œé¢ä¸€ä¸ªé‡è¦çš„è¯¾é¢˜å°±æ˜¯è¿‘æœŸå¥–åŠ±å’Œè¿œæœŸå¥–åŠ±çš„æƒè¡¡ ï¼ˆtrade-offï¼‰ï¼Œç ”ç©¶æ€ä¹ˆè®©æ™ºèƒ½ä½“å–å¾—æ›´å¤šçš„è¿œæœŸå¥–åŠ±ã€‚åœ¨ä¸ç¯å¢ƒçš„äº¤äº’è¿‡ç¨‹ä¸­ï¼Œæ™ºèƒ½ä½“ä¼šè·å¾—å¾ˆå¤šè§‚æµ‹ã€‚é’ˆå¯¹æ¯ä¸€ä¸ªè§‚æµ‹ï¼Œæ™ºèƒ½ä½“ä¼šé‡‡å–ä¸€ä¸ªåŠ¨ä½œï¼Œä¹Ÿä¼šå¾—åˆ°ä¸€ä¸ªå¥–åŠ±ã€‚</p> <ol> <li> <p><strong>å†å²</strong>æ˜¯<strong>è§‚æµ‹ã€åŠ¨ä½œã€å¥–åŠ±</strong>çš„åºåˆ—ï¼š</p> \[H_t=o_1, a_1, r_1, \ldots, o_t, a_t, r_t\] </li> <li> <p>æ™ºèƒ½ä½“åœ¨é‡‡å–å½“å‰åŠ¨ä½œçš„æ—¶å€™ä¼šä¾èµ–äºå®ƒä¹‹å‰å¾—åˆ°çš„å†å²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªæ¸¸æˆçš„<strong>çŠ¶æ€</strong>çœ‹æˆå…³äºè¿™ä¸ª<strong>å†å²</strong>çš„å‡½æ•°ï¼š</p> \[S_t=f\left(H_t\right)\] </li> <li>è§‚æµ‹å’ŒçŠ¶æ€çš„åŒºåˆ«ï¼š<strong>çŠ¶æ€</strong>æ˜¯å¯¹ä¸–ç•Œçš„å®Œæ•´æè¿°ï¼Œä¸ä¼šéšè—ä¸–ç•Œçš„ä¿¡æ¯ã€‚<strong>è§‚æµ‹</strong>æ˜¯å¯¹çŠ¶æ€çš„éƒ¨åˆ†æè¿°ï¼Œå¯èƒ½ä¼šé—æ¼ä¸€äº›ä¿¡æ¯ã€‚åœ¨æ·±åº¦å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹æ€»æ˜¯ç”¨å®å€¼çš„å‘é‡ã€çŸ©é˜µæˆ–è€…æ›´é«˜é˜¶çš„å¼ é‡æ¥è¡¨ç¤ºçŠ¶æ€å’Œè§‚ã€‚</li> <li><strong>ç¯å¢ƒ</strong>æœ‰è‡ªå·±çš„å‡½æ•°\(S_t^e=f^e\left(H_t\right)\)Â æ¥æ›´æ–°çŠ¶æ€ï¼Œåœ¨<strong>æ™ºèƒ½ä½“</strong>çš„å†…éƒ¨ä¹Ÿæœ‰ä¸€ä¸ªå‡½æ•°\(S_t^a=f^a\left(H_t\right)\)æ¥æ›´æ–°çŠ¶æ€ã€‚</li> <li>é©¬å°”å¯å¤«å†³ç­–ï¼ˆMarkov decision processï¼ŒMDPï¼‰è¿‡ç¨‹ï¼šå½“æ™ºèƒ½ä½“çš„çŠ¶æ€ä¸ç¯å¢ƒçš„çŠ¶æ€ç­‰ä»·çš„æ—¶å€™ï¼Œå³å½“æ™ºèƒ½ä½“èƒ½å¤Ÿè§‚å¯Ÿåˆ°ç¯å¢ƒçš„æ‰€æœ‰çŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªç¯å¢ƒæ˜¯å®Œå…¨å¯è§‚æµ‹çš„ï¼ˆfully observedï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹é¢ï¼Œå¼ºåŒ–å­¦ä¹ é€šå¸¸è¢«å»ºæ¨¡æˆä¸€ä¸ªé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„é—®é¢˜ã€‚åœ¨é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¸­ï¼Œ\(O_t=S_t^e=S_t^a\)ã€‚</li> <li> <p>éƒ¨åˆ†å¯è§‚æµ‹é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆpartially observable Markov decision process, POMDPï¼‰ï¼šæ™ºèƒ½ä½“å¾—åˆ°çš„è§‚æµ‹å¹¶ä¸ä¸€å®šèƒ½åŒ…å«ç¯å¢ƒè¿ä½œçš„æ‰€æœ‰çŠ¶æ€ï¼Œå› ä¸ºåœ¨å¼ºåŒ–å­¦ä¹ çš„è®¾å®šé‡Œé¢ï¼Œ ç¯å¢ƒçš„çŠ¶æ€æ‰æ˜¯çœŸæ­£çš„æ‰€æœ‰çŠ¶æ€ã€‚å½“æ™ºèƒ½ä½“åªèƒ½çœ‹åˆ°éƒ¨åˆ†çš„è§‚æµ‹ï¼Œæˆ‘ä»¬å°±ç§°è¿™ä¸ªç¯å¢ƒæ˜¯éƒ¨åˆ†å¯è§‚æµ‹çš„ï¼ˆpartially observedï¼‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¼ºåŒ–å­¦ä¹ é€šå¸¸è¢«å»ºæ¨¡æˆéƒ¨åˆ†å¯è§‚æµ‹é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„é—®é¢˜ã€‚éƒ¨åˆ†å¯è§‚æµ‹é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹æ˜¯é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„ä¸€ç§æ³›åŒ–ã€‚ éƒ¨åˆ†å¯è§‚æµ‹é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ä¾ç„¶å…·æœ‰é©¬å°”å¯å¤«æ€§è´¨ï¼Œä½†æ˜¯å‡è®¾æ™ºèƒ½ä½“æ— æ³•æ„ŸçŸ¥ç¯å¢ƒçš„çŠ¶æ€ï¼Œåªèƒ½çŸ¥é“éƒ¨åˆ†è§‚æµ‹å€¼ã€‚éƒ¨åˆ†è§‚æµ‹å€¼ã€‚æ¯”å¦‚åœ¨è‡ªåŠ¨é©¾é©¶ä¸­ï¼Œæ™ºèƒ½ä½“åªèƒ½æ„ŸçŸ¥ä¼ æ„Ÿå™¨é‡‡é›†çš„æœ‰é™çš„ç¯å¢ƒä¿¡æ¯ã€‚</p> <p>ğŸ˜ˆ éƒ¨åˆ†å¯è§‚æµ‹é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹å¯ä»¥ç”¨ä¸€ä¸ªä¸ƒå…ƒç»„æè¿°ï¼š\((S, A, T, R, \Omega, O, \gamma)\)ã€‚å…¶ä¸­\(S\)è¡¨ç¤ºçŠ¶æ€ç©ºé—´ï¼Œä¸ºéšå˜é‡ï¼Œ\(A\)ä¸ºåŠ¨ä½œç©ºé—´ï¼Œ\(T\left(s^{\prime} \mid s, a\right)\)ä¸ºçŠ¶æ€è½¬ç§»æ¦‚ç‡ï¼Œ\(R\) ä¸ºå¥–åŠ±å‡½æ•°ï¼Œ\(\Omega(o \mid s, a)\)ä¸ºè§‚æµ‹æ¦‚ç‡,\(o\)ä¸ºè§‚æµ‹ç©ºé—´ï¼Œ\(\gamma\)ä¸ºæŠ˜æ‰£ç³»æ•°ã€‚</p> </li> </ol> <h1 id="ä¸‰åŠ¨ä½œç©ºé—´">ä¸‰ã€åŠ¨ä½œç©ºé—´</h1> <p>ä¸åŒçš„ç¯å¢ƒå…è®¸ä¸åŒç§ç±»çš„åŠ¨ä½œã€‚åœ¨ç»™å®šçš„ç¯å¢ƒä¸­ï¼Œ<strong>æœ‰æ•ˆåŠ¨ä½œçš„é›†åˆ</strong>ç»å¸¸è¢«ç§°ä¸º<strong>åŠ¨ä½œç©ºé—´</strong>ï¼ˆaction spaceï¼‰ã€‚åƒé›…è¾¾åˆ©æ¸¸æˆå’Œå›´æ£‹ï¼ˆGoï¼‰è¿™æ ·çš„ç¯å¢ƒæœ‰<strong>ç¦»æ•£åŠ¨ä½œç©ºé—´</strong>ï¼ˆdiscrete action spaceï¼‰ï¼Œåœ¨è¿™ä¸ªåŠ¨ä½œ ç©ºé—´é‡Œï¼Œæ™ºèƒ½ä½“çš„åŠ¨ä½œæ•°é‡æ˜¯æœ‰é™çš„ã€‚åœ¨å…¶ä»–ç¯å¢ƒï¼Œæ¯”å¦‚åœ¨ç‰©ç†ä¸–ç•Œä¸­æ§åˆ¶ä¸€ä¸ªæ™ºèƒ½ä½“ï¼Œåœ¨è¿™ä¸ªç¯å¢ƒä¸­å°±æœ‰<strong>è¿ç»­åŠ¨ä½œç©ºé—´</strong>ï¼ˆcontinuous action spaceï¼‰ã€‚åœ¨è¿ç»­åŠ¨ä½œç©ºé—´ä¸­ï¼ŒåŠ¨ä½œæ˜¯å®å€¼çš„å‘é‡ã€‚</p> <p>ä¾‹å¦‚ï¼Œèµ°è¿·å®«æœºå™¨äººå¦‚æœåªæœ‰å¾€ä¸œã€å¾€å—ã€å¾€è¥¿ã€å¾€åŒ—è¿™ 4 ç§ç§»åŠ¨æ–¹å¼ï¼Œåˆ™å…¶åŠ¨ä½œç©ºé—´ä¸ºç¦»æ•£åŠ¨ä½œç©º é—´ï¼›å¦‚æœæœºå™¨äººå¯ä»¥å‘ 360 â—¦ ä¸­çš„ä»»æ„è§’åº¦è¿›è¡Œç§»åŠ¨ï¼Œåˆ™å…¶åŠ¨ä½œç©ºé—´ä¸ºè¿ç»­åŠ¨ä½œç©ºé—´ã€‚</p> <h1 id="å››å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“çš„ç»„æˆæˆåˆ†å’Œç±»å‹">å››ã€å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“çš„ç»„æˆæˆåˆ†å’Œç±»å‹</h1> <p><strong>éƒ¨åˆ†å¯è§‚æµ‹é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹( POMDP)</strong>Â æ˜¯ä¸€ä¸ªé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹çš„æ³›åŒ–ã€‚å¯¹äºä¸€ä¸ªå¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“ï¼Œå®ƒå¯èƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå¦‚ä¸‹çš„ç»„æˆæˆåˆ†ã€‚</p> <ul> <li><strong>ç­–ç•¥ï¼ˆpolicyï¼‰</strong>ã€‚æ™ºèƒ½ä½“ä¼šç”¨ç­–ç•¥æ¥é€‰å–ä¸‹ä¸€æ­¥çš„<strong>åŠ¨ä½œ</strong>ã€‚</li> <li><strong>ä»·å€¼å‡½æ•°ï¼ˆvalue functionï¼‰</strong>ã€‚æˆ‘ä»¬ç”¨ä»·å€¼å‡½æ•°æ¥å¯¹å½“å‰çŠ¶æ€è¿›è¡Œè¯„ä¼°ã€‚ä»·å€¼å‡½æ•°ç”¨äºè¯„ä¼°æ™ºèƒ½ä½“è¿›å…¥æŸä¸ªçŠ¶æ€åï¼Œå¯ä»¥å¯¹åé¢çš„<strong>å¥–åŠ±</strong>å¸¦æ¥å¤šå¤§çš„å½±å“ã€‚ä»·å€¼å‡½æ•°å€¼è¶Šå¤§ï¼Œè¯´æ˜æ™ºèƒ½ä½“è¿›å…¥è¿™ä¸ªçŠ¶æ€è¶Šæœ‰ åˆ©ã€‚</li> <li><strong>æ¨¡å‹ï¼ˆmodelï¼‰</strong>ã€‚æ¨¡å‹è¡¨ç¤ºæ™ºèƒ½ä½“å¯¹ç¯å¢ƒçš„çŠ¶æ€è¿›è¡Œç†è§£ï¼Œå®ƒå†³å®šäº†ç¯å¢ƒä¸­ä¸–ç•Œçš„è¿è¡Œæ–¹å¼ã€‚ ä¸‹é¢æˆ‘ä»¬æ·±å…¥äº†è§£è¿™ 3 ä¸ªç»„æˆéƒ¨åˆ†çš„ç»†èŠ‚ã€‚</li> </ul> <h2 id="41-ç­–ç•¥">4.1 ç­–ç•¥</h2> <p>ç­–ç•¥æ˜¯æ™ºèƒ½ä½“çš„<strong>åŠ¨ä½œæ¨¡å‹</strong>ï¼Œå®ƒå†³å®šäº†æ™ºèƒ½ä½“çš„åŠ¨ä½œã€‚å®ƒå…¶å®æ˜¯ä¸€ä¸ª<strong>å‡½æ•°</strong>ï¼Œç”¨äºæŠŠè¾“å…¥çš„çŠ¶æ€å˜æˆåŠ¨ä½œã€‚ç­–ç•¥å¯åˆ†ä¸ºä¸¤ç§ï¼š<strong>éšæœºæ€§ç­–ç•¥</strong>å’Œ<strong>ç¡®å®šæ€§ç­–ç•¥</strong>ã€‚</p> <ol> <li><strong>éšæœºæ€§ç­–ç•¥ï¼ˆstochastic policyï¼‰</strong>å°±æ˜¯\(\pi\) å‡½æ•°ï¼Œå³\(\pi(a \mid s)=p\left(a_t=a \mid s_t=s\right)\)ã€‚è¾“å…¥ä¸€ä¸ªçŠ¶æ€Â \(s\)ï¼Œè¾“å‡ºä¸€ä¸ªæ¦‚ç‡ã€‚ è¿™ä¸ªæ¦‚ç‡æ˜¯æ™ºèƒ½ä½“<strong>æ‰€æœ‰åŠ¨ä½œçš„æ¦‚ç‡</strong>ï¼Œç„¶åå¯¹è¿™ä¸ªæ¦‚ç‡åˆ†å¸ƒè¿›è¡Œ<strong>é‡‡æ ·</strong>ï¼Œå¯å¾—åˆ°æ™ºèƒ½ä½“å°†é‡‡å–çš„åŠ¨ä½œã€‚æ¯”å¦‚å¯èƒ½æ˜¯æœ‰ 0.7 çš„æ¦‚ç‡å¾€å·¦ï¼Œ0.3 çš„æ¦‚ç‡å¾€å³ï¼Œé‚£ä¹ˆé€šè¿‡é‡‡æ ·å°±å¯ä»¥å¾—åˆ°æ™ºèƒ½ä½“å°†é‡‡å–çš„åŠ¨ä½œã€‚</li> <li><strong>ç¡®å®šæ€§ç­–ç•¥ï¼ˆdeterministic policyï¼‰</strong>å°±æ˜¯æ™ºèƒ½ä½“ç›´æ¥é‡‡å–<strong>æœ€æœ‰å¯èƒ½</strong>çš„åŠ¨ä½œï¼Œå³\(a^*=\underset{a}{\arg \max } \pi(a \mid s)\)ã€‚</li> </ol> <p>ğŸ˜ é€šå¸¸æƒ…å†µä¸‹ï¼Œå¼ºåŒ–å­¦ä¹ ä¸€èˆ¬ä½¿ç”¨<strong>éšæœºæ€§ç­–ç•¥</strong>ï¼Œéšæœºæ€§ç­–ç•¥æœ‰å¾ˆå¤šä¼˜ç‚¹ã€‚æ¯”å¦‚ï¼Œåœ¨å­¦ä¹ æ—¶å¯ä»¥é€šè¿‡å¼•å…¥ä¸€å®šçš„éšæœºæ€§æ¥æ›´å¥½åœ°æ¢ç´¢ç¯å¢ƒï¼› éšæœºæ€§ç­–ç•¥çš„åŠ¨ä½œå…·æœ‰å¤šæ ·æ€§ï¼Œè¿™ä¸€ç‚¹åœ¨å¤šä¸ªæ™ºèƒ½ä½“åšå¼ˆæ—¶éå¸¸é‡è¦ã€‚é‡‡ç”¨ç¡®å®šæ€§ç­–ç•¥çš„æ™ºèƒ½ä½“æ€»æ˜¯å¯¹åŒæ ·çš„çŠ¶æ€é‡‡å–ç›¸åŒçš„åŠ¨ä½œï¼Œè¿™ä¼šå¯¼è‡´å®ƒçš„ç­–ç•¥å¾ˆå®¹æ˜“è¢«å¯¹æ‰‹é¢„æµ‹ã€‚</p> <h2 id="42-ä»·å€¼å‡½æ•°">4.2 ä»·å€¼å‡½æ•°</h2> <ol> <li> <p>ä»·å€¼å‡½æ•°çš„å€¼æ˜¯å¯¹æœªæ¥å¥–åŠ±çš„é¢„æµ‹ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥è¯„ä¼°çŠ¶æ€çš„å¥½åã€‚ ä»·å€¼å‡½æ•°é‡Œé¢æœ‰ä¸€ä¸ª<strong>æŠ˜æ‰£å› å­ï¼ˆdiscount factorï¼‰</strong>ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å°½å¯èƒ½çŸ­çš„æ—¶é—´é‡Œé¢å¾—åˆ°å°½å¯èƒ½å¤šçš„å¥–åŠ±ã€‚â€ç°åœ¨çš„é’±ä»¥åå°±ä¸å€¼é’±äº†â€œã€‚</p> \[V_\pi(s) \doteq \mathbb{E}_\pi\left[G_t \mid s_t=s\right]=\mathbb{E}_\pi\left[\sum_{k=0}^{\infty} \gamma^k r_{t+k+1} \mid s_t=s\right], \forall s\in S\] <p>æœŸæœ› \(\mathbb{E}_\pi\) çš„ä¸‹æ ‡æ˜¯\(\pi\)å‡½æ•°ï¼Œ\(\pi\)å‡½æ•°çš„å€¼å¯åæ˜ åœ¨æˆ‘ä»¬ä½¿ç”¨ç­–ç•¥\(\pi\)çš„æ—¶å€™ï¼Œåˆ°åº•å¯ä»¥å¾—åˆ°å¤šå°‘å¥–åŠ±ã€‚</p> </li> <li> <p>æˆ‘ä»¬è¿˜æœ‰ä¸€ç§ä»·å€¼å‡½æ•°ï¼š \(Q\) å‡½æ•°ã€‚ \(Q\) å‡½æ•°é‡Œé¢åŒ…å«ä¸¤ä¸ªå˜é‡ï¼š<strong>çŠ¶æ€</strong>å’Œ<strong>åŠ¨ä½œ</strong>ã€‚å…¶å®šä¹‰ä¸º</p> \[Q_\pi(s, a) \doteq \mathbb{E}_\pi\left[G_t \mid s_t=s, a_t=a\right]=\mathbb{E}_\pi\left[\sum_{k=0}^{\infty} \gamma^k r_{t+k+1} \mid s_t=s, a_t=a\right]\] <p>æœªæ¥å¯ä»¥è·å¾—å¥–åŠ±çš„æœŸæœ›å–å†³äº<strong>å½“å‰çš„çŠ¶æ€</strong>å’Œ<strong>å½“å‰çš„åŠ¨ä½œ</strong>ã€‚å½“æˆ‘ä»¬å¾—åˆ° \(Q\) å‡½æ•°åï¼Œ è¿›å…¥æŸä¸ªçŠ¶æ€è¦é‡‡å–çš„æœ€ä¼˜åŠ¨ä½œå¯ä»¥é€šè¿‡ \(Q\) å‡½æ•°å¾—åˆ°ã€‚</p> </li> </ol> <h2 id="43-æ¨¡å‹">4.3 æ¨¡å‹</h2> <p>æ¨¡å‹å†³å®šäº†ä¸‹ä¸€æ­¥çš„<strong>çŠ¶æ€</strong>ã€‚ä¸‹ä¸€æ­¥çš„çŠ¶æ€å–å†³äºå½“å‰çš„çŠ¶æ€ä»¥åŠå½“å‰é‡‡å–çš„åŠ¨ä½œã€‚å®ƒç”±<strong>çŠ¶æ€è½¬ç§»æ¦‚ç‡</strong>å’Œ<strong>å¥–åŠ±å‡½æ•°</strong>ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆã€‚</p> <ol> <li> <p><strong>çŠ¶æ€è½¬ç§»æ¦‚ç‡</strong>å³</p> \[p_{s s^{\prime}}^a=p\left(s_{t+1}=s^{\prime} \mid s_t=s, a_t=a\right)\] </li> <li> <p><strong>å¥–åŠ±å‡½æ•°</strong>æ˜¯æŒ‡æˆ‘ä»¬åœ¨å½“å‰çŠ¶æ€é‡‡å–äº†æŸä¸ªåŠ¨ä½œï¼Œå¯ä»¥å¾—åˆ°å¤šå¤§çš„å¥–åŠ±ï¼Œå³</p> </li> </ol> \[R(s, a)=\mathbb{E}\left[r_{t+1} \mid s_t=s, a_t=a\right]\] <ol> <li><strong>é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMarkov decision processï¼‰</strong>è¿™ä¸ªå†³ç­–è¿‡ç¨‹å¯è§†åŒ–äº†çŠ¶æ€ä¹‹é—´çš„è½¬ç§»ä»¥åŠé‡‡å–çš„åŠ¨ä½œã€‚åŒ…å«<strong>ç­–ç•¥ã€ä»·å€¼å‡½æ•°å’Œæ¨¡å‹</strong></li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter1/Untitled%202-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter1/Untitled%202-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter1/Untitled%202-1400.webp"/> <img src="/assets/img/RL_chapter1/Untitled%202.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="44-å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“çš„ç±»å‹">4.4 å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“çš„ç±»å‹</h2> <ol> <li>åŸºäºä»·å€¼çš„æ™ºèƒ½ä½“ä¸åŸºäºç­–ç•¥çš„æ™ºèƒ½ä½“ æ ¹æ®æ™ºèƒ½ä½“å­¦ä¹ çš„äº‹ç‰©ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ™ºèƒ½ä½“è¿›è¡Œå½’ç±»ã€‚ <ol> <li><strong>åŸºäºä»·å€¼çš„æ™ºèƒ½ä½“ï¼ˆvalue-based agentï¼‰</strong>æ˜¾å¼åœ°å­¦ä¹ ä»·å€¼å‡½æ•°ï¼Œéšå¼åœ°å­¦ä¹ å®ƒçš„ç­–ç•¥ã€‚ç­–ç•¥æ˜¯å…¶ä»å­¦åˆ°çš„ä»·å€¼å‡½æ•°é‡Œé¢æ¨ç®—å‡ºæ¥çš„ã€‚</li> <li><strong>åŸºäºç­–ç•¥çš„æ™ºèƒ½ä½“ï¼ˆpolicy-based agentï¼‰</strong>ç›´æ¥å­¦ä¹ ç­–ç•¥ï¼Œæˆ‘ä»¬ç»™å®ƒä¸€ä¸ªçŠ¶æ€ï¼Œå®ƒå°±ä¼šè¾“å‡ºå¯¹åº”åŠ¨ä½œçš„æ¦‚ç‡ã€‚åŸºäºç­–ç•¥çš„æ™ºèƒ½ä½“å¹¶æ²¡æœ‰å­¦ä¹ ä»·å€¼å‡½æ•°ã€‚</li> <li>æŠŠåŸºäºä»·å€¼çš„æ™ºèƒ½ä½“å’ŒåŸºäºç­–ç•¥çš„æ™ºèƒ½ä½“ç»“åˆèµ·æ¥å°±æœ‰äº†<strong>æ¼”å‘˜-è¯„è®ºå‘˜æ™ºèƒ½ä½“ï¼ˆactor-critic agentï¼‰</strong>ã€‚è¿™ä¸€ç±»æ™ºèƒ½ä½“æŠŠç­–ç•¥å’Œä»·å€¼å‡½æ•°éƒ½å­¦ä¹ äº†ï¼Œç„¶åé€šè¿‡ä¸¤è€…çš„äº¤äº’å¾—åˆ°æœ€ä½³çš„åŠ¨ä½œã€‚</li> </ol> <p>ğŸ˜ Q: åŸºäºç­–ç•¥å’ŒåŸºäºä»·å€¼çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«?</p> <p>A: å¯¹äºä¸€ä¸ªçŠ¶æ€è½¬ç§»æ¦‚ç‡å·²çŸ¥çš„é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•æ¥æ±‚è§£ã€‚ä»å†³ç­–æ–¹å¼æ¥çœ‹ï¼Œå¼ºåŒ–å­¦ä¹ åˆå¯ä»¥åˆ’åˆ†ä¸ºåŸºäºç­–ç•¥çš„æ–¹æ³•å’ŒåŸºäºä»·å€¼çš„æ–¹æ³•ã€‚å†³ç­–æ–¹å¼æ˜¯æ™ºèƒ½ä½“åœ¨ç»™å®šçŠ¶æ€ä¸‹ä»åŠ¨ä½œé›†åˆä¸­é€‰æ‹©ä¸€ä¸ªåŠ¨ä½œçš„ä¾æ®ï¼Œå®ƒæ˜¯é™æ€çš„ï¼Œä¸éšçŠ¶æ€å˜åŒ–è€Œå˜åŒ–ã€‚</p> <p>åœ¨åŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ä¸­ï¼Œæ™ºèƒ½ä½“ä¼šåˆ¶å®šä¸€å¥—åŠ¨ä½œç­–ç•¥ï¼ˆç¡®å®šåœ¨ç»™å®šçŠ¶æ€ä¸‹éœ€è¦é‡‡å–ä½•ç§åŠ¨ä½œï¼‰ï¼Œå¹¶æ ¹æ®è¿™ä¸ªç­–ç•¥è¿›è¡Œæ“ä½œã€‚å¼ºåŒ–å­¦ä¹ ç®—æ³•ç›´æ¥å¯¹ç­–ç•¥è¿›è¡Œä¼˜åŒ–ï¼Œä½¿åˆ¶å®šçš„ç­–ç•¥èƒ½å¤Ÿè·å¾—æœ€å¤§çš„å¥–åŠ±ã€‚</p> <p>è€Œåœ¨åŸºäºä»·å€¼çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ä¸­ï¼Œæ™ºèƒ½ä½“ä¸éœ€è¦åˆ¶å®šæ˜¾å¼çš„ç­–ç•¥ï¼Œå®ƒç»´æŠ¤ä¸€ä¸ªä»·å€¼è¡¨æ ¼æˆ–ä»·å€¼å‡½æ•°ï¼Œå¹¶é€šè¿‡è¿™ä¸ªä»·å€¼è¡¨æ ¼æˆ–ä»·å€¼å‡½æ•°æ¥é€‰å–ä»·å€¼æœ€å¤§çš„åŠ¨ä½œã€‚åŸºäºä»·å€¼è¿­ä»£çš„æ–¹æ³•åªèƒ½åº”ç”¨åœ¨ä¸è¿ç»­çš„ã€ç¦»æ•£çš„ç¯å¢ƒä¸‹ï¼ˆå¦‚å›´æ£‹æˆ–æŸäº›æ¸¸æˆé¢†åŸŸï¼‰ï¼Œå¯¹äºåŠ¨ä½œé›†åˆè§„æ¨¡åºå¤§ã€åŠ¨ä½œè¿ç»­çš„åœºæ™¯ï¼ˆå¦‚æœºå™¨äººæ§åˆ¶é¢†åŸŸï¼‰ï¼Œå…¶å¾ˆéš¾å­¦ä¹ åˆ°è¾ƒå¥½çš„ç»“æœï¼ˆæ­¤æ—¶åŸºäºç­–ç•¥è¿­ä»£çš„æ–¹æ³•èƒ½å¤Ÿæ ¹æ®è®¾å®šçš„ç­–ç•¥æ¥é€‰æ‹©è¿ç»­çš„åŠ¨ä½œï¼‰ã€‚</p> <p>åŸºäºä»·å€¼çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•æœ‰Qå­¦ä¹ ï¼ˆQ-learningï¼‰ã€ Sarsa ç­‰ï¼Œè€ŒåŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•æœ‰ç­–ç•¥æ¢¯åº¦ï¼ˆPolicy Gradientï¼ŒPGï¼‰ç®—æ³•ç­‰ã€‚æ­¤å¤–ï¼Œæ¼”å‘˜-è¯„è®ºå‘˜ç®—æ³•åŒæ—¶ä½¿ç”¨ç­–ç•¥å’Œä»·å€¼è¯„ä¼°æ¥åšå‡ºå†³ç­–ã€‚å…¶ä¸­ï¼Œæ™ºèƒ½ä½“ä¼šæ ¹æ®ç­–ç•¥åšå‡ºåŠ¨ä½œï¼Œè€Œä»·å€¼å‡½æ•°ä¼šå¯¹åšå‡ºçš„åŠ¨ä½œç»™å‡ºä»·å€¼ï¼Œè¿™æ ·å¯ä»¥åœ¨åŸæœ‰çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•çš„åŸºç¡€ä¸ŠåŠ é€Ÿå­¦ä¹ è¿‡ç¨‹ï¼Œå–å¾—æ›´å¥½çš„æ•ˆæœã€‚</p> </li> <li>æœ‰æ¨¡å‹å¼ºåŒ–å­¦ä¹ ï¼š æ™ºèƒ½ä½“ä¸å…æ¨¡å‹å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ™ºèƒ½ä½“åˆ°åº•æœ‰æ²¡æœ‰å­¦ä¹ <strong>ç¯å¢ƒæ¨¡å‹</strong>æ¥å¯¹æ™ºèƒ½ä½“è¿›è¡Œåˆ†ç±»ã€‚ <ol> <li><strong>æœ‰æ¨¡å‹ï¼ˆmodel-basedï¼‰</strong>å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“é€šè¿‡å­¦ä¹ <strong>çŠ¶æ€çš„è½¬ç§»</strong>æ¥é‡‡å–åŠ¨ä½œã€‚Â </li> <li><strong>å…æ¨¡å‹ï¼ˆmodel-freeï¼‰</strong>å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“æ²¡æœ‰å»ç›´æ¥ä¼°è®¡çŠ¶æ€çš„è½¬ç§»ï¼Œä¹Ÿæ²¡æœ‰å¾—åˆ°ç¯å¢ƒçš„å…·ä½“è½¬ç§»å˜é‡ï¼Œå®ƒé€šè¿‡<strong>å­¦ä¹ ä»·å€¼å‡½æ•°å’Œç­–ç•¥å‡½æ•°</strong>è¿›è¡Œå†³ç­–ã€‚å…æ¨¡å‹å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“çš„æ¨¡å‹é‡Œé¢æ²¡æœ‰ç¯å¢ƒè½¬ç§»çš„æ¨¡å‹ã€‚</li> </ol> <p>æˆ‘ä»¬å¯ä»¥ç”¨é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹æ¥å®šä¹‰å¼ºåŒ–å­¦ä¹ ä»»åŠ¡ï¼Œå¹¶å°†å…¶è¡¨ç¤ºä¸ºå››å…ƒç»„Â \(&lt;S,A,P,R&gt;\)ï¼Œå³çŠ¶æ€é›†åˆã€åŠ¨ä½œé›†åˆã€çŠ¶æ€è½¬ç§»å‡½æ•°å’Œå¥–åŠ±å‡½æ•°ã€‚å¦‚æœè¿™ä¸ªå››å…ƒç»„ä¸­æ‰€æœ‰å…ƒç´ å‡å·²çŸ¥ï¼Œä¸”çŠ¶æ€é›†åˆå’ŒåŠ¨ä½œé›†åˆåœ¨æœ‰é™æ­¥æ•°å†…æ˜¯æœ‰é™é›†ï¼Œåˆ™æ™ºèƒ½ä½“å¯ä»¥å¯¹çœŸå®ç¯å¢ƒè¿›è¡Œå»ºæ¨¡ï¼Œæ„å»ºä¸€ä¸ªè™šæ‹Ÿä¸–ç•Œæ¥æ¨¡æ‹ŸçœŸå®ç¯å¢ƒä¸­çš„çŠ¶æ€å’Œäº¤äº’ååº”ã€‚ å…·ä½“æ¥è¯´ï¼Œå½“æ™ºèƒ½ä½“çŸ¥é“çŠ¶æ€è½¬ç§»å‡½æ•°Â \(P(s_{t+1}âˆ£s_t,a_t)\)Â å’Œå¥–åŠ±å‡½æ•°Â \(R(s_t,a_t)\) åï¼Œå®ƒå°±èƒ½çŸ¥é“åœ¨æŸä¸€çŠ¶æ€ä¸‹æ‰§è¡ŒæŸä¸€åŠ¨ä½œåèƒ½å¸¦æ¥çš„å¥–åŠ±å’Œç¯å¢ƒçš„ä¸‹ä¸€çŠ¶æ€ï¼Œè¿™æ ·æ™ºèƒ½ä½“å°±ä¸éœ€è¦åœ¨çœŸå®ç¯å¢ƒä¸­é‡‡å–åŠ¨ä½œï¼Œç›´æ¥åœ¨è™šæ‹Ÿä¸–ç•Œä¸­å­¦ä¹ å’Œè§„åˆ’ç­–ç•¥å³å¯ã€‚è¿™ç§å­¦ä¹ æ–¹æ³•ç§°ä¸º<strong>æœ‰æ¨¡å‹å¼ºåŒ–å­¦ä¹ </strong>ã€‚ äº”ã€å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬é—®é¢˜ï¼šè§„åˆ’å’Œå­¦ä¹ </p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter1/Untitled%203-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter1/Untitled%203-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter1/Untitled%203-1400.webp"/> <img src="/assets/img/RL_chapter1/Untitled%203.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h1 id="äº”å¼ºåŒ–å­¦ä¹ åŸºæœ¬é—®é¢˜">äº”ã€å¼ºåŒ–å­¦ä¹ åŸºæœ¬é—®é¢˜</h1> <h2 id="51-å­¦ä¹ å’Œè§„åˆ’">5.1 å­¦ä¹ å’Œè§„åˆ’</h2> <p>å­¦ä¹ ï¼ˆlearningï¼‰å’Œè§„åˆ’ï¼ˆplanningï¼‰æ˜¯åºåˆ—å†³ç­–çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜ã€‚åœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œ<strong>ç¯å¢ƒ</strong>åˆå§‹æ—¶æ˜¯æœªçŸ¥çš„ï¼Œ<strong>æ™ºèƒ½ä½“</strong>ä¸çŸ¥é“ç¯å¢ƒå¦‚ä½•å·¥ä½œï¼Œå®ƒé€šè¿‡ä¸æ–­åœ°ä¸ç¯å¢ƒäº¤äº’ï¼Œé€æ¸æ”¹è¿›ç­–ç•¥ã€‚</p> <ol> <li>åœ¨<strong>è§„åˆ’</strong>ä¸­ï¼Œç¯å¢ƒæ˜¯å·²çŸ¥çš„ï¼Œæ™ºèƒ½ä½“è¢«å‘ŠçŸ¥äº†æ•´ä¸ªç¯å¢ƒçš„è¿ä½œè§„åˆ™çš„è¯¦ç»†ä¿¡æ¯ã€‚æ™ºèƒ½ä½“èƒ½å¤Ÿè®¡ç®—å‡ºä¸€ä¸ªå®Œç¾çš„æ¨¡å‹ï¼Œå¹¶ä¸”åœ¨ä¸éœ€è¦ä¸ç¯å¢ƒè¿›è¡Œä»»ä½•äº¤äº’çš„æ—¶å€™è¿›è¡Œè®¡ç®—ã€‚æ™ºèƒ½ä½“ä¸éœ€è¦å®æ—¶åœ°ä¸ç¯å¢ƒäº¤äº’å°±èƒ½çŸ¥é“æœªæ¥ç¯å¢ƒï¼Œåªéœ€è¦çŸ¥é“å½“å‰çš„çŠ¶æ€ï¼Œå°±èƒ½å¤Ÿå¼€å§‹æ€è€ƒï¼Œæ¥å¯»æ‰¾æœ€ä¼˜è§£ã€‚</li> <li>åœ¨<strong>å­¦ä¹ </strong>ä¸­ï¼Œè§„åˆ™æ˜¯ç¡®å®šçš„ï¼Œæˆ‘ä»¬çŸ¥é“é€‰æ‹©å·¦ä¹‹åç¯å¢ƒå°†ä¼šäº§ç”Ÿä»€ä¹ˆå˜åŒ–ã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡å·²çŸ¥çš„è§„åˆ™ï¼Œæ¥åœ¨å†…éƒ¨æ¨¡æ‹Ÿæ•´ä¸ªå†³ç­–è¿‡ç¨‹ï¼Œæ— éœ€ä¸ç¯å¢ƒäº¤äº’ã€‚ ä¸€ä¸ªå¸¸ç”¨çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜è§£å†³æ€è·¯æ˜¯ï¼Œå…ˆå­¦ä¹ ç¯å¢ƒå¦‚ä½•å·¥ä½œï¼Œä¹Ÿå°±æ˜¯äº†è§£ç¯å¢ƒå·¥ä½œçš„æ–¹å¼ï¼Œå³å­¦ä¹ å¾—åˆ°ä¸€ä¸ªæ¨¡å‹ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªæ¨¡å‹è¿›è¡Œè§„åˆ’ã€‚</li> </ol> <h2 id="52-æ¢ç´¢å’Œåˆ©ç”¨">5.2 æ¢ç´¢å’Œåˆ©ç”¨</h2> <p>åœ¨å¼ºåŒ–å­¦ä¹ é‡Œé¢ï¼Œæ¢ç´¢å’Œåˆ©ç”¨æ˜¯ä¸¤ä¸ªå¾ˆæ ¸å¿ƒçš„é—®é¢˜ã€‚</p> <ol> <li><strong>æ¢ç´¢</strong>å³æˆ‘ä»¬å»æ¢ç´¢ç¯å¢ƒï¼Œé€šè¿‡å°è¯•ä¸åŒçš„åŠ¨ä½œæ¥å¾—åˆ°æœ€ä½³çš„ç­–ç•¥ï¼ˆå¸¦æ¥æœ€å¤§å¥–åŠ±çš„ç­–ç•¥ï¼‰ã€‚</li> <li><strong>åˆ©ç”¨</strong>å³æˆ‘ä»¬ä¸å»å°è¯•æ–°çš„åŠ¨ä½œï¼Œè€Œæ˜¯é‡‡å–å·²çŸ¥çš„å¯ä»¥å¸¦æ¥å¾ˆå¤§å¥–åŠ±çš„åŠ¨ä½œã€‚</li> </ol> <p>åœ¨åˆšå¼€å§‹çš„æ—¶å€™ï¼Œå¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“ä¸çŸ¥é“å®ƒé‡‡å–äº†æŸä¸ªåŠ¨ä½œåä¼šå‘ç”Ÿä»€ä¹ˆï¼Œæ‰€ä»¥å®ƒåªèƒ½é€šè¿‡è¯•é”™å»æ¢ç´¢ï¼Œæ‰€ä»¥æ¢ç´¢å°±æ˜¯é€šè¿‡è¯•é”™æ¥ç†è§£é‡‡å–çš„åŠ¨ä½œåˆ°åº•å¯ä¸å¯ä»¥å¸¦æ¥å¥½çš„å¥–åŠ±ã€‚åˆ©ç”¨æ˜¯æŒ‡æˆ‘ä»¬ç›´æ¥é‡‡å–å·²çŸ¥çš„å¯ä»¥å¸¦æ¥å¾ˆå¥½å¥–åŠ±çš„åŠ¨ä½œã€‚æ‰€ä»¥è¿™é‡Œå°±é¢ä¸´ä¸€ä¸ªæƒè¡¡é—®é¢˜ï¼Œå³æ€ä¹ˆé€šè¿‡ç‰ºç‰²ä¸€äº›çŸ­æœŸçš„å¥–åŠ±æ¥ç†è§£åŠ¨ä½œï¼Œä»è€Œå­¦ä¹ åˆ°æ›´å¥½çš„ç­–ç•¥ã€‚</p>]]></content><author><name></name></author><category term="Reinforcement-Learning"/><category term="intro"/><summary type="html"><![CDATA[RL Overview]]></summary></entry><entry><title type="html">Statistical Learning</title><link href="https://gszfwsb.github.io/blog/2022/STL/" rel="alternate" type="text/html" title="Statistical Learning"/><published>2022-05-01T00:00:00+00:00</published><updated>2022-05-01T00:00:00+00:00</updated><id>https://gszfwsb.github.io/blog/2022/STL</id><content type="html" xml:base="https://gszfwsb.github.io/blog/2022/STL/"><![CDATA[<p>STATS_LEARNING course note</p>]]></content><author><name></name></author><summary type="html"><![CDATA[CS7335 2022 course note]]></summary></entry></feed>