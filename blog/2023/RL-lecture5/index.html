<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>ç¬¬äº”ç«  Policy Optimization Foundation (ç­–ç•¥ä¼˜åŒ–åŸºç¡€ç¯‡) | Shaobo Wang</title> <meta name="author" content="Steven Shaobo Wang"> <meta name="description" content="PO"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%A8%F0%9F%8F%BB%E2%80%8D%F0%9F%8E%93&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://gszfwsb.github.io/blog/2023/RL-lecture5/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="//">Shaobo Wang</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">ç¬¬äº”ç«  Policy Optimization Foundation (ç­–ç•¥ä¼˜åŒ–åŸºç¡€ç¯‡)</h1> <p class="post-meta">October 30, 2023</p> <p class="post-tags"> <a href="//blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a> Â  Â· Â  <a href="//blog/tag/intro"> <i class="fas fa-hashtag fa-sm"></i> intro</a> Â  Â  Â· Â  <a href="//blog/category/reinforcement-learning"> <i class="fas fa-tag fa-sm"></i> Reinforcement-Learning</a> Â  </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h1"><a href="#%E4%B8%80%E5%9F%BA%E4%BA%8E%E7%AD%96%E7%95%A5%E7%9A%84%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0">ä¸€ã€åŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ </a></li> <li class="toc-entry toc-h1"> <a href="#%E4%BA%8Cmc%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6">äºŒã€MCç­–ç•¥æ¢¯åº¦</a> <ul> <li class="toc-entry toc-h2"><a href="#21-%E7%AD%96%E7%95%A5%E4%BC%98%E5%8C%96">2.1 ç­–ç•¥ä¼˜åŒ–</a></li> <li class="toc-entry toc-h2"><a href="#22-%E5%8D%95%E6%AD%A5mdp%E7%9A%84%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6">2.2 å•æ­¥MDPçš„ç­–ç•¥æ¢¯åº¦</a></li> <li class="toc-entry toc-h2"><a href="#23-%E5%A4%9A%E6%AD%A5mdp%E7%9A%84%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6">2.3 å¤šæ­¥MDPçš„ç­–ç•¥æ¢¯åº¦</a></li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#%E4%B8%89%E5%87%8F%E5%B0%91%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6%E7%9A%84%E6%96%B9%E5%B7%AE">ä¸‰ã€å‡å°‘ç­–ç•¥æ¢¯åº¦çš„æ–¹å·®</a> <ul> <li class="toc-entry toc-h2"><a href="#31-%E7%90%86%E8%A7%A3%E6%A2%AF%E5%BA%A6%E4%BC%98%E5%8C%96%E7%9A%84%E8%BF%87%E7%A8%8B">3.1 ç†è§£æ¢¯åº¦ä¼˜åŒ–çš„è¿‡ç¨‹</a></li> <li class="toc-entry toc-h2"><a href="#32-%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6%E4%B8%AD%E6%96%B9%E5%B7%AE%E8%BE%83%E5%A4%A7%E7%9A%84%E9%97%AE%E9%A2%98">3.2 ç­–ç•¥æ¢¯åº¦ä¸­æ–¹å·®è¾ƒå¤§çš„é—®é¢˜</a></li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#%E5%9B%9B%E6%BC%94%E5%91%98-%E8%AF%84%E8%AE%BA%E5%91%98">å››ã€æ¼”å‘˜-è¯„è®ºå‘˜</a> <ul> <li class="toc-entry toc-h2"><a href="#41-%E5%8A%A8%E4%BD%9C%E4%BB%B7%E5%80%BC%E5%8A%A8%E4%BD%9C%E8%AF%84%E8%AE%BA%E5%91%98%E7%AE%97%E6%B3%95qac">4.1 åŠ¨ä½œä»·å€¼åŠ¨ä½œè¯„è®ºå‘˜ç®—æ³•(QAC)</a></li> <li class="toc-entry toc-h2"><a href="#42-%E5%B8%A6basline%E7%9A%84%E6%BC%94%E5%91%98-%E8%AF%84%E8%AE%BA%E5%91%98%E7%AE%97%E6%B3%95a2c--tdac">4.2 å¸¦baslineçš„æ¼”å‘˜-è¯„è®ºå‘˜ç®—æ³•(A2C &amp; TDAC)</a></li> </ul> </li> <li class="toc-entry toc-h1"><a href="#%E4%BA%94%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6%E5%B0%8F%E7%BB%93">äº”ã€ç­–ç•¥æ¢¯åº¦å°ç»“</a></li> </ul> </div> <hr> <div id="markdown-content"> <h1 id="ä¸€åŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ ">ä¸€ã€åŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ </h1> <ol> <li>åŸºäºä»·å€¼çš„RLå’ŒåŸºäºç­–ç•¥çš„RLæœ‰ä½•åŒºåˆ«ï¼Ÿ <ol> <li> <p><strong>å†³å®šæ€§ç­–ç•¥</strong>æ˜¯ç›´æ¥é€šè¿‡è´ªå¿ƒç®—æ³•ï¼Œç”±ä»·å€¼å‡½æ•°ç”Ÿæˆæˆ‘ä»¬åº”è¯¥é‡‡å–çš„åŠ¨ä½œï¼š</p> \[a_t=\arg\max_a Q\left(a, s_t\right)\] </li> <li> <p><strong>éšæœºæ€§ç­–ç•¥</strong>ï¼šæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å»ºæ¨¡ç­–ç•¥å‡½æ•°ä¸ºä¸€ä¸ªå‚æ•°åŒ–æ¦‚ç‡åˆ†å¸ƒ\(\pi_{\theta}(a\mid s)\)ï¼Œå‚æ•°ä¸º\(\theta\)</p> </li> </ol> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3. å¯¹æ¯”ï¼š
    
    
    | åŸºäºä»·å€¼çš„RL | åŸºäºç­–ç•¥çš„RL | æ¼”å‘˜-è¯„è®ºå‘˜ |
    | --- | --- | --- |
    | å­¦ä¹ ä»·å€¼å‡½æ•° | æ²¡æœ‰ä»·å€¼å‡½æ•° | åŒæ—¶å­¦ç­–ç•¥å’Œä»·å€¼å‡½æ•° |
    | é€šè¿‡ä»·å€¼å‡½æ•°å¾—åˆ°éšå¼çš„ç­–ç•¥ | ç›´æ¥å­¦ä¹ ç­–ç•¥ |  | 2. policy-based RLç‰¹ç‚¹: æœ‰ç‚¹ç±»ä¼¼ç›‘ç£å­¦ä¹ 
1. ä¼˜åŠ¿ï¼š
    1. æ›´å¥½çš„æ”¶æ•›æ€§ï¼šå¯ä»¥ä¿è¯æ”¶æ•›ï¼Œè‡³å°‘æ˜¯local optimum
    2. ç­–ç•¥æ¢¯åº¦åœ¨é«˜ç»´åŠ¨ä½œç©ºé—´æ˜¯æ›´æœ‰æ•ˆçš„
    3. ç­–ç•¥æ¢¯åº¦å¯ä»¥å­¦ä¹ éšæœºç­–ç•¥ï¼Œä½†æ˜¯ä»·å€¼å‡½æ•°ä¸èƒ½ã€‚
2. åŠ£åŠ¿ï¼š
    1. ç»å¸¸ä¼šæ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜è§£
    2. ç­–ç•¥è¯„ä¼°ä¼šæœ‰å¾ˆå¤§çš„æ–¹å·®
</code></pre></div></div> <h1 id="äºŒmcç­–ç•¥æ¢¯åº¦">äºŒã€MCç­–ç•¥æ¢¯åº¦</h1> <h2 id="21-ç­–ç•¥ä¼˜åŒ–">2.1 ç­–ç•¥ä¼˜åŒ–</h2> <ol> <li>ç­–ç•¥ä¼˜åŒ–ç›®æ ‡ï¼šç»™å®šä¸€ä¸ªå¸¦å‚ \(\theta\) ç­–ç•¥è¿‘ä¼¼å™¨ \(\pi_{\theta}(s,a)\)ï¼Œæ‰¾åˆ°æœ€ä¼˜\(\theta\)</li> <li>å¦‚ä½•è¡¡é‡ç­–ç•¥ \(\pi_{\theta}(s,a)\) çš„è´¨é‡ï¼Ÿ <ol> <li> <p>åœ¨ç¦»æ•£ï¼ˆæœ‰è½®æ•°ï¼‰ç¯å¢ƒä¸­æˆ‘ä»¬ç”¨<strong>å¼€å§‹ä»·å€¼</strong></p> \[J_1(\theta)=V^{\pi_\theta}\left(s_1\right)=\mathbb{E}_{\pi_\theta}\left[v_1\right]\] </li> <li> <p>åœ¨è¿ç»­çš„ç¯å¢ƒï¼ˆæ²¡æœ‰ç»ˆæ­¢ï¼‰æˆ‘ä»¬å¯ä»¥ç”¨<strong>ä»·å€¼å‡å€¼</strong>æˆ–è€…<strong>å›æŠ¥å‡å€¼</strong></p> <ul> <li> <p>ä»·å€¼å‡å€¼ï¼š</p> \[J_{a v V}(\theta)=\sum_s d^{\pi_\theta}(s) V^{\pi_\theta}(s)\] </li> <li> <p>å›æŠ¥å‡å€¼ï¼š</p> \[J_{a v R}(\theta)=\sum_s d^{\pi_\theta}(s) \sum_a \pi_\theta(s, a) R(s, a)\] <p>å…¶ä¸­\(\pi_\theta\)çš„é©¬å°”å¯å¤«åˆ†å¸ƒç¨³æ€åˆ†å¸ƒæ˜¯\(d^{\pi_\theta}\)ã€‚</p> </li> </ul> </li> </ol> </li> <li> <p>ç­–ç•¥ä»·å€¼ï¼šå’Œæˆ‘ä»¬åœ¨åŸºäºä»·å€¼çš„RLä¸­å®šä¹‰ä¸€æ ·ã€‚</p> \[\begin{aligned}J(\theta) &amp; =\mathbb{E}_{\tau \sim \pi_\theta}\left[\sum_t R\left(s_t^\tau, a_t^\tau\right)\right] \\&amp; \approx \frac{1}{m} \sum_m \sum_t R\left(s_t^m, a_t^m\right)\end{aligned}\] <ul> <li>\(\tau\)æ˜¯æˆ‘ä»¬ä»ç­–ç•¥å‡½æ•°\(\pi_\theta\)ä¸­çš„é‡‡æ ·è½¨è¿¹</li> <li>æˆ‘ä»¬å¿½ç•¥æŠ˜æ‰£</li> </ul> </li> <li> <p>åŸºäºç­–ç•¥çš„RLçš„ç›®æ ‡ï¼šæ‰¾åˆ°å‚æ•°ä½¿å¾—\(J(\theta)\)æœ€å¤§åŒ–</p> \[\theta^*=\underset{\theta}{\arg \max } \mathbb{E}_{\tau \sim \pi_\theta}\left[\sum_t R\left(s_t^\tau, a_t^\tau\right)\right]\] <ul> <li>å¦‚æœ\(J(\theta)\)å¯å¾®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŸºäºæ¢¯åº¦çš„æ–¹æ³•è§£</li> </ul> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%201-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%201-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%201-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%201.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <ul> <li>å¦‚æœ\(J(\theta)\)ä¸å¯å¾®æˆ–è€…éš¾ä»¥æ±‚å¯¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›ä¸ç”¨æ¢¯åº¦çš„é»‘ç›’ä¼˜åŒ–æ–¹æ³•ï¼š äº¤å‰ç†µæ³• (CEM)</li> </ul> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%202-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%202-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%202-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%202.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>æœ‰é™å·®åˆ†</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%203-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%203-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%203-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%203.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <ol> <li>è®¡ç®—ç­–ç•¥æ¢¯åº¦ï¼š <ol> <li>å‡è®¾ç­–ç•¥é0æ—¶å¤„å¤„å¯å¾®ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¢¯åº¦\(\nabla_\theta \pi_\theta(s, a)\)</li> <li> <p>ä¸€ä¸ªè®¡ç®—trick (likelihood ratios)ï¼šä¼˜åŒ–ç›®æ ‡å°±æ˜¯\(\nabla_\theta \log \pi_\theta(s, a)\)</p> \[\textcolor{blue}{\begin{aligned}\nabla_\theta \pi_\theta(s, a) &amp; =\pi_\theta(s, a) \frac{\nabla_\theta \pi_\theta(s, a)}{\pi_\theta(s, a)} \\&amp; =\pi_\theta(s, a) \nabla_\theta \log \pi_\theta(s, a)\end{aligned}}\] </li> </ol> <ul> <li> <p>ä¾‹1ï¼šé«˜æ–¯ç­–ç•¥</p> <p>åœ¨è¿ç»­åŠ¨ä½œç©ºé—´ï¼Œä¸€ä¸ªé«˜æ–¯ç­–ç•¥çš„å®šä¹‰ååˆ†è‡ªç„¶ã€‚å…¶å‡å€¼æ˜¯çŠ¶æ€ç‰¹å¾çš„çº¿æ€§ç»„åˆï¼š\(\mu(s)=\phi(s)^T \theta\)ã€‚æ–¹å·®å¯ä»¥æ˜¯å‚æ•°åŒ–çš„ä¹Ÿå¯ä»¥æ˜¯å¸¸æ•°ã€‚ç­–ç•¥æ˜¯è¿ç»­ã€é«˜æ–¯çš„ï¼Œå³\(a \sim \mathcal{N}\left(\mu(s), \sigma^2\right)\)</p> <p>é‚£ä¹ˆåˆ†æ•°ä¸ºï¼š</p> \[\nabla_\theta \log \pi_\theta(s, a)=\frac{(a-\mu(s)) \phi(s)}{\sigma^2}\] </li> <li> <p>ä¾‹2ï¼šsoftmaxç­–ç•¥</p> <p>ç®€å•ç­–ç•¥æ¨¡å‹ï¼Œç”¨ç‰¹å¾çº¿æ€§ç»„åˆä½œä¸ºåŠ¨ä½œæƒé‡ã€‚å…¶åŠ¨ä½œæ¦‚ç‡å’Œæƒé‡å¤§å°æŒ‡æ•°æˆæ­£æ¯”ï¼Œå³</p> \[\pi_\theta(s, a)=\frac{\exp ^{\phi(s, a)^T \theta}}{\sum_{a^{\prime}} \exp ^{\phi\left(s, a^{\prime}\right)^T \theta}}\] <p>é‚£ä¹ˆåˆ†æ•°ä¸ºï¼š</p> \[\nabla_\theta \log \pi_\theta(s, a)=\phi(s, a)-\mathbb{E}_{\pi_\theta}[\phi(s, .)]\] </li> </ul> </li> </ol> <h2 id="22-å•æ­¥mdpçš„ç­–ç•¥æ¢¯åº¦">2.2 å•æ­¥MDPçš„ç­–ç•¥æ¢¯åº¦</h2> <p>è€ƒè™‘å•æ­¥MDPçš„ç®€å•æƒ…å†µï¼š ä»çŠ¶æ€\(s\sim d(s)\)å¼€å§‹ï¼Œåˆ°ä¸€ä¸ªæ—¶é—´å•ä½åç»“æŸï¼Œå¥–åŠ±ä¸º\(r=R(s,a)\)ã€‚æˆ‘ä»¬ç”¨ä¼¼ç„¶æ¯”ä¾‹å»è®¡ç®—ç­–ç•¥æ¢¯åº¦ï¼š</p> \[\begin{aligned}J(\theta) =\mathbb{E}_{\pi_\theta}[r] =\sum_{s \in \mathcal{S}} d(s) \sum_{a \in \mathcal{A}} \pi_\theta(s, a) r\end{aligned}\] <p>å…¶æ¢¯åº¦ä¸ºï¼š</p> \[\begin{aligned}\nabla_\theta J(\theta) &amp; =\sum_{s \in \mathcal{S}} d(s) \sum_{a \in \mathcal{A}} \pi_\theta(s, a) \nabla_\theta \log \pi_\theta(s, a) r \\&amp; =\mathbb{E}_{\pi_\theta}\left[r \nabla_\theta \log \pi_\theta(s, a)\right]\end{aligned}\] <h2 id="23-å¤šæ­¥mdpçš„ç­–ç•¥æ¢¯åº¦">2.3 å¤šæ­¥MDPçš„ç­–ç•¥æ¢¯åº¦</h2> <ol> <li>ä¸€å›åˆçš„è½¨è¿¹å¯ä»¥è¡¨ç¤ºä¸ºï¼š\(\tau=\left(s_0, a_0, r_1, \ldots s_{T-1}, a_{T-1}, r_T, s_T\right) \sim\left(\pi_\theta, P\left(s_{t+1} \mid s_t, a_t\right)\right)\)</li> <li>å…¶è½¨è¿¹çš„å¥–åŠ±ä¸º\(R(\tau)=\sum_{t=0}^{T-1} R\left(s_t, a_t\right)\)</li> <li> <p>ç­–ç•¥ç›®æ ‡ä¸ºï¼š</p> \[J(\theta)=\mathbb{E}_{\pi_\theta}\left[\sum_{t=0}^{T-1} R\left(s_t, a_t\right)\right]=\sum_\tau P(\tau;\theta) R(\tau)\] <table> <tbody> <tr> <td>å…¶ä¸­$$P(\tau;\theta)=d(s_0)\pi_{\theta}(a_0</td> <td>s_0)p(s_1</td> <td>s_0,a_0)\cdots \pi_{\theta}(a_{T-1}</td> <td>s_{T-1})p(s_T</td> <td>s_{T-1},a_{T-1})=d\left(s_0\right) \prod_{t=0}^{T-1} \pi_\theta\left(a_t \mid s_t\right) p\left(s_{t+1} \mid s_t, a_t\right)\(è¡¨ç¤ºæ‰§è¡Œç­–ç•¥\)\pi_\theta$$æ—¶åœ¨è½¨è¿¹ä¸­çš„æ¦‚ç‡</td> </tr> </tbody> </table> </li> <li> <p>æ€»ä½“ç›®æ ‡ï¼šmax \(J(\theta)\)</p> \[\theta^*=\underset{\theta}{\arg \max } J(\theta)=\underset{\theta}{\arg \max } \sum_\tau P(\tau;\theta) R(\tau)\] </li> <li> <p>è®¡ç®—æ¢¯åº¦ï¼š</p> \[\begin{aligned}\nabla_\theta J(\theta) &amp; =\nabla_\theta \sum_\tau P(\tau;\theta) R(\tau) \\&amp; =\sum_\tau \nabla_\theta P(\tau;\theta) R(\tau) \\&amp; =\sum_\tau \frac{P(\tau;\theta)}{P(\tau;\theta)} \nabla_\theta P(\tau;\theta) R(\tau) \\&amp; =\sum_\tau P(\tau;\theta) R(\tau) \frac{\nabla_\theta P(\tau;\theta)}{P(\tau;\theta)} \\&amp; =\sum_\tau P(\tau;\theta) R(\tau) \nabla_\theta \log P(\tau;\theta)\end{aligned}\] </li> <li> <p>ç»éªŒä¼°è®¡ç­–ç•¥ï¼Œè¿‘ä¼¼ï¼š</p> \[\nabla_\theta J(\theta) \approx \frac{1}{m} \sum_{i=1}^m R\left(\tau_i\right) \nabla_\theta \log P\left(\tau_i;\theta\right)\] </li> <li> <p>åˆ†è§£è½¨è¿¹ä¸ºçŠ¶æ€å’ŒåŠ¨ä½œ \(\nabla_\theta \log P(\tau;\theta)\)</p> \[\begin{aligned}\nabla_\theta \log P(\tau;\theta) &amp; =\nabla_\theta \log \left[d\left(s_0\right) \prod_{t=0}^{T-1} \pi_\theta\left(a_t \mid s_t\right) p\left(s_{t+1} \mid s_t, a_t\right)\right] \\&amp; =\nabla_\theta\left[\log d\left(s_0\right)+\sum_{t=0}^{T-1} \log \pi_\theta\left(a_t \mid s_t\right)+\log p\left(s_{t+1} \mid s_t, a_t\right)\right] \\&amp; =\sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\end{aligned}\] \[\textcolor{blue}{\nabla_\theta J(\theta) \approx \frac{1}{m} \sum_{i=1}^m R\left(\tau_i\right) \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t^i \mid s_t^i\right)}\] <p>æˆ‘ä»¬ä¸éœ€è¦çŸ¥é“<strong>è½¬ç§»æ¨¡å‹</strong>ã€‚</p> </li> </ol> <h1 id="ä¸‰å‡å°‘ç­–ç•¥æ¢¯åº¦çš„æ–¹å·®">ä¸‰ã€å‡å°‘ç­–ç•¥æ¢¯åº¦çš„æ–¹å·®</h1> <h2 id="31-ç†è§£æ¢¯åº¦ä¼˜åŒ–çš„è¿‡ç¨‹">3.1 ç†è§£æ¢¯åº¦ä¼˜åŒ–çš„è¿‡ç¨‹</h2> <p>æˆ‘ä»¬è€ƒå¯Ÿçš„æ¢¯åº¦æ˜¯\(E_{\tau \sim \pi_\theta}[R(\tau)]\).æ›´ä¸€èˆ¬çš„ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è®¡ç®—å‡½æ•°\(f(x)\)çš„æœŸæœ›ï¼Œæˆ‘ä»¬æœ‰ï¼š</p> \[\begin{aligned}\nabla_\theta \mathbb{E}_{p(x;\theta)}[f(x)] &amp; =\mathbb{E}_{p(x;\theta)}\left[f(x) \nabla_\theta \log p(x;\theta)\right] \\&amp; \approx \frac{1}{S} \sum_{s=1}^S f\left(x_s\right) \nabla_\theta \log p\left(x_s;\theta\right), \text { where } x_s \sim p(x;\theta)\end{aligned}\] <ol> <li>å¦‚ä½•ç†è§£æ¢¯åº¦ï¼š <ol> <li>ç§»åŠ¨åˆ†å¸ƒ\(p\)ï¼ˆä¼˜åŒ–å‚æ•°\(\theta\)ï¼‰ä½¿å¾—å…¶æœªæ¥çš„æ ·æœ¬\(x\)å¯ä»¥å¾—åˆ°æ›´é«˜çš„åˆ†æ•°</li> <li>å‘é‡\(f(x)\nabla_\theta \log p(x;\theta)\)æŠŠæ ·æœ¬çš„log-likelihoodæ¨å‘ä¸€ä¸ªè¡¨ç¤ºå®ƒçš„åˆ†æ•°ã€‚</li> </ol> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%204-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%204-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%204-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%204.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <ol> <li>ä¸æå¤§ä¼¼ç„¶æ¯”è¾ƒï¼š <ol> <li> <p>ç­–ç•¥æ¢¯åº¦ä¼°è®¡ï¼š</p> \[\nabla_\theta J(\theta) \approx \frac{1}{M} \sum_{m=1}^M\left(\sum_{t=1}^T \nabla_\theta \log \pi_\theta\left(a_{t, m} \mid s_{t, m}\right)\right)\textcolor{red}{\left(\sum_{t=1}^T r\left(s_{t, m}, a_{t, m}\right)\right)}\] </li> <li> <p>æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š</p> \[\nabla_\theta J_{M L}(\theta) \approx \frac{1}{M} \sum_{m=1}^M\left(\sum_{t=1}^T \nabla_\theta \log \pi_\theta\left(a_{t, m} \mid s_{t, m}\right)\right)\] </li> </ol> <p>ä¸»è¦åŒºåˆ«ï¼š<strong>ç»™å¥½çš„åŠ¨ä½œæ›´å¤§çš„å¯èƒ½æ€§ï¼Œç»™ä¸å¥½çš„åŠ¨ä½œæ›´å°çš„å¯èƒ½æ€§</strong></p> </li> </ol> <h2 id="32-ç­–ç•¥æ¢¯åº¦ä¸­æ–¹å·®è¾ƒå¤§çš„é—®é¢˜">3.2 ç­–ç•¥æ¢¯åº¦ä¸­æ–¹å·®è¾ƒå¤§çš„é—®é¢˜</h2> <ol> <li> <p>æˆ‘ä»¬çš„ä¼˜åŒ–å¦‚ä¸‹ï¼š</p> \[\nabla_\theta J(\theta) \approx \frac{1}{m} \sum_{i=1}^m R\left(\tau_i\right) \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t^i \mid s_t^i\right)\] <ul> <li>å°½ç®¡æ˜¯Unbiasedï¼Œä½†æ˜¯å¾ˆNoisy</li> <li>å¦‚ä½•ä¿®æ”¹ï¼Ÿ <ul> <li>ç”¨æ—¶é—´å› æœ</li> <li>å¼•å…¥baseline</li> </ul> </li> </ul> </li> <li> <p>é€šè¿‡æ—¶é—´å› æœè§£å†³å¤§æ–¹å·®é—®é¢˜ï¼š</p> <ol> <li>æ­¤å‰æˆ‘ä»¬æœ‰ï¼š\(\nabla_\theta \mathbb{E}_\tau[R]=\mathbb{E}_\tau \left[\left(\sum_{t=0}^{T-1} r_t\right)\left(\sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right)\right]\)</li> <li> <p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°æŸä¸€æ—¶åˆ»çš„å•ä¸€å¥–åŠ±ï¼š</p> \[\nabla_\theta \mathbb{E}_\tau\left[r_{t^{\prime}}\right]=\mathbb{E}_\tau\left[r_{t^{\prime}} \sum_{t=0}^{t^{\prime}} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] </li> <li> <p>é€šè¿‡å¯¹\(t\)æ±‚å’Œï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š</p> \[\begin{aligned}\nabla_\theta J(\theta)=\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R] &amp; =\mathbb{E}_\tau\left[\sum_{t^{\prime}=0}^{T-1} r_{t^{\prime}} \sum_{t=0}^{t^{\prime}} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right] \\&amp; =\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right) \sum_{\textcolor{red}{t^{\prime}=t}}^{T-1} r_{t^{\prime}}\right] \\&amp; =\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} G_t \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\end{aligned}\] </li> <li> <p>å› æ­¤æˆ‘ä»¬æœ‰ï¼š</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} G_t \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] <ul> <li>\(G_t=\sum_{t^{\prime}=t}^{T-1} r_{t^{\prime}}\) æ˜¯\(t\)æ­¥è½¨è¿¹ä¸­çš„å›æŠ¥</li> <li>å› æœï¼šæ—¶é—´é åçš„ç­–ç•¥ä¸èƒ½å½±å“æ—¶é—´é å‰çš„ç­–ç•¥</li> <li>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„ä¼°è®¡æ›´æ–°ï¼š</li> </ul> \[\nabla_\theta \mathbb{E}[R] \approx \frac{1}{m} \sum_{i=1}^m \sum_{t=0}^{T-1} G_t^{(i)} \cdot \nabla_\theta \log \pi_\theta\left(a_t^i \mid s_t^i\right)\] </li> </ol> <p>ğŸ˜ ä¾‹ï¼š<strong>REINFORCE: ä¸€ç§MCç­–ç•¥æ¢¯åº¦ç®—æ³•</strong></p> <p>ç®—æ³•ç®€å•ä»ç­–ç•¥ä¸­é‡‡æ ·å¤šä¸ªè½¨è¿¹çš„æ ·æœ¬ï¼Œå¹¶ä¸”åŒæ—¶æ›´æ–°\(\theta\)å‚æ•°ï¼š</p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%205-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%205-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%205-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%205.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <ol> <li>é€šè¿‡å¼•å…¥baselineè§£å†³æ–¹å·®å¤§çš„é—®é¢˜ï¼š <ol> <li> <p>åŸå§‹æ›´æ–°ï¼š\(G_t=\sum_{t^{\prime}=t}^{T-1} r_{t^{\prime}}\)å¯èƒ½æœ‰å¾ˆå¤§çš„æ–¹å·®</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \textcolor{red}{G_t} \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] </li> <li> <p>å¯ä»¥é€šè¿‡å‡å»ä¸€ä¸ªbaselineæ¥å‡å°æ–¹å·®</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \textcolor{red}{(G_t-b(s_t))} \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] </li> <li> <p>ä¸€ä¸ªå¥½çš„baselineå°±æ˜¯æœŸæœ›å¥–åŠ±ï¼š</p> \[b\left(s_t\right)=\mathbb{E}\left[r_t+r_{t+1}+\ldots+r_{T-1}\right]\] </li> <li> <p>è§£é‡Šï¼šæˆ‘ä»¬ä¼˜åŒ–çš„ä¸å†æ˜¯\(G_t\)æœ¬èº«ï¼Œè€Œæ˜¯\(G_t\)å¯ä»¥æ¯”baselineå¥½å¤šå°‘ã€‚å¯ä»¥è¯æ˜è¿™æ ·å¯ä»¥é™ä½æ–¹å·®ï¼š</p> \[\begin{aligned}\mathbb{E}_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right) b\left(s_t\right)\right] &amp; =0, \\E_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\left(G_t-b\left(s_t\right)\right)\right] &amp; =E_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right) G_t\right] \\\operatorname{Var}_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\left(G_t-b\left(s_t\right)\right)\right] &amp; &lt;\operatorname{Var}_\tau\left[\nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right) G_t\right]\end{aligned}\] </li> <li> <p>åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™baselineä¸€ä¸ªå‚æ•°æ¥è¿›è¡Œå­¦ä¹ ï¼š</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \textcolor{red}{(G_t-b_{\mathbf{w}}(s_t))} \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] <p>\(\mathbf{w}\)ç”¨äºè®­ç»ƒbaselineï¼Œå› æ­¤æˆ‘ä»¬æœ‰ä¸¤å¥—å‚æ•°ï¼š\(\mathbf{w}\)å’Œ\(\theta\).</p> </li> </ol> <p>ğŸ˜ å¸¦æœ‰baselineçš„ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼š</p> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%206-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%206-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%206-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%206.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h1 id="å››æ¼”å‘˜-è¯„è®ºå‘˜">å››ã€<strong>æ¼”å‘˜-è¯„è®ºå‘˜</strong> </h1> <ol> <li> <p>é™¤äº†å¼•å…¥baselineå’Œæ—¶é—´å› æœï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å¼•å…¥Criticçš„æ–¹å¼æ¥é™ä½æ–¹å·®ï¼Œè¿™å°±å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç®—æ³•ã€‚</p> \[\nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta}[R]=\mathbb{E}_\tau\left[\sum_{t=0}^{T-1} \textcolor{red}{G_t} \cdot \nabla_\theta \log \pi_\theta\left(a_t \mid s_t\right)\right]\] <ul> <li>å®è·µä¸Š\(G_t\)æ˜¯MCç­–ç•¥æ¢¯åº¦çš„ä¸€ä¸ªæ ·æœ¬ï¼Œæ˜¯å¯¹\(Q^{\pi_\theta}(s_t,a_t)\)çš„ä¸€ä¸ªunbiased noisyä¼°è®¡ã€‚</li> <li> <p>å®é™…ä¸Šæˆ‘ä»¬å¯ä»¥ä¸ç”¨\(G_t\)ï¼Œè€Œç”¨ä¸€ä¸ªè¯„è®ºå‘˜å»ä¼°è®¡Qå‡½æ•°ã€‚</p> \[Q_{\mathbf{w}}(s, a) \approx Q^{\pi_\theta}(s, a)\] \[\nabla_\theta J(\theta)=\mathbb{E}_{\pi_\theta}\left[\sum_{t=0}^{T-1} Q_{\textcolor{red}{\mathbf{w}}}\left(s_t, a_t\right) \cdot \nabla_\theta \log \pi_{\textcolor{red}\theta}\left(a_t \mid s_t\right)\right]\] </li> </ul> </li> <li> <p>ä¸Šå¼å°±æ˜¯Actor-Criticç­–ç•¥æ¢¯åº¦ï¼š</p> <ul> <li>Actorï¼špolicy functionï¼Œç”¨äºç”ŸæˆåŠ¨ä½œï¼Œå­¦ä¹ å‚æ•°\(\theta\)</li> <li> <p>Criticï¼švalue functionï¼Œè¡¡é‡åŠ¨ä½œçš„å›æŠ¥ï¼Œå­¦ä¹ å‚æ•°\(\mathbf{w}\)</p> <blockquote> <p>Criticï¼šç±»ä¼¼äºç­–ç•¥è¯„ä¼°çš„ä½œç”¨</p> </blockquote> </li> </ul> </li> </ol> <h2 id="41-åŠ¨ä½œä»·å€¼åŠ¨ä½œè¯„è®ºå‘˜ç®—æ³•qac">4.1 åŠ¨ä½œä»·å€¼åŠ¨ä½œè¯„è®ºå‘˜ç®—æ³•(QAC)</h2> <ol> <li> <p>ç”¨ä¸€ä¸ªçº¿æ€§ä»·å€¼å‡½æ•°è¿‘ä¼¼ï¼š</p> \[Q_{\mathbf{w}}(s, a)=\psi(s, a)^T \mathbf{w}\] <p>å…¶ä¸­ï¼Œè¯„è®ºå‘˜ç”¨ä¸€ä¸ªçº¿æ€§TD(0)æ¥æ›´æ–°å‚æ•°\(\mathbf{w}\)ï¼ŒäºŒæ¼”å‘˜é€šè¿‡ç­–ç•¥æ¢¯åº¦æ›´æ–°å‚æ•°\(\theta\).</p> </li> <li>å…·ä½“ç®—æ³•æµç¨‹ï¼š</li> <li>æ¼”å‘˜-è¯„è®ºå‘˜å‡½æ•°è¿‘ä¼¼æ–¹æ³•ï¼š</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%207-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%207-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%207-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%207.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>æˆ‘ä»¬å¯ä»¥æœ‰ä¸¤ä¸ªä¸åŒçš„å‡½æ•°æ¥è¿‘ä¼¼ç­–ç•¥å‡½æ•°å’Œä»·å€¼å‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªå…±äº«çš„ç½‘ç»œæ¥æ¶‰åŠåŒæ—¶å¾—åˆ°ä¸¤ä¸ªå‡½æ•°ã€‚</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%208-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%208-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%208-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%208.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="42-å¸¦baslineçš„æ¼”å‘˜-è¯„è®ºå‘˜ç®—æ³•a2c--tdac">4.2 å¸¦baslineçš„æ¼”å‘˜-è¯„è®ºå‘˜ç®—æ³•(A2C &amp; TDAC)</h2> <ol> <li> <p>æˆ‘ä»¬å®šä¹‰Qå‡½æ•°å¦‚ä¸‹ï¼š</p> \[Q^{\pi, \gamma}(s, a)=\mathbb{E}_\pi\left[r_1+\gamma r_2+\ldots \mid s_1=s, a_1=a\right]\] <p>é‚£ä¹ˆå…¶å®ä»·å€¼å‡½æ•°å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„baselineï¼š</p> \[\begin{aligned}V^{\pi, \gamma}(s) &amp; =\mathbb{E}_\pi\left[r_1+\gamma r_2+\ldots \mid s_1=s\right] \\&amp; =\mathbb{E}_{a \sim \pi}\left[Q^{\pi, \gamma}(s, a)\right]\end{aligned}\] </li> <li> <p>advantage functionï¼šæˆ‘ä»¬å®šä¹‰å¸¦æœ‰baselineï¼ˆä»·å€¼å‡½æ•°ï¼‰çš„Qå‡½æ•°ä¸ºadvantage functionï¼Œå³</p> \[A^{\pi, \gamma}(s, a)=Q^{\pi, \gamma}(s, a)-V^{\pi, \gamma}(s)\] </li> <li> <p>ç­–ç•¥æ¢¯åº¦ä¸ºï¼š</p> \[\nabla_\theta J(\theta)=\mathbb{E}_{\pi_\theta}\left[\nabla_\theta \log \pi_\theta(s, a) A^{\pi, \gamma}(s, a)\right]\] </li> <li> <p>åœ¨ç­–ç•¥æ¢¯åº¦é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨MCæ¥ä¼°è®¡å›æŠ¥ï¼Œä¹Ÿå¯ä»¥ç”¨TDæ–¹æ³•æ¥ä¼°è®¡ã€‚å¦‚æœæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªnæ­¥çš„å›æŠ¥ï¼Œæˆ‘ä»¬æœ‰ï¼š</p> \[\begin{aligned}n=1(T D) &amp; G_t^{(1)}=r_{t+1}+\gamma v\left(s_{t+1}\right) \\n=2 \quad &amp; G_t^{(2)}=r_{t+1}+\gamma r_{t+2}+\gamma^2 v\left(s_{t+2}\right) \\n=\infty(M C) &amp; G_t^{(\infty)}=r_{t+1}+\gamma r_{t+2}+\ldots+\gamma^{T-t-1} r_T\end{aligned}\] <p>é‚£ä¹ˆæˆ‘ä»¬çš„advantage functionä¼°è®¡å¯ä»¥å†™ä¸ºï¼š</p> \[\begin{aligned}&amp; \hat{A}_t^{(1)}=r_{t+1}+\gamma v\left(s_{t+1}\right)-v\left(s_t\right) \\&amp; \hat{A}_t^{(2)}=r_{t+1}+\gamma r_{t+2}+\gamma^2 v\left(s_{t+2}\right)-v\left(s_t\right) \\&amp; \hat{A}_t^{(\infty)}=r_{t+1}+\gamma r_{t+2}+\ldots+\gamma^{T-t-1} r_T-v\left(s_t\right)\end{aligned}\] <p>æ³¨æ„åˆ°ï¼Œ\(\hat{A}^{(\infty)}\)æœ‰å¤§varï¼Œå°biasï¼Œè€Œ\(\hat{A}^{(1)}\)æœ‰å°varï¼Œå¤§biasã€‚</p> </li> <li> <p>ä¸åŒæ—¶é—´å°ºåº¦çš„æ¼”å‘˜ï¼š</p> <p>ç­–ç•¥æ¢¯åº¦å¯ä»¥åœ¨å¾ˆå¤šæ—¶é—´å°ºåº¦ä¸Šä¼°è®¡</p> \[\nabla_\theta J(\theta)=\mathbb{E}_{\pi_\theta}\left[\nabla_\theta \log \pi_\theta(s, a) A^{\pi_\theta}(s, a)\right]\] <ul> <li> <p>MCæ¼”å‘˜-è¯„è®ºå‘˜ç­–ç•¥æ¢¯åº¦ç”¨<strong>æ•´ä¸ªå›æŠ¥</strong>è¯¯å·®æ¥ä¼˜åŒ–ï¼š</p> \[\nabla_\theta J(\theta)=\alpha\left(G_t-V_\kappa\left(s_t\right)\right) \nabla_\theta \log \pi_\theta\left(s_t, a_t\right)\] </li> <li> <p>TDæ¼”å‘˜-è¯„è®ºå‘˜ç­–ç•¥æ¢¯åº¦ç”¨TDè¯¯å·®æ¥ä¼˜åŒ–ï¼š</p> \[\nabla_\theta J(\theta)=\alpha\left(r+\gamma V_\kappa\left(s_{t+1}\right)-V_\kappa\left(s_t\right)\right) \nabla_\theta \log \pi_\theta\left(s_t, a_t\right)\] </li> <li> <p>kæ­¥TDæ¼”å‘˜-è¯„è®ºå‘˜ç­–ç•¥æ¢¯åº¦ç”¨kæ­¥å›æŠ¥è¯¯å·®æ¥ä¼˜åŒ–ï¼š</p> \[\nabla_\theta J(\theta)=\alpha\left(\sum_{i=0}^k \gamma^i r_{t+i}+\gamma^k V_\kappa\left(s_{t+k}\right)-V_\kappa\left(s_t\right)\right) \nabla_\theta \log \pi_\theta\left(s_t, a_t\right)\] </li> </ul> <blockquote> <p>TDç®—æ³•åªéœ€è¦ä¼˜åŒ–criticçš„å‚æ•°\(\kappa\)ï¼</p> </blockquote> </li> </ol> <h1 id="äº”ç­–ç•¥æ¢¯åº¦å°ç»“">äº”ã€ç­–ç•¥æ¢¯åº¦å°ç»“</h1> <ol> <li>ç­–ç•¥æ¢¯åº¦å¯ä»¥è§£å†³ä¸å¯å¾®çš„æƒ…å½¢ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡éšæœºç­–ç•¥é‡‡æ ·æ¥ç»“ç®—</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%209-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%209-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%209-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%209.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <ol> <li>è®­ç»ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬ä¼šäº§ç”Ÿä¸€äº›æ ·æœ¬ï¼ˆå›¾ä¸­ä¸åŒåˆ†æ”¯ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä¸åŒæ ·æœ¬å°½å¯èƒ½å¾—åˆ°æ¯”è¾ƒå¥½çš„ç»“æœï¼ˆæ¯”å¦‚å°çš„lossï¼‰ã€‚</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%2010-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%2010-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%2010-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%2010.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <ol> <li>ç­–ç•¥æ¢¯åº¦æ‹“å±•ï¼šå¤§éƒ¨åˆ†SOTAçš„RLæ–¹æ³•éƒ½æ˜¯åŸºäºç­–ç•¥çš„ã€‚</li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0 text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/RL_chapter5/Untitled%2011-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/RL_chapter5/Untitled%2011-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/RL_chapter5/Untitled%2011-1400.webp"></source> <img src="/assets/img/RL_chapter5/Untitled%2011.png" class="rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <ol> <li>ä¸åŒRLæµæ´¾ï¼š <ol> <li>åŸºäºä»·å€¼çš„RLï¼šé€šè¿‡DPè§£å†³RL <ol> <li>ç»å…¸RLå’Œæ§åˆ¶è®º</li> <li>ä»£è¡¨æ€§ç®—æ³•ï¼šDeep Q-learningå’Œå…¶å˜ç§</li> <li>ä»£è¡¨ç ”ç©¶äººå‘˜ï¼šRichard Suttonï¼ŒDavid Silver</li> <li>ä»£è¡¨æœºæ„ï¼šDeepmind</li> </ol> </li> <li>åŸºäºç­–ç•¥çš„RLï¼šé€šè¿‡å­¦ä¹ è§£å†³RL <ol> <li>æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ </li> <li>ä»£è¡¨æ€§ç®—æ³•ï¼šPGå’Œå…¶å˜ç§</li> <li>ä»£è¡¨ç ”ç©¶äººå‘˜ï¼šPieter Abeel, Sergey Levine, John Schulman</li> <li>ä»£è¡¨æœºæ„ï¼šOpenAI, Berkeley</li> </ol> </li> </ol> </li> </ol> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="//blog/2023/RL-lecture6/">ç¬¬å…­ç«  Policy Optimization State of the art (ç­–ç•¥ä¼˜åŒ–è¿›é˜¶ç¯‡)</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="//blog/2023/RL-lecture4/">ç¬¬å››ç«  Value Function Approximation and Deep Q-learning (ä»·å€¼å‡½æ•°è¿‘ä¼¼å’Œæ·±åº¦Qå­¦ä¹ )</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="//blog/2023/RL-lecture3/">ç¬¬ä¸‰ç«  Tabular methods Model-free Prediction and Control (è¡¨æ ¼å‹æ–¹æ³•ï¼šå…æ¨¡å‹çš„é¢„æµ‹å’Œæ§åˆ¶)</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="//blog/2023/RL-lecture2/">ç¬¬äºŒç«  Markov Decision Process (é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹)</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="//blog/2023/RL-lecture1/">ç¬¬ä¸€ç«  Overview (è¯¾ç¨‹æ¦‚æ‹¬ä¸RLåŸºç¡€)</a> </li> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"alshedivat/al-folio","data-repo-id":"MDEwOlJlcG9zaXRvcnk2MDAyNDM2NQ==","data-category":"Comments","data-category-id":"DIC_kwDOA5PmLc4CTBt6","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,a])=>giscusScript.setAttribute(t,a)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2023 Steven Shaobo Wang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>